import{P as a,j as s,c as v,u as S,r as p,l as D,Q as b,f as G,b as P,F as U,M as f}from"./index-3fd1b5bb.js";import{F as V,a as E,T,L as w,E as M,b as I,c as O,I as W,d as R,S as $,e as q}from"./AuthForms.styled-cff4cbaf.js";import{B as k,L as z,G as A,V as N}from"./VerifyForm-d5d21b4b.js";import{a as Q,f as y}from"./clusterSchema-4010b308.js";import"./index.esm-d47398a3.js";const B=({$fs:o,onClick:c,children:u})=>s.jsx(k,{type:"button",$fs:o,onClick:c,children:u});B.propTypes={$fs:a.string,onClick:a.func.isRequired,children:a.oneOfType([a.string,a.node,a.oneOf(["img","png","svg"])]).isRequired};const F={email:"",password:""},C=({setIsFM:o,setEmail:c})=>{const u=v(),l=S(),[d,m]=p.useState("password"),n=({values:i,errors:t,key:e})=>{const g=!i[e]&&"noValue",x=t[e]?"error":"success";return g||x},r=({errors:i,values:t})=>{const e=Object.keys(i).length;return Object.keys(t).some(x=>!t[x])||e},h=({email:i})=>{c(i),o(!0)},j=(i,t)=>{l(D(i)).unwrap().then(()=>u("/cluster",{replace:!0})).catch(e=>e.includes("401")&&b.error("Unauthorized")),t.resetForm()};return s.jsx(V,{initialValues:F,validationSchema:Q,onSubmit:j,children:({values:i,errors:t})=>s.jsxs(E,{children:[s.jsxs(T,{children:[s.jsx("h2",{children:"Sign in"}),s.jsx(z,{to:"/signup",children:"Don`t have an account?"})]}),Object.keys(F).map(e=>s.jsxs(p.Fragment,{children:[s.jsxs(w,{children:[e.at(0).toUpperCase()+e.substring(1),s.jsx("pre",{children:" "}),s.jsx(M,{name:e,component:"span"}),e==="password"&&s.jsx(B,{onClick:()=>h(i),children:"Forgot your pass?"})]}),s.jsxs(I,{children:[s.jsx(O,{type:e==="password"?d:e,name:e,$validation:n({values:i,errors:t,key:e})}),e==="password"&&s.jsx(W,{toggle:d,setToggle:m}),i[e]&&t[e]&&s.jsx(R,{}),i[e]&&!t[e]&&s.jsx($,{})]})]},e)),s.jsx(q,{disabled:r({values:i,errors:t}),children:"Sign in"}),s.jsx(A,{children:"Sign in with Google"})]})})};C.propTypes={setIsFM:a.func.isRequired,setEmail:a.func.isRequired};const L=({setIsFM:o,email:c})=>{const u=S(),l=({values:n,errors:r})=>{const h=!Object.values(n)[0]&&"noValue",j=Object.values(r).length?"error":"success";return h||j},d=({errors:n})=>Object.keys(n).length,m=n=>{u(G(n)).unwrap().catch(r=>b.error(r.message)),o(!1)};return s.jsx(V,{initialValues:{email:c},validationSchema:y,onSubmit:m,children:({values:n,errors:r})=>s.jsxs(E,{children:[s.jsx(T,{children:s.jsx("h2",{children:"Get reset link"})}),s.jsxs(p.Fragment,{children:[s.jsxs(w,{children:["Email",s.jsx("pre",{children:" "}),s.jsx(M,{name:"email",component:"span"})]}),s.jsxs(I,{children:[s.jsx(O,{type:"email",name:"email",$validation:l({values:n,errors:r})}),l({values:n,errors:r})==="error"&&s.jsx(R,{}),l({values:n,errors:r})==="success"&&s.jsx($,{})]})]}),s.jsx(q,{disabled:d({errors:r}),children:"Submit"})]})})};L.propTypes={setIsFM:a.func.isRequired,email:a.string.isRequired};const Z=()=>{const{user:o}=P(),[c,u]=p.useState(o.email&&!o.verifiedEmail),[l,d]=p.useState(!1),[m,n]=p.useState("");return s.jsxs(U,{$w:"400px",$p:"0",$fd:"column",$jc:"center",children:[s.jsx(C,{setIsFM:d,setEmail:n}),c&&s.jsx(f,{onClick:()=>u(!c),children:s.jsx(N,{userEmail:o.email})}),l&&s.jsx(f,{onClick:()=>d(!l),children:s.jsx(L,{setIsFM:d,email:m})})]})};export{Z as default};
