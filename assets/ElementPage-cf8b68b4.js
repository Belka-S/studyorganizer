import{U as Ne,r as I,t as Q,P as B,u as le,b as ue,q as ie,j as $,T as He,V as Ae,x as Ve,E as dt,H as gt,w as pe,S as cn,W as Rt,X as ln,Q as re,z as fe,Y as un,Z as pn,G as fn,i as hn,n as $e,s as F,_ as dn,$ as gn,a0 as mn,a1 as je,a2 as At,a3 as vn,a4 as bn,M as yn,a5 as wn,a6 as $n,a7 as Pe,a8 as Sn,a9 as mt,aa as Ct,F as Ge,D as Tn,ab as Rn,C as An,A as Cn,ac as kn,N as En,ad as _n}from"./index-2b99dfd4.js";import{r as kt,H as Ln,T as xn}from"./index-a25aacdc.js";import{w as Et}from"./writeClipboard-3a4c393f.js";import{v as jn,u as Pn}from"./index.esm-475abb33.js";import{a as Mn}from"./index-ce2522a8.js";const Ue=(e,n)=>{if(!n.includes("de"))return e;const t=e.trim().split(`
`);return t.length===1?e:["der","die","das"].includes(t[0].split(" ")[0])?`${t[0].trim()}, ${t[1].split("·")[1].replaceAll("⁰","").replaceAll("/"," / ").trim()}`:(e.includes("hat")||e.includes("ist"))&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e.includes("am")&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e},On=e=>/[a-z]/.test(e.charAt(0)),{VITE_DEEPL_API_KEY:Dn}={VITE_GOOGLE_CLIENT_ID:"689266183428-lh3lmpaqnd2qd6t93voa8s6ipt3836q1.apps.googleusercontent.com",VITE_DEEPL_API_KEY:"d15bf272-fb1f-4f29-bbc3-d3bbdd686c53:fx",VITE_GOOGLE_API_KEY:"AIzaSyDqQndBxYEuOG7F6iYDqQoiNF90tptRmBQ",VITE_PROD_BACK_URL:"https://studyorganizer.onrender.com",BASE_URL:"/studyorganizer/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},In={google:"",deepl:Dn},we=async(e,{from:n,to:t},h)=>{var d,o;if(!e||e.length===0)return"";const c=e.replaceAll(" ·",",").replaceAll("·","");Ne.engine=h,Ne.key=In[h];try{let s=await Ne(`${c}`,{from:n,to:t});if(t.includes("en")&&c.toLowerCase().includes("uhr")&&(s=s.replaceAll("a.m. on","am on").replaceAll("p.m. on","pm on").replaceAll("a.m. to","am to").replaceAll("p.m. to","pm to").replaceAll("a.m.","am.").replaceAll("p.m.","pm.")),[".","!","?"].includes(c.at(c.length-1)))return s;const A=c.split(c.includes(", ")?", ":/\s+/),C=s.split(", "),b=t.includes("de")?C[0]:C[0].at(0).toLowerCase()+C[0].substring(1);return A.length===1?s.toLocaleLowerCase()+", ":["der","die","das"].includes(A[0].split(" ")[0])?s.replace("The ","").replace("the ","").split(", ")[0].toLocaleLowerCase()+", ":t.includes("en")&&((d=A[2])!=null&&d.startsWith("am"))?C[2].startsWith("the")?s:`${b}, ${C[1]}, the ${C[2]}`:(A[0].endsWith("n")&&["hat","ist"].includes((o=A[2])==null?void 0:o.split(" ")[0])&&n.includes("de")&&(s=t.includes("en")?"to "+b+", ":b+", "),s)}catch(s){return s.message}},Me=(e,n)=>e.endsWith(n)?e.substring(0,e.length-1):e,zn=(e,n)=>{let t=84;e[0]&&(t=Number(e[0].style.height.replace("px",""))),I.useEffect(()=>{if(!e[0])return;let h=Math.max(...e.map(c=>c.scrollHeight));t!==h&&(h=h<=90?h:h+6,e.forEach(c=>{c.style.height=h+"px"}))},[t,e,n])},Ce=[{value:"de",label:"German"},{value:"en",label:"English"},{value:"uk",label:"Ukrainian"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"it",label:"Italian"}],ke=[{value:.3,label:"Rate: 0.3"},{value:.4,label:"Rate: 0.4"},{value:.5,label:"Rate: 0.5"},{value:.6,label:"Rate: 0.6"},{value:.8,label:"Rate: 0.8"},{value:1,label:"Rate: 1"},{value:1.25,label:"Rate: 1.25"},{value:1.5,label:"Rate: 1.5"}];var Ke=new Map,Ee=new WeakMap,vt=0,Nn=void 0;function Bn(e){return e?(Ee.has(e)||(vt+=1,Ee.set(e,vt.toString())),Ee.get(e)):"0"}function Wn(e){return Object.keys(e).sort().filter(n=>e[n]!==void 0).map(n=>`${n}_${n==="root"?Bn(e.root):e[n]}`).toString()}function Fn(e){const n=Wn(e);let t=Ke.get(n);if(!t){const h=new Map;let c;const d=new IntersectionObserver(o=>{o.forEach(s=>{var l;const A=s.isIntersecting&&c.some(C=>s.intersectionRatio>=C);e.trackVisibility&&typeof s.isVisible>"u"&&(s.isVisible=A),(l=h.get(s.target))==null||l.forEach(C=>{C(A,s)})})},e);c=d.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),t={id:n,observer:d,elements:h},Ke.set(n,t)}return t}function Vn(e,n,t={},h=Nn){if(typeof window.IntersectionObserver>"u"&&h!==void 0){const l=e.getBoundingClientRect();return n(h,{isIntersecting:h,target:e,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:l,intersectionRect:l,rootBounds:l}),()=>{}}const{id:c,observer:d,elements:o}=Fn(t),s=o.get(e)||[];return o.has(e)||o.set(e,s),s.push(n),d.observe(e),function(){s.splice(s.indexOf(n),1),s.length===0&&(o.delete(e),d.unobserve(e)),o.size===0&&(d.disconnect(),Ke.delete(c))}}function Gn({threshold:e,delay:n,trackVisibility:t,rootMargin:h,root:c,triggerOnce:d,skip:o,initialInView:s,fallbackInView:l,onChange:A}={}){var C;const[b,w]=I.useState(null),v=I.useRef(A),[g,R]=I.useState({inView:!!s,entry:void 0});v.current=A,I.useEffect(()=>{if(o||!b)return;let u;return u=Vn(b,(f,T)=>{R({inView:f,entry:T}),v.current&&v.current(f,T),T.isIntersecting&&d&&u&&(u(),u=void 0)},{root:c,rootMargin:h,threshold:e,trackVisibility:t,delay:n},l),()=>{u&&u()}},[Array.isArray(e)?e.toString():e,b,c,h,d,o,t,l,n]);const y=(C=g.entry)==null?void 0:C.target,p=I.useRef(void 0);!b&&y&&!d&&!o&&p.current!==y&&(p.current=y,R({inView:!!s,entry:void 0}));const r=[w,g.inView,g.entry];return r.ref=r[0],r.inView=r[1],r.entry=r[2],r}const{backgroundHoverd:_e,white:Le,borderLight:xe}=Q.colors,_t=()=>{const e=le(),{user:n}=ue(),{activeCluster:t}=ie(),h=({value:s})=>{e(Ve({_id:t._id,lang:s})).unwrap().then(l=>e(dt(l.result.cluster)))},c=({value:s})=>{e(Ve({_id:t._id,rate:s})).unwrap().then(l=>e(dt(l.result.cluster)))},d=({value:s})=>{const l=new FormData;l.append("lang",s),e(gt(l))},o=({value:s})=>{const l=new FormData;l.append("rate",s),e(gt(l))};return $.jsxs(He,{$m:"0",$cg:"8px",$ai:"center",$gtc:"2fr 2fr 2fr 2fr",children:[$.jsx(Ae,{options:Ce,defaultValue:Ce.find(s=>s.value===(t==null?void 0:t.lang)),onChange:h,placeholder:"Language...",$ol:_e,$b:Le,$bh:xe}),$.jsx(Ae,{options:ke,defaultValue:ke.find(s=>s.value==(t==null?void 0:t.rate)),onChange:c,placeholder:"Rate...",$ol:_e,$b:Le,$bh:xe}),$.jsx(Ae,{options:Ce,defaultValue:Ce.find(s=>s.value===n.lang),onChange:d,placeholder:"Language...",$ol:_e,$b:Le,$bh:xe}),$.jsx(Ae,{options:ke,defaultValue:ke.find(s=>s.value==n.rate),onChange:o,placeholder:"Rate...",$ol:_e,$b:Le,$bh:xe})]})};_t.propTypes={filtredElements:B.array,setLiColor:B.func};const{button:Un}=Q.shadows,Kn=()=>{const e=le(),{user:n}=ue(),{activeCluster:t}=ie();I.useEffect(()=>{const c=async d=>{d.key==="e"&&d.metaKey&&(d.preventDefault(),await h())};return addEventListener("keydown",c),()=>{removeEventListener("keydown",c)}},[]);const h=async c=>{const d=window.getSelection().toString();d&&await Et(d);const o=await kt();let s=Ue(o,t.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();s=Me(s,",");const l={from:t.lang,to:n.lang};let A=await we(s,l,n.engine);A=Me(A.trim(),",");const{_id:C}=t;try{const b={cluster:C,element:"[]",caption:s},w={cluster:C,element:s,caption:A,favorite:!0,checked:s.split(/\s+/).length<20},v=s.includes("https://")?b:w;e(Rt(v)).unwrap().then(()=>(c==null?void 0:c.target)&&ln()).finally(()=>{var g;return(g=c==null?void 0:c.target)==null?void 0:g.blur()})}catch(b){c==null||c.currentTarget.blur(),re.error(`Invalid element, ${b.message}`)}};return $.jsx(pe,{onClick:h,$s:"m",$round:!0,$bs:Un,children:$.jsx(cn,{size:18})})},{button:qn}=Q.shadows,Hn=()=>{const e=le(),{elementTrash:n}=fe(),t=()=>{confirm("Are you sure you want to delete the selected Element(s)?")&&e(un(n.map(h=>h._id).join("&"))).unwrap().then(()=>e(pn()))};return $.jsx(pe,{onClick:t,$s:"m",$round:!0,$bs:qn,children:$.jsx(Ln,{size:16})})};function Yn(e){return fn({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M250.73,210.63l-56-112a12,12,0,0,0-21.46,0l-20.52,41A84.2,84.2,0,0,1,114,126.22,107.48,107.48,0,0,0,139.33,68H160a12,12,0,0,0,0-24H108V32a12,12,0,0,0-24,0V44H32a12,12,0,0,0,0,24h83.13A83.69,83.69,0,0,1,96,110.35,84,84,0,0,1,83.6,91a12,12,0,1,0-21.81,10A107.55,107.55,0,0,0,78,126.24,83.54,83.54,0,0,1,32,140a12,12,0,0,0,0,24,107.47,107.47,0,0,0,64-21.07,108.4,108.4,0,0,0,45.39,19.44l-24.13,48.26a12,12,0,1,0,21.46,10.73L151.41,196h65.17l12.68,25.36a12,12,0,1,0,21.47-10.73ZM163.41,172,184,130.83,204.58,172Z"},child:[]}]})(e)}const{button:Qn}=Q.shadows,Zn=()=>{const{activeCluster:e}=ie();I.useEffect(()=>{const d=async o=>{o.metaKey&&o.key==="d"&&(o.preventDefault(),await c())};return addEventListener("keydown",d),()=>{removeEventListener("keydown",d)}},[]);let n=[];function t(d){d.forEach(o=>{const s=window.open(o,"_blank");s?n.push(s):re.error(`Failed to open tab: ${o}`)})}const h=()=>{n.forEach(d=>{d.close()}),n=[]},c=async()=>{const d=window.getSelection().toString();d&&await Et(d);const o=await kt();let s=[];e.lang.includes("de")&&s.push(`https://www.verbformen.com/conjugation/?w=${o}`),e.lang.includes("en")&&s.push(`https://dictionary.cambridge.org/dictionary/english-russian/${o}`),h(),t(s)};return $.jsx(pe,{onClick:c,$s:"m",$round:!0,$bs:Qn,children:$.jsx(Yn,{size:18})})};var Xn={exports:{}};(function(e){var n=function(t){var h=Object.prototype,c=h.hasOwnProperty,d=Object.defineProperty||function(a,i,m){a[i]=m.value},o,s=typeof Symbol=="function"?Symbol:{},l=s.iterator||"@@iterator",A=s.asyncIterator||"@@asyncIterator",C=s.toStringTag||"@@toStringTag";function b(a,i,m){return Object.defineProperty(a,i,{value:m,enumerable:!0,configurable:!0,writable:!0}),a[i]}try{b({},"")}catch{b=function(i,m,L){return i[m]=L}}function w(a,i,m,L){var k=i&&i.prototype instanceof u?i:u,O=Object.create(k.prototype),q=new W(L||[]);return d(O,"_invoke",{value:S(a,m,q)}),O}t.wrap=w;function v(a,i,m){try{return{type:"normal",arg:a.call(i,m)}}catch(L){return{type:"throw",arg:L}}}var g="suspendedStart",R="suspendedYield",y="executing",p="completed",r={};function u(){}function f(){}function T(){}var x={};b(x,l,function(){return this});var j=Object.getPrototypeOf,D=j&&j(j(M([])));D&&D!==h&&c.call(D,l)&&(x=D);var V=T.prototype=u.prototype=Object.create(x);f.prototype=T,d(V,"constructor",{value:T,configurable:!0}),d(T,"constructor",{value:f,configurable:!0}),f.displayName=b(T,C,"GeneratorFunction");function z(a){["next","throw","return"].forEach(function(i){b(a,i,function(m){return this._invoke(i,m)})})}t.isGeneratorFunction=function(a){var i=typeof a=="function"&&a.constructor;return i?i===f||(i.displayName||i.name)==="GeneratorFunction":!1},t.mark=function(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,T):(a.__proto__=T,b(a,C,"GeneratorFunction")),a.prototype=Object.create(V),a},t.awrap=function(a){return{__await:a}};function N(a,i){function m(O,q,H,Z){var K=v(a[O],a,q);if(K.type==="throw")Z(K.arg);else{var ge=K.arg,ae=ge.value;return ae&&typeof ae=="object"&&c.call(ae,"__await")?i.resolve(ae.__await).then(function(ne){m("next",ne,H,Z)},function(ne){m("throw",ne,H,Z)}):i.resolve(ae).then(function(ne){ge.value=ne,H(ge)},function(ne){return m("throw",ne,H,Z)})}}var L;function k(O,q){function H(){return new i(function(Z,K){m(O,q,Z,K)})}return L=L?L.then(H,H):H()}d(this,"_invoke",{value:k})}z(N.prototype),b(N.prototype,A,function(){return this}),t.AsyncIterator=N,t.async=function(a,i,m,L,k){k===void 0&&(k=Promise);var O=new N(w(a,i,m,L),k);return t.isGeneratorFunction(i)?O:O.next().then(function(q){return q.done?q.value:O.next()})};function S(a,i,m){var L=g;return function(O,q){if(L===y)throw new Error("Generator is already running");if(L===p){if(O==="throw")throw q;return U()}for(m.method=O,m.arg=q;;){var H=m.delegate;if(H){var Z=_(H,m);if(Z){if(Z===r)continue;return Z}}if(m.method==="next")m.sent=m._sent=m.arg;else if(m.method==="throw"){if(L===g)throw L=p,m.arg;m.dispatchException(m.arg)}else m.method==="return"&&m.abrupt("return",m.arg);L=y;var K=v(a,i,m);if(K.type==="normal"){if(L=m.done?p:R,K.arg===r)continue;return{value:K.arg,done:m.done}}else K.type==="throw"&&(L=p,m.method="throw",m.arg=K.arg)}}}function _(a,i){var m=i.method,L=a.iterator[m];if(L===o)return i.delegate=null,m==="throw"&&a.iterator.return&&(i.method="return",i.arg=o,_(a,i),i.method==="throw")||m!=="return"&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+m+"' method")),r;var k=v(L,a.iterator,i.arg);if(k.type==="throw")return i.method="throw",i.arg=k.arg,i.delegate=null,r;var O=k.arg;if(!O)return i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,r;if(O.done)i[a.resultName]=O.value,i.next=a.nextLoc,i.method!=="return"&&(i.method="next",i.arg=o);else return O;return i.delegate=null,r}z(V),b(V,C,"Generator"),b(V,l,function(){return this}),b(V,"toString",function(){return"[object Generator]"});function E(a){var i={tryLoc:a[0]};1 in a&&(i.catchLoc=a[1]),2 in a&&(i.finallyLoc=a[2],i.afterLoc=a[3]),this.tryEntries.push(i)}function P(a){var i=a.completion||{};i.type="normal",delete i.arg,a.completion=i}function W(a){this.tryEntries=[{tryLoc:"root"}],a.forEach(E,this),this.reset(!0)}t.keys=function(a){var i=Object(a),m=[];for(var L in i)m.push(L);return m.reverse(),function k(){for(;m.length;){var O=m.pop();if(O in i)return k.value=O,k.done=!1,k}return k.done=!0,k}};function M(a){if(a!=null){var i=a[l];if(i)return i.call(a);if(typeof a.next=="function")return a;if(!isNaN(a.length)){var m=-1,L=function k(){for(;++m<a.length;)if(c.call(a,m))return k.value=a[m],k.done=!1,k;return k.value=o,k.done=!0,k};return L.next=L}}throw new TypeError(typeof a+" is not iterable")}t.values=M;function U(){return{value:o,done:!0}}return W.prototype={constructor:W,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(P),!a)for(var i in this)i.charAt(0)==="t"&&c.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=o)},stop:function(){this.done=!0;var a=this.tryEntries[0],i=a.completion;if(i.type==="throw")throw i.arg;return this.rval},dispatchException:function(a){if(this.done)throw a;var i=this;function m(Z,K){return O.type="throw",O.arg=a,i.next=Z,K&&(i.method="next",i.arg=o),!!K}for(var L=this.tryEntries.length-1;L>=0;--L){var k=this.tryEntries[L],O=k.completion;if(k.tryLoc==="root")return m("end");if(k.tryLoc<=this.prev){var q=c.call(k,"catchLoc"),H=c.call(k,"finallyLoc");if(q&&H){if(this.prev<k.catchLoc)return m(k.catchLoc,!0);if(this.prev<k.finallyLoc)return m(k.finallyLoc)}else if(q){if(this.prev<k.catchLoc)return m(k.catchLoc,!0)}else if(H){if(this.prev<k.finallyLoc)return m(k.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(a,i){for(var m=this.tryEntries.length-1;m>=0;--m){var L=this.tryEntries[m];if(L.tryLoc<=this.prev&&c.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var k=L;break}}k&&(a==="break"||a==="continue")&&k.tryLoc<=i&&i<=k.finallyLoc&&(k=null);var O=k?k.completion:{};return O.type=a,O.arg=i,k?(this.method="next",this.next=k.finallyLoc,r):this.complete(O)},complete:function(a,i){if(a.type==="throw")throw a.arg;return a.type==="break"||a.type==="continue"?this.next=a.arg:a.type==="return"?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):a.type==="normal"&&i&&(this.next=i),r},finish:function(a){for(var i=this.tryEntries.length-1;i>=0;--i){var m=this.tryEntries[i];if(m.finallyLoc===a)return this.complete(m.completion,m.afterLoc),P(m),r}},catch:function(a){for(var i=this.tryEntries.length-1;i>=0;--i){var m=this.tryEntries[i];if(m.tryLoc===a){var L=m.completion;if(L.type==="throw"){var k=L.arg;P(m)}return k}}throw new Error("illegal catch attempt")},delegateYield:function(a,i,m){return this.delegate={iterator:M(a),resultName:i,nextLoc:m},this.method==="next"&&(this.arg=o),r}},t}(e.exports);try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})(Xn);var ye={},Lt={},X={};Object.defineProperty(X,"__esModule",{value:!0});X.browserSupportsPolyfills=X.compareTwoStringsUsingDiceCoefficient=X.commandToRegExp=X.concatTranscripts=X.debounce=void 0;var Jn=function(n,t,h){var c;return function(){var d=this,o=arguments,s=function(){c=null,h||n.apply(d,o)},l=h&&!c;clearTimeout(c),c=setTimeout(s,t),l&&n.apply(d,o)}};X.debounce=Jn;var er=function(){for(var n=arguments.length,t=new Array(n),h=0;h<n;h++)t[h]=arguments[h];return t.map(function(c){return c.trim()}).join(" ").trim()};X.concatTranscripts=er;var tr=/\s*\((.*?)\)\s*/g,nr=/(\(\?:[^)]+\))\?/g,rr=/(\(\?)?:\w+/g,ir=/\*/g,sr=/[-{}[\]+?.,\\^$|#]/g,ar=function(n){return n instanceof RegExp?new RegExp(n.source,"i"):(n=n.replace(sr,"\\$&").replace(tr,"(?:$1)?").replace(rr,function(t,h){return h?t:"([^\\s]+)"}).replace(ir,"(.*?)").replace(nr,"\\s*$1?\\s*"),new RegExp("^"+n+"$","i"))};X.commandToRegExp=ar;var or=function(n,t){if(n=n.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!n.length&&!t.length)return 1;if(!n.length||!t.length)return 0;if(n===t)return 1;if(n.length===1&&t.length===1||n.length<2||t.length<2)return 0;for(var h=new Map,c=0;c<n.length-1;c++){var d=n.substring(c,c+2),o=h.has(d)?h.get(d)+1:1;h.set(d,o)}for(var s=0,l=0;l<t.length-1;l++){var A=t.substring(l,l+2),C=h.has(A)?h.get(A):0;C>0&&(h.set(A,C-1),s++)}return 2*s/(n.length+t.length-2)};X.compareTwoStringsUsingDiceCoefficient=or;var cr=function(){return typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0)};X.browserSupportsPolyfills=cr;var he={},ce={};Object.defineProperty(ce,"__esModule",{value:!0});ce.APPEND_TRANSCRIPT=ce.CLEAR_TRANSCRIPT=void 0;var lr="CLEAR_TRANSCRIPT";ce.CLEAR_TRANSCRIPT=lr;var ur="APPEND_TRANSCRIPT";ce.APPEND_TRANSCRIPT=ur;Object.defineProperty(he,"__esModule",{value:!0});he.appendTranscript=he.clearTranscript=void 0;var xt=ce,pr=function(){return{type:xt.CLEAR_TRANSCRIPT}};he.clearTranscript=pr;var fr=function(n,t){return{type:xt.APPEND_TRANSCRIPT,payload:{interimTranscript:n,finalTranscript:t}}};he.appendTranscript=fr;var De={};Object.defineProperty(De,"__esModule",{value:!0});De.transcriptReducer=void 0;var bt=ce,hr=X,dr=function(n,t){switch(t.type){case bt.CLEAR_TRANSCRIPT:return{interimTranscript:"",finalTranscript:""};case bt.APPEND_TRANSCRIPT:return{interimTranscript:t.payload.interimTranscript,finalTranscript:(0,hr.concatTranscripts)(n.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};De.transcriptReducer=dr;var jt={},Ye={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){return/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"")};e.default=n})(Ye);var Qe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.isNative=void 0;var n=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),t=function(d){return d===n};e.isNative=t;var h=n;e.default=h})(Qe);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=c(Ye),t=X,h=Qe;function c(b){return b&&b.__esModule?b:{default:b}}function d(b,w,v,g,R,y,p){try{var r=b[y](p),u=r.value}catch(f){v(f);return}r.done?w(u):Promise.resolve(u).then(g,R)}function o(b){return function(){var w=this,v=arguments;return new Promise(function(g,R){var y=b.apply(w,v);function p(u){d(y,g,R,p,r,"next",u)}function r(u){d(y,g,R,p,r,"throw",u)}p(void 0)})}}function s(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}function l(b,w){for(var v=0;v<w.length;v++){var g=w[v];g.enumerable=g.enumerable||!1,g.configurable=!0,"value"in g&&(g.writable=!0),Object.defineProperty(b,g.key,g)}}function A(b,w,v){return w&&l(b.prototype,w),v&&l(b,v),b}var C=function(){function b(w){s(this,b),this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=function(){},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(w),(0,n.default)()&&(this.updateFinalTranscript=(0,t.debounce)(this.updateFinalTranscript,250,!0))}return A(b,[{key:"setSpeechRecognition",value:function(v){var g=!!v&&((0,h.isNative)(v)||(0,t.browserSupportsPolyfills)());g&&(this.disableRecognition(),this.recognition=new v,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(g)}},{key:"subscribe",value:function(v,g){this.subscribers[v]=g}},{key:"unsubscribe",value:function(v){delete this.subscribers[v]}},{key:"emitListeningChange",value:function(v){var g=this;this.listening=v,Object.keys(this.subscribers).forEach(function(R){var y=g.subscribers[R].onListeningChange;y(v)})}},{key:"emitMicrophoneAvailabilityChange",value:function(v){var g=this;this.isMicrophoneAvailable=v,Object.keys(this.subscribers).forEach(function(R){var y=g.subscribers[R].onMicrophoneAvailabilityChange;y(v)})}},{key:"emitTranscriptChange",value:function(v,g){var R=this;Object.keys(this.subscribers).forEach(function(y){var p=R.subscribers[y].onTranscriptChange;p(v,g)})}},{key:"emitClearTranscript",value:function(){var v=this;Object.keys(this.subscribers).forEach(function(g){var R=v.subscribers[g].onClearTranscript;R()})}},{key:"emitBrowserSupportsSpeechRecognitionChange",value:function(v){var g=this;Object.keys(this.subscribers).forEach(function(R){var y=g.subscribers[R],p=y.onBrowserSupportsSpeechRecognitionChange,r=y.onBrowserSupportsContinuousListeningChange;p(v),r(v)})}},{key:"disconnect",value:function(v){if(this.recognition&&this.listening)switch(v){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}},{key:"disableRecognition",value:function(){this.recognition&&(this.recognition.onresult=function(){},this.recognition.onend=function(){},this.recognition.onerror=function(){},this.listening&&this.stopListening())}},{key:"onError",value:function(v){v&&v.error&&v.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}},{key:"onRecognitionDisconnect",value:function(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}},{key:"updateTranscript",value:function(v){var g=v.results,R=v.resultIndex,y=R===void 0?g.length-1:R;this.interimTranscript="",this.finalTranscript="";for(var p=y;p<g.length;++p)g[p].isFinal&&(!(0,n.default)()||g[p][0].confidence>0)?this.updateFinalTranscript(g[p][0].transcript):this.interimTranscript=(0,t.concatTranscripts)(this.interimTranscript,g[p][0].transcript);var r=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(r=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,r||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}},{key:"updateFinalTranscript",value:function(v){this.finalTranscript=(0,t.concatTranscripts)(this.finalTranscript,v)}},{key:"resetTranscript",value:function(){this.disconnect("RESET")}},{key:"startListening",value:function(){var w=o(regeneratorRuntime.mark(function g(){var R,y,p,r,u,f,T=arguments;return regeneratorRuntime.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(R=T.length>0&&T[0]!==void 0?T[0]:{},y=R.continuous,p=y===void 0?!1:y,r=R.language,this.recognition){j.next=3;break}return j.abrupt("return");case 3:if(u=p!==this.recognition.continuous,f=r&&r!==this.recognition.lang,!(u||f)){j.next=11;break}if(!this.listening){j.next=9;break}return j.next=9,this.stopListening();case 9:this.recognition.continuous=u?p:this.recognition.continuous,this.recognition.lang=f?r:this.recognition.lang;case 11:if(this.listening){j.next=22;break}return this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript()),j.prev=13,j.next=16,this.start();case 16:this.emitListeningChange(!0),j.next=22;break;case 19:j.prev=19,j.t0=j.catch(13),j.t0 instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1);case 22:case"end":return j.stop()}},g,this,[[13,19]])}));function v(){return w.apply(this,arguments)}return v}()},{key:"abortListening",value:function(){var w=o(regeneratorRuntime.mark(function g(){var R=this;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.disconnect("ABORT"),this.emitListeningChange(!1),p.next=4,new Promise(function(r){R.onStopListening=r});case 4:case"end":return p.stop()}},g,this)}));function v(){return w.apply(this,arguments)}return v}()},{key:"stopListening",value:function(){var w=o(regeneratorRuntime.mark(function g(){var R=this;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.disconnect("STOP"),this.emitListeningChange(!1),p.next=4,new Promise(function(r){R.onStopListening=r});case 4:case"end":return p.stop()}},g,this)}));function v(){return w.apply(this,arguments)}return v}()},{key:"getRecognition",value:function(){return this.recognition}},{key:"start",value:function(){var w=o(regeneratorRuntime.mark(function g(){return regeneratorRuntime.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(this.recognition&&!this.listening)){y.next=4;break}return y.next=3,this.recognition.start();case 3:this.listening=!0;case 4:case"end":return y.stop()}},g,this)}));function v(){return w.apply(this,arguments)}return v}()},{key:"stop",value:function(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}},{key:"abort",value:function(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}}]),b}();e.default=C})(jt);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.useSpeechRecognition=void 0;var n=I,t=X,h=he,c=De,d=l(jt),o=l(Ye),s=l(Qe);function l(S){return S&&S.__esModule?S:{default:S}}function A(S,_,E,P,W,M,U){try{var a=S[M](U),i=a.value}catch(m){E(m);return}a.done?_(i):Promise.resolve(i).then(P,W)}function C(S){return function(){var _=this,E=arguments;return new Promise(function(P,W){var M=S.apply(_,E);function U(i){A(M,P,W,U,a,"next",i)}function a(i){A(M,P,W,U,a,"throw",i)}U(void 0)})}}function b(S){return g(S)||v(S)||r(S)||w()}function w(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v(S){if(typeof Symbol<"u"&&Symbol.iterator in Object(S))return Array.from(S)}function g(S){if(Array.isArray(S))return u(S)}function R(S){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?R=function(E){return typeof E}:R=function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},R(S)}function y(S,_){return T(S)||f(S,_)||r(S,_)||p()}function p(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r(S,_){if(S){if(typeof S=="string")return u(S,_);var E=Object.prototype.toString.call(S).slice(8,-1);if(E==="Object"&&S.constructor&&(E=S.constructor.name),E==="Map"||E==="Set")return Array.from(S);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return u(S,_)}}function u(S,_){(_==null||_>S.length)&&(_=S.length);for(var E=0,P=new Array(_);E<_;E++)P[E]=S[E];return P}function f(S,_){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(S)))){var E=[],P=!0,W=!1,M=void 0;try{for(var U=S[Symbol.iterator](),a;!(P=(a=U.next()).done)&&(E.push(a.value),!(_&&E.length===_));P=!0);}catch(i){W=!0,M=i}finally{try{!P&&U.return!=null&&U.return()}finally{if(W)throw M}}return E}}function T(S){if(Array.isArray(S))return S}var x=!!s.default,j=x&&!(0,o.default)(),D,V=function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},E=_.transcribing,P=E===void 0?!0:E,W=_.clearTranscriptOnListen,M=W===void 0?!0:W,U=_.commands,a=U===void 0?[]:U,i=(0,n.useState)(z.getRecognitionManager()),m=y(i,1),L=m[0],k=(0,n.useState)(x),O=y(k,2),q=O[0],H=O[1],Z=(0,n.useState)(j),K=y(Z,2),ge=K[0],ae=K[1],ne=(0,n.useReducer)(c.transcriptReducer,{interimTranscript:L.interimTranscript,finalTranscript:""}),Xe=y(ne,2),Je=Xe[0],et=Je.interimTranscript,tt=Je.finalTranscript,nt=Xe[1],Ft=(0,n.useState)(L.listening),rt=y(Ft,2),Vt=rt[0],Gt=rt[1],Ut=(0,n.useState)(L.isMicrophoneAvailable),it=y(Ut,2),Kt=it[0],qt=it[1],st=(0,n.useRef)(a);st.current=a;var at=function(){nt((0,h.clearTranscript)())},me=(0,n.useCallback)(function(){L.resetTranscript(),at()},[L]),Ht=function(Y,te,oe){var se=R(Y)==="object"?Y.toString():Y,ve=se.replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),Se=(0,t.compareTwoStringsUsingDiceCoefficient)(ve,te);return Se>=oe?{command:Y,commandWithoutSpecials:ve,howSimilar:Se,isFuzzyMatch:!0}:null},Yt=function(Y,te){var oe=(0,t.commandToRegExp)(Y),se=oe.exec(te);return se?{command:Y,parameters:se.slice(1)}:null},ot=(0,n.useCallback)(function(ee,Y){st.current.forEach(function(te){var oe=te.command,se=te.callback,ve=te.matchInterim,Se=ve===void 0?!1:ve,ut=te.isFuzzyMatch,pt=ut===void 0?!1:ut,ft=te.fuzzyMatchingThreshold,Zt=ft===void 0?.8:ft,ht=te.bestMatchOnly,Xt=ht===void 0?!1:ht,Te=!Y&&Se?ee.trim():Y.trim(),Jt=Array.isArray(oe)?oe:[oe],Re=Jt.map(function(J){return pt?Ht(J,Te,Zt):Yt(J,Te)}).filter(function(J){return J});if(pt&&Xt&&Re.length>=2){Re.sort(function(J,ze){return ze.howSimilar-J.howSimilar});var Ie=Re[0],en=Ie.command,tn=Ie.commandWithoutSpecials,nn=Ie.howSimilar;se(tn,Te,nn,{command:en,resetTranscript:me})}else Re.forEach(function(J){if(J.isFuzzyMatch){var ze=J.command,rn=J.commandWithoutSpecials,sn=J.howSimilar;se(rn,Te,sn,{command:ze,resetTranscript:me})}else{var an=J.command,on=J.parameters;se.apply(void 0,b(on).concat([{command:an,resetTranscript:me}]))}})})},[me]),ct=(0,n.useCallback)(function(ee,Y){P&&nt((0,h.appendTranscript)(ee,Y)),ot(ee,Y)},[ot,P]),lt=(0,n.useCallback)(function(){M&&at()},[M]);(0,n.useEffect)(function(){var ee=z.counter;z.counter+=1;var Y={onListeningChange:Gt,onMicrophoneAvailabilityChange:qt,onTranscriptChange:ct,onClearTranscript:lt,onBrowserSupportsSpeechRecognitionChange:H,onBrowserSupportsContinuousListeningChange:ae};return L.subscribe(ee,Y),function(){L.unsubscribe(ee)}},[P,M,L,ct,lt]);var Qt=(0,t.concatTranscripts)(tt,et);return{transcript:Qt,interimTranscript:et,finalTranscript:tt,listening:Vt,isMicrophoneAvailable:Kt,resetTranscript:me,browserSupportsSpeechRecognition:q,browserSupportsContinuousListening:ge}};e.useSpeechRecognition=V;var z={counter:0,applyPolyfill:function(_){D?D.setSpeechRecognition(_):D=new d.default(_);var E=!!_&&(0,t.browserSupportsPolyfills)();x=E,j=E},removePolyfill:function(){D?D.setSpeechRecognition(s.default):D=new d.default(s.default),x=!!s.default,j=x&&!(0,o.default)()},getRecognitionManager:function(){return D||(D=new d.default(s.default)),D},getRecognition:function(){var _=z.getRecognitionManager();return _.getRecognition()},startListening:function(){var S=C(regeneratorRuntime.mark(function E(){var P,W,M,U,a=arguments;return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return P=a.length>0&&a[0]!==void 0?a[0]:{},W=P.continuous,M=P.language,U=z.getRecognitionManager(),m.next=4,U.startListening({continuous:W,language:M});case 4:case"end":return m.stop()}},E)}));function _(){return S.apply(this,arguments)}return _}(),stopListening:function(){var S=C(regeneratorRuntime.mark(function E(){var P;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return P=z.getRecognitionManager(),M.next=3,P.stopListening();case 3:case"end":return M.stop()}},E)}));function _(){return S.apply(this,arguments)}return _}(),abortListening:function(){var S=C(regeneratorRuntime.mark(function E(){var P;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return P=z.getRecognitionManager(),M.next=3,P.abortListening();case 3:case"end":return M.stop()}},E)}));function _(){return S.apply(this,arguments)}return _}(),browserSupportsSpeechRecognition:function(){return x},browserSupportsContinuousListening:function(){return j}},N=z;e.default=N})(Lt);(function(e){function n(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(l){return typeof l}:n=function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},n(o)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"useSpeechRecognition",{enumerable:!0,get:function(){return t.useSpeechRecognition}}),e.default=void 0;var t=c(Lt);function h(){if(typeof WeakMap!="function")return null;var o=new WeakMap;return h=function(){return o},o}function c(o){if(o&&o.__esModule)return o;if(o===null||n(o)!=="object"&&typeof o!="function")return{default:o};var s=h();if(s&&s.has(o))return s.get(o);var l={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in o)if(Object.prototype.hasOwnProperty.call(o,C)){var b=A?Object.getOwnPropertyDescriptor(o,C):null;b&&(b.get||b.set)?Object.defineProperty(l,C,b):l[C]=o[C]}return l.default=o,s&&s.set(o,l),l}var d=t.default;e.default=d})(ye);const be=hn(ye),{colors:G,shadows:yt,indents:Be}=Q,gr=$e`
  margin-bottom: 7px;
  padding-block: ${Be.xs};

  display: grid;
  align-items: center;
  grid-template-columns: 1fr 25fr 1fr;

  border: 1px solid transparent;
  background-color: ${({licolor:e})=>e};
  border-radius: ${Be.xs};
  font-size: 22px;

  &:last-of-type {
    margin-bottom: ${Be.s};
  }
`,mr=F.li`
  ${gr}

  transition: box-shadow 250ms, border-color 250ms;

  &#active-element {
    border-color: ${G.border};
    background-color: ${G.background};
    box-shadow: ${yt.back};

    &:hover {
      border-color: ${G.accent};
    }
    & div button {
      transition: color 250ms;
      color: ${G.smokeBlack};
      &:hover {
        color: ${G.hovered};
      }
    }
  }

  & div button {
    transition: color 250ms;
    &:hover {
      color: ${G.hovered};
    }
  }

  &:hover {
    border-color: ${G.accent};
    box-shadow: ${yt.back};
  }

  &:hover label,
  &:hover button {
    opacity: 1;
  }
`,Pt=$e`
  min-height: 19px;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  & input {
    ${jn}
  }
`,vr=F.label`
  ${Pt}

  & svg {
    transition: stroke 250ms;
    stroke-width: 2px;
    color: ${({$hovered:e})=>e?G.yellow:"transparent"};
    stroke: ${({$hovered:e})=>e?G.yellow:G.border};
  }
  &:hover svg {
    stroke: ${G.placeholder};
  }
`,br=F.label`
  ${Pt}
  opacity: ${({$hovered:e})=>e?1:0};
  transition: opacity 250ms;

  & svg {
    transition: border-color 250ms, color 250ms;
    padding: 1px;
    border: 2px solid ${G.border};
    border-radius: 50%;
    color: ${({$hovered:e})=>e?G.border:"transparent"};
  }
  &:hover svg {
    border-color: ${G.placeholder};
    color: ${({$hovered:e})=>e?G.placeholder:"transparent"};
  }
`,de=$e`
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: transparent;
  border-color: transparent;
  transition: opacity 250ms color 250ms;
  color: ${G.black};

  & svg {
    transition: color 250ms;
    color: ${G.border};
  }
  &:hover,
  &:hover svg {
    color: ${G.placeholder};
  }
`,yr=F.button`
  ${de}

  opacity: ${({$hovered:e})=>e?1:0};
`,wr=F.button`
  ${de}

  opacity: 0;
`,{colors:Oe,indents:Mt}=Q,Ot=$e`
  padding-block: 4px;
  display: grid;
  align-items: start;
  grid-template-columns: 20fr 1fr 20fr;
`,$r=F.div`
  ${Ot}
`,Sr=F.form`
  ${Ot}

  max-height: 70vh;
  overflow-y: scroll;
  scrollbar-width: none;
  grid-template-columns: 12fr 1fr 12fr;
`,wt=F.textarea`
  height: 84px;
  outline: none;
  border: 1px solid ${Oe.accent};
  border-radius: ${Mt.xs};
  resize: none;
  overflow: clip;
  transition: height 150ms;
`,Tr=F.div`
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  &::after {
    content: '';
    height: calc(100% - 8px);
    width: 1px;
    border: 1px solid ${Oe.borderLight};
    transition: border-color 250ms;
  }

  &:hover::after {
    border-color: ${Oe.placeholder};
  }
`,Rr=F.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,Ar=F.button`
  ${de}
`;F.button`
  ${de}
`;const qe=F.button`
  ${de}
`,Cr=F.button`
  ${de}
`,$t=F.button`
  height: 100%;
  text-align: left;
  display: flex;
  align-items: top;
  background-color: transparent;
  border-color: transparent;
  border-radius: ${Mt.xs};
  color: ${Oe.black};
  transition: background-color 250ms;
`,Dt=$e`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
`,kr=F.iframe`
  ${Dt}

  height: 60px;
  border-radius: 30px;
`,Er=F.audio`
  ${Dt}
`,Ze=({el:e,setIsForm:n})=>{const t=le(),h=I.useRef(null),c=I.useRef(null),d=I.useRef(null),{user:o}=ue(),{activeCluster:s}=ie(),[l,A]=I.useState(""),{_id:C,element:b,caption:w}=e,{register:v,watch:g,setValue:R,handleSubmit:y,setFocus:p}=Pn({mode:"onBlur",defaultValues:{element:b,caption:w}});I.useEffect(()=>{R("caption",w)},[w,R]);const{ref:r,...u}=v("element"),{ref:f,...T}=v("caption"),x=[h.current,c.current,d.current],j=[g("caption"),g("element")];zn(x,j),I.useEffect(()=>{p("element"),l&&b.trim().startsWith("der")?R("element",l+b.replace("der","").trim()+", "):l&&b.trim().startsWith("die")?R("element",l+b.replace("die","").trim()+", "):l&&b.trim().startsWith("das")?R("element",l+b.replace("das","").trim()+", "):l?R("element",l+b+", "):R("element",l+b)},[l,b,p,R]),I.useEffect(()=>{const N=async S=>{(S.code==="NumpadAdd"||S.ctrlKey&&S.key==="Escape")&&(S.preventDefault(),await z(o.engine),y(D)()),S.key==="Enter"&&(S.preventDefault(),y(D)()),S.key==="Escape"&&n(!1)};return addEventListener("keydown",N),()=>{removeEventListener("keydown",N)}},[]);const D=N=>{const S=o.lang;let _=N.caption.trim(),E=Ue(N.element,s.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();E=Me(E,","),_=Me(_,","),o.lang.includes("en")&&s.lang.includes("de")&&(E.includes("hat")||E.includes("ist"))&&E.split(`
`)[0].split(/,\s+/)[0].endsWith("n")&&(_=_.split(/,\s+/).map(M=>M.startsWith("to ")?M:`to ${M}`).join(", ")),t(C?je({_id:C,lang:S,element:E,caption:_}):Rt({...e,caption:_})).then(t(At())),n(!1)},V=()=>{l===""&&A("der "),l==="der "&&A("die "),l==="die "&&A("das "),l==="das "&&A("")},z=async N=>{const S=g("element"),_=Ue(S,s.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim(),E={from:s.lang,to:o.lang},P=await we(_,E,N);R("caption",P)};return $.jsxs(Sr,{onSubmit:y(D),children:[$.jsx(wt,{...u,name:"element",ref:N=>{r(N),h.current=N}}),$.jsxs(Rr,{ref:d,children:[$.jsx(Cr,{type:"button",onClick:V,children:$.jsx(Mn,{size:"18px"})}),$.jsx(qe,{type:"button",onClick:()=>z("google"),children:$.jsx(dn,{size:"16px"})}),$.jsx(qe,{type:"button",onClick:()=>z("deepl"),children:$.jsx(gn,{size:"18px"})}),$.jsx(Ar,{children:$.jsx(mn,{size:"16px"})})]}),$.jsx(wt,{...T,name:"caption",ref:N=>{f(N),c.current=N}})]})};Ze.propTypes={el:B.object,setIsForm:B.func};const{button:_r}=Q.shadows,{m:Lr}=Q.indents,xr=()=>{const{user:e}=ue(),[n,t]=I.useState(!1),{activeCluster:h}=ie(),[c,d]=I.useState(""),[o,s]=I.useState(""),{transcript:l,listening:A,resetTranscript:C}=ye.useSpeechRecognition(),{isMicrophoneAvailable:b}=ye.useSpeechRecognition(),{browserSupportsSpeechRecognition:w}=ye.useSpeechRecognition(),v=c.endsWith(", ")?l:l.replace(/^./,p=>p.toUpperCase()),g=`${c}${v}`,R=(p,r)=>p.trim().endsWith(r)?`${p.trim()} `:`${p.trim()}${r} `;if(I.useEffect(()=>{if(!A||!n)return;const p=[".","?","!",","],r=u=>{if(p.includes(u.key)){u.preventDefault();const f=R(g,u.key);d(f),C()}if(u.key==="Backspace"){u.preventDefault();const f=g.substring(0,g.length-1);d(f),C()}if(u.code==="Space"){u.preventDefault();const f=g+" ";d(f),C()}};return addEventListener("keydown",r),()=>{removeEventListener("keydown",r)}},[g,n,A,c,C]),I.useEffect(()=>{const p=async r=>{if(!A&&r.metaKey&&r.key==="r"&&(r.preventDefault(),d(""),s(""),t(!0),be.startListening({language:h.lang,continuous:!0})),A){if(r.preventDefault(),r.key==="Escape")return be.stopListening();if(r.metaKey&&r.key==="r"){be.stopListening();const u=l?R(g,"."):g,f={from:h.lang,to:e.lang},T=await we(u,f,e.engine);![".","?","!"].includes(g.at(g.length-1))&&d(u),s(T),C()}}};return addEventListener("keydown",p),()=>{removeEventListener("keydown",p)}},[h.lang,g,A,C,l,e.engine,e.lang]),!w||!b)return;const y=async p=>{if(p==null||p.currentTarget.blur(),!A)d(""),s(""),t(!0),be.startListening({language:h.lang,continuous:!0});else{be.stopListening();const r=l?R(g,"."):g,u={from:h.lang,to:e.lang},f=await we(r,u,e.engine);![".","?","!"].includes(g.at(g.length-1))&&d(r),s(f),C()}};return $.jsxs($.Fragment,{children:[$.jsx(pe,{onClick:y,$s:"m",$round:!0,$bs:_r,children:A?$.jsx(bn,{size:18}):$.jsx(vn,{size:18})}),n&&$.jsx(yn,{$x:`left: ${Lr}`,$y:"top: 50%",$bd:"none",children:$.jsx(Ze,{el:{cluster:h._id,element:g,caption:o,favorite:!0,checked:g.split(/\s+/).length<20},setIsForm:t})})]})},{m:jr,s:Pr}=Q.indents,It=({className:e})=>{const{pathname:n}=wn(),{elementTrash:t}=fe(),{activeCluster:h}=ie(),c=t.length>0?" 1fr":"",d=h?" 1fr":"",o=c+d+" 1fr 1fr";if(n.includes("/element"))return $.jsxs(He,{className:e,$m:`${Pr} ${jr}`,$pos:"fixed",$side:"left",$high:"bottom",$gtc:o,children:[$.jsx(Zn,{}),$.jsx(xr,{}),d&&$.jsx(Kn,{}),c&&$.jsx(Hn,{})]})};It.propTypes={className:B.string};const{colors:We}=Q,Mr=F.div`
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  &:hover svg {
    stroke: ${We.yellow};
  }

  & svg {
    transition: stroke 250ms;
    stroke: ${We.hovered};
    /* stroke: ${({$colored:e})=>e&&We.yellow}; */
    @keyframes refresh-spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(-360deg);
      }
    }
    animation: refresh-spin infinite 12s linear;
  }
`,zt=({onClick:e})=>$.jsx(Mr,{onClick:e,children:$.jsx($n,{size:"35px"})});zt.propTypes={onClick:B.func};const{background:Fe}=Q.colors,{button:St}=Q.shadows,{m:Or,s:Dr}=Q.indents,Nt=({className:e,filtredElements:n,setLiColor:t})=>{const{user:h}=ue(),{activeCluster:c}=ie(),{activeElement:d}=fe(),[o,s]=I.useState(null);if(I.useEffect(()=>{const y=window.speechSynthesis.getVoices();Array.isArray(y)&&y.length>0&&s(y),"onvoiceschanged"in window.speechSynthesis&&(window.speechSynthesis.onvoiceschanged=()=>{const p=window.speechSynthesis.getVoices();s(p)})},[]),!Array.isArray(o)||o.length===0)return;const l=y=>{if(!y.length)return;let p="",r=0;const u=y.reduce((f,T)=>(f[T.lang]||(f[T.lang]=0),f[T.lang]+=1,f),{});for(const f in u)u[f]>r&&(r=u[f],p=f);return p},A=n.length?l(n):h.lang,C=(y,p)=>y.replaceAll(", `",`;${p} `).replaceAll(" `",`${p} `).replaceAll(",`",";"),b=({text:y,playList:p,divider:r})=>{let u="";for(let f=0;f<p.length;f+=1){let T=p[f][y];const x=`@±@${p[f].lang}${r}`;T.endsWith(".")||T.endsWith("!")||T.endsWith("?")||T.endsWith('"')?(u+=C(T,r).replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",y!=="caption"?`__${r}`:`__${x}`).replaceAll(".",y!=="caption"?`.${r}`:`.${x}`).replaceAll(",",y!=="caption"?`,${r}`:`,${x}`).replaceAll("!",y!=="caption"?`!${r}`:`!${x}`).replaceAll("?",y!=="caption"?`?${r}`:`?${x}`).replaceAll(":",y!=="caption"?`:${r}`:`:${x}`),c.lang.includes("de")&&(u=u.replaceAll(`0.${r}`,"0.").replaceAll(`1.${r}`,"1.").replaceAll(`2.${r}`,"2.").replaceAll(`3.${r}`,"3.").replaceAll(`4.${r}`,"4.").replaceAll(`5.${r}`,"5.").replaceAll(`6.${r}`,"6.").replaceAll(`7.${r}`,"7.").replaceAll(`8.${r}`,"8.").replaceAll(`9.${r}`,"9."))):p[f].element.startsWith("[")||(y==="caption"&&(T.includes(" [")&&(T=T.substring(0,T.indexOf(" ["))),T=`${T}@±@${p[f].lang}`),u+=T+r)}return u},w=o,v=y=>{y.currentTarget.blur(),t(Fe);const p="$*@",r=n.findIndex(T=>T.element===d.element),u=n.splice(r===-1?0:r),f=Pe({setLiColor:t,divider:p,voices:w,text:b({text:"element",playList:u,divider:p}),lang:c.lang,rate:c.rate});f&&re.error(f)},g=y=>{y.currentTarget.blur();const p="$*@";t(Fe);const r=n.findIndex(T=>T.element===d.element),u=n.splice(r===-1?0:r),f=Pe({setLiColor:t,divider:p,voices:w,text:b({text:"caption",playList:u,divider:p}),lang:A,rate:h.rate});f&&re.error(f)},R=y=>{y.currentTarget.blur(),t(Fe);let p="";const r="$*@",u=n.findIndex(x=>x.element===d.element),f=n.splice(u===-1?0:u);for(let x=0;x<f.length;x+=1){const{element:j,caption:D,lang:V}=f[x];if(!j.startsWith("[")){const z=C(j,""),N=D.includes(" [")?D.substring(0,D.indexOf(" [")):C(D,"");p+=z+`@±@${V}`+N+r}}const T=Sn({setLiColor:t,divider:r,voices:w,text:p,lang:c.lang,rate:h.rate});T&&re.error(T)};return $.jsxs(He,{className:e,$m:`${Dr} ${Or}`,$pos:"fixed",$side:"right",$high:"bottom",$gtc:"1fr 0.5fr 1fr",children:[$.jsx(pe,{onClick:v,$s:"m",$round:!0,$bs:St,children:(c==null?void 0:c.lang.at(0).toUpperCase())+(c==null?void 0:c.lang.substring(1))}),$.jsx(zt,{onClick:R}),$.jsx(pe,{onClick:g,$s:"m",$round:!0,$bs:St,children:(A==null?void 0:A.at(0).toUpperCase())+(A==null?void 0:A.substring(1))})]})};Nt.propTypes={className:B.string,filtredElements:B.array,setLiColor:B.func};const Bt=({el:e,sortByDate:n,setSortByDate:t,setLiColor:h})=>{const c=le(),{user:d}=ue(),{activeCluster:o}=ie(),{element:s,caption:l}=e,A="$*@",C=(r,u)=>{let f="";return u?(r.trim().endsWith(".")||r.trim().endsWith("!")||r.trim().endsWith("?")||r.endsWith('"')?(f=r.trim().replaceAll(", `",`;${u} `).replaceAll(" `",`${u} `).replaceAll(",`",";").replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",`__${u}`).replaceAll(".",`.${u}`).replaceAll(",",`,${u}`).replaceAll("!",`!${u}`).replaceAll("?",`?${u}`).replaceAll(":",`:${u}`),o.lang.includes("de")&&(f=f.replaceAll(`0.${u}`,"0.").replaceAll(`1.${u}`,"1.").replaceAll(`2.${u}`,"2.").replaceAll(`3.${u}`,"3.").replaceAll(`4.${u}`,"4.").replaceAll(`5.${u}`,"5.").replaceAll(`6.${u}`,"6.").replaceAll(`7.${u}`,"7.").replaceAll(`8.${u}`,"8.").replaceAll(`9.${u}`,"9."))):f=r.trim()+u,f.includes("[")?f.substring(0,f.indexOf("["))+u:f):r},b=r=>{r.currentTarget.blur();const u=Pe({setLiColor:h,divider:A,voices:window.speechSynthesis.getVoices(),text:C(s,A),lang:o.lang,rate:o.rate});u&&re.error(u)},w=r=>{r.currentTarget.blur();const u=Pe({setLiColor:h,divider:A,voices:window.speechSynthesis.getVoices(),text:C(l,A),lang:e.lang,rate:d.rate});u&&re.error(u)},v=r=>{t(!n),n?re.success("Below is Recent"):re.success("Above is Recent"),r.stopPropagation()},g=r=>{const{_id:u}=o;c(Ct(e)),r.currentTarget.closest("li").id!=="active-element"&&c(Ve({_id:u,activeEl:e._id}))},R=l.endsWith("mp3"),y=!R&&l.startsWith("http"),p=!R&&!y;return $.jsxs($r,{onClick:g,children:[$.jsx($t,{onClick:b,children:s}),$.jsx(Tr,{onClick:v}),R&&$.jsx(Er,{controls:!0,src:mt(l)}),y&&$.jsx(kr,{src:mt(l)}),p&&$.jsx($t,{onClick:w,children:l})]})};Bt.propTypes={el:B.object,sortByDate:B.bool,setSortByDate:B.func,$active:B.bool,$hovered:B.bool,setLiColor:B.func};const Wt=({el:e,index:n,length:t,sortByDate:h,setSortByDate:c,translateAll:d,liColor:o,setLiColor:s})=>{const l=le(),{elementTrash:A,activeElement:C}=fe(),[b,w]=I.useState(!1),{_id:v,favorite:g,checked:R}=e,y=A.find(x=>x._id===v),p=()=>{l(je({_id:v,favorite:!g}))},r=()=>{l(je({_id:v,checked:!R}))},u=()=>l(kn(e)),f=()=>w(!b),T=v===(C==null?void 0:C._id);return $.jsxs(mr,{id:T?"active-element":null,licolor:o,children:[$.jsxs(Ge,{$h:"100%",$p:"0",$fd:"column",children:[$.jsxs(vr,{$hovered:g,children:[$.jsx("input",{type:"checkbox",name:"favorite",checked:g,onChange:p}),$.jsx(xn,{size:"20px"})]}),$.jsxs(br,{$hovered:R,children:[$.jsx("input",{type:"checkbox",name:"checked",checked:R,onChange:r}),$.jsx(Tn,{size:"15px"})]}),b&&t===n+1&&$.jsx(qe,{onClick:d,children:$.jsx(Rn,{size:"16px"})})]}),b&&$.jsx(Ze,{el:e,setIsForm:w}),!b&&$.jsx(Bt,{el:e,sortByDate:h,setSortByDate:c,setLiColor:s}),$.jsxs(Ge,{$h:"100%",$p:"0",$fd:"column",children:[$.jsx(yr,{$hovered:y,onClick:u,children:$.jsx(An,{size:"16px"})}),$.jsx(wr,{onClick:f,children:$.jsx(Cn,{size:"15px"})})]})]})};Wt.propTypes={el:B.object,index:B.number,length:B.number,sortByDate:B.bool,setSortByDate:B.func,translateAll:B.func,liColor:B.string,setLiColor:B.func};const Ir=F.ul`
  width: 100%;
  list-style: none;
`,{white:zr}=Q.colors,Nr=()=>{const e=le(),{ref:n,inView:t,entry:h}=Gn({initialInView:!0,rootMargin:"0px 0px -30px 0px"}),{user:c}=ue(),{activeCluster:d}=ie(),{allElements:o,elementTrash:s,elementFilter:l,isLoading:A}=fe(),[C,b]=I.useState(zr);let{elementSelect:w}=fe();w=w||[];const[v,g]=I.useState(!1);I.useEffect(()=>{d&&e(At({cluster:d._id})).unwrap().then(({result:f})=>{if(!d.activeEl)return;const T=f.elements.find(({_id:x})=>x===d.activeEl);e(Ct(T))}).then(()=>{const f=document.getElementById("active-element");f&&En(f)})},[]);const R=o.filter(f=>f.cluster===(d==null?void 0:d._id)).sort((f,T)=>f.createdAt.localeCompare(T.createdAt)),p=(()=>{const f=s.map(T=>T._id);return w.includes("trash")?R.filter(T=>f.includes(T._id)):R})().filter(({element:f,caption:T,favorite:x,checked:j})=>{const D=f.toLowerCase().replace("·","").includes(l)||f.toLowerCase().includes(l)||T.toLowerCase().includes(l),V=w.includes("wordlist")?D&&On(f):D,z=()=>w.some(S=>["favorite","unfavorite"].includes(S))?w.includes("favorite")?V&&x===!0:V&&x===!1:V;return(()=>w.some(S=>["checked","unchecked"].includes(S))?w.includes("checked")?z()&&j===!0:z()&&j===!1:z())()}).sort(v?(f,T)=>T.createdAt.localeCompare(f.createdAt):(f,T)=>f.createdAt.localeCompare(T.createdAt)),r=async()=>{const f=c.lang;let T=0;await p.forEach(async x=>{if(T>1)return;const{_id:j,element:D}=x;if(!D.startsWith("[")||f!==x.lang){const V={from:d.lang,to:f},z=await we(D,V,c.engine);e(je({_id:j,lang:f,caption:z})),T=T+1}})},u=window.innerHeight<(h==null?void 0:h.target.getBoundingClientRect().y)+(h==null?void 0:h.target.getBoundingClientRect().height)*1.5;return $.jsxs($.Fragment,{children:[$.jsxs(Ir,{children:[p.map((f,T,x)=>$.jsx(Wt,{el:f,index:T,length:x.length,sortByDate:v,setSortByDate:g,translateAll:r,liColor:C,setLiColor:b},f._id)),$.jsxs("div",{ref:n,children:[$.jsx(_t,{}),$.jsx(It,{className:!t||!u?"shown":"hidden"}),$.jsx(Nt,{className:!t||!u?"shown":"hidden",filtredElements:p,setLiColor:b})]})]}),A&&$.jsx(_n,{})]})},{s:Tt,m:Br}=Q.indents,Kr=()=>$.jsx(Ge,{$p:`0 ${Br} ${Tt} ${Tt}`,children:$.jsx(Nr,{})});export{Kr as default};
