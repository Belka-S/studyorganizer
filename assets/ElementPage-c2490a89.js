import{U as Ne,r as z,t as Q,P as B,u as le,b as ue,q as ie,j as $,T as Ke,V as Re,x as Ve,E as dt,H as gt,w as pe,S as cn,W as Rt,X as ln,Q as re,z as fe,Y as un,Z as pn,G as fn,i as hn,n as we,s as F,_ as dn,$ as gn,a0 as mn,a1 as je,a2 as At,a3 as vn,a4 as bn,M as yn,a5 as wn,a6 as $n,a7 as Pe,a8 as Sn,a9 as mt,aa as Ct,F as Ge,D as Tn,ab as Rn,C as An,A as Cn,ac as kn,N as En,ad as _n}from"./index-0211e790.js";import{r as kt,H as Ln,T as xn}from"./index-5213d5ba.js";import{w as Et}from"./writeClipboard-1efc5621.js";import{v as jn,u as Pn}from"./index.esm-c66b29f2.js";import{a as Mn}from"./index-b64a49c0.js";const Ue=(e,n)=>{if(!n.includes("de"))return e;const t=e.trim().split(`
`);return t.length===1?e:["der","die","das"].includes(t[0].split(" ")[0])?`${t[0].trim()}, ${t[1].split("·")[1].replaceAll("⁰","").replaceAll("/"," / ").trim()}`:(e.includes("hat")||e.includes("ist"))&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e.includes("am")&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e},On=e=>/[a-z]/.test(e.charAt(0)),{VITE_DEEPL_API_KEY:Dn}={VITE_GOOGLE_CLIENT_ID:"689266183428-lh3lmpaqnd2qd6t93voa8s6ipt3836q1.apps.googleusercontent.com",VITE_DEEPL_API_KEY:"d15bf272-fb1f-4f29-bbc3-d3bbdd686c53:fx",VITE_GOOGLE_API_KEY:"AIzaSyDqQndBxYEuOG7F6iYDqQoiNF90tptRmBQ",VITE_PROD_BACK_URL:"https://studyorganizer.onrender.com",BASE_URL:"/studyorganizer/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},zn={google:"",deepl:Dn},ye=async(e,{from:n,to:t},h)=>{var d,o;if(!e||e.length===0)return"";const c=e.replaceAll(" ·",",").replaceAll("·","");Ne.engine=h,Ne.key=zn[h];try{let a=await Ne(`${c}`,{from:n,to:t});if(t.includes("en")&&c.toLowerCase().includes("uhr")&&(a=a.replaceAll("a.m. on","am on").replaceAll("p.m. on","pm on").replaceAll("a.m. to","am to").replaceAll("p.m. to","pm to").replaceAll("a.m.","am.").replaceAll("p.m.","pm.")),[".","!","?"].includes(c.at(c.length-1)))return a;const C=c.split(c.includes(", ")?", ":/\s+/),A=a.split(", "),b=t.includes("de")?A[0]:A[0].at(0).toLowerCase()+A[0].substring(1);return C.length===1?a.toLocaleLowerCase()+", ":["der","die","das"].includes(C[0].split(" ")[0])?a.replace("The ","").replace("the ","").split(", ")[0].toLocaleLowerCase()+", ":t.includes("en")&&((d=C[2])!=null&&d.startsWith("am"))?A[2].startsWith("the")?a:`${b}, ${A[1]}, the ${A[2]}`:(C[0].endsWith("n")&&["hat","ist"].includes((o=C[2])==null?void 0:o.split(" ")[0])&&n.includes("de")&&(a=t.includes("en")?"to "+b+", ":b+", "),a)}catch(a){return a.message}},Me=(e,n)=>e.endsWith(n)?e.substring(0,e.length-1):e,In=(e,n)=>{let t=84;e[0]&&(t=Number(e[0].style.height.replace("px",""))),z.useEffect(()=>{if(!e[0])return;let h=Math.max(...e.map(c=>c.scrollHeight));t!==h&&(h=h<=90?h:h+6,e.forEach(c=>{c.style.height=h+"px"}))},[t,e,n])},Ae=[{value:"de",label:"German"},{value:"en",label:"English"},{value:"uk",label:"Ukrainian"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"it",label:"Italian"}],Ce=[{value:.3,label:"Rate: 0.3"},{value:.4,label:"Rate: 0.4"},{value:.5,label:"Rate: 0.5"},{value:.6,label:"Rate: 0.6"},{value:.8,label:"Rate: 0.8"},{value:1,label:"Rate: 1"},{value:1.25,label:"Rate: 1.25"},{value:1.5,label:"Rate: 1.5"}];var qe=new Map,ke=new WeakMap,vt=0,Nn=void 0;function Bn(e){return e?(ke.has(e)||(vt+=1,ke.set(e,vt.toString())),ke.get(e)):"0"}function Wn(e){return Object.keys(e).sort().filter(n=>e[n]!==void 0).map(n=>`${n}_${n==="root"?Bn(e.root):e[n]}`).toString()}function Fn(e){const n=Wn(e);let t=qe.get(n);if(!t){const h=new Map;let c;const d=new IntersectionObserver(o=>{o.forEach(a=>{var u;const C=a.isIntersecting&&c.some(A=>a.intersectionRatio>=A);e.trackVisibility&&typeof a.isVisible>"u"&&(a.isVisible=C),(u=h.get(a.target))==null||u.forEach(A=>{A(C,a)})})},e);c=d.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),t={id:n,observer:d,elements:h},qe.set(n,t)}return t}function Vn(e,n,t={},h=Nn){if(typeof window.IntersectionObserver>"u"&&h!==void 0){const u=e.getBoundingClientRect();return n(h,{isIntersecting:h,target:e,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:u,intersectionRect:u,rootBounds:u}),()=>{}}const{id:c,observer:d,elements:o}=Fn(t),a=o.get(e)||[];return o.has(e)||o.set(e,a),a.push(n),d.observe(e),function(){a.splice(a.indexOf(n),1),a.length===0&&(o.delete(e),d.unobserve(e)),o.size===0&&(d.disconnect(),qe.delete(c))}}function Gn({threshold:e,delay:n,trackVisibility:t,rootMargin:h,root:c,triggerOnce:d,skip:o,initialInView:a,fallbackInView:u,onChange:C}={}){var A;const[b,w]=z.useState(null),v=z.useRef(C),[m,R]=z.useState({inView:!!a,entry:void 0});v.current=C,z.useEffect(()=>{if(o||!b)return;let l;return l=Vn(b,(f,T)=>{R({inView:f,entry:T}),v.current&&v.current(f,T),T.isIntersecting&&d&&l&&(l(),l=void 0)},{root:c,rootMargin:h,threshold:e,trackVisibility:t,delay:n},u),()=>{l&&l()}},[Array.isArray(e)?e.toString():e,b,c,h,d,o,t,u,n]);const y=(A=m.entry)==null?void 0:A.target,p=z.useRef(void 0);!b&&y&&!d&&!o&&p.current!==y&&(p.current=y,R({inView:!!a,entry:void 0}));const r=[w,m.inView,m.entry];return r.ref=r[0],r.inView=r[1],r.entry=r[2],r}const{backgroundHoverd:Ee,white:_e,borderLight:Le}=Q.colors,_t=()=>{const e=le(),{user:n}=ue(),{activeCluster:t}=ie(),h=({value:a})=>{e(Ve({_id:t._id,lang:a})).unwrap().then(u=>e(dt(u.result.cluster)))},c=({value:a})=>{e(Ve({_id:t._id,rate:a})).unwrap().then(u=>e(dt(u.result.cluster)))},d=({value:a})=>{const u=new FormData;u.append("lang",a),e(gt(u))},o=({value:a})=>{const u=new FormData;u.append("rate",a),e(gt(u))};return $.jsxs(Ke,{$m:"0",$cg:"8px",$ai:"center",$gtc:"2fr 2fr 2fr 2fr",children:[$.jsx(Re,{options:Ae,defaultValue:Ae.find(a=>a.value===(t==null?void 0:t.lang)),onChange:h,placeholder:"Language...",$ol:Ee,$b:_e,$bh:Le}),$.jsx(Re,{options:Ce,defaultValue:Ce.find(a=>a.value==(t==null?void 0:t.rate)),onChange:c,placeholder:"Rate...",$ol:Ee,$b:_e,$bh:Le}),$.jsx(Re,{options:Ae,defaultValue:Ae.find(a=>a.value===n.lang),onChange:d,placeholder:"Language...",$ol:Ee,$b:_e,$bh:Le}),$.jsx(Re,{options:Ce,defaultValue:Ce.find(a=>a.value==n.rate),onChange:o,placeholder:"Rate...",$ol:Ee,$b:_e,$bh:Le})]})};_t.propTypes={filtredElements:B.array,setLiColor:B.func};const{button:Un}=Q.shadows,qn=()=>{const e=le(),{user:n}=ue(),{activeCluster:t}=ie();z.useEffect(()=>{const c=async d=>{d.key==="e"&&d.metaKey&&(d.preventDefault(),await h())};return addEventListener("keydown",c),()=>{removeEventListener("keydown",c)}},[]);const h=async c=>{const d=window.getSelection().toString();d&&await Et(d);const o=await kt();let a=Ue(o,t.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();a=Me(a,",");const u={from:t.lang,to:n.lang};let C=await ye(a,u,n.engine);C=Me(C.trim(),",");const{_id:A}=t;try{const b={cluster:A,element:"[]",caption:a},w={cluster:A,element:a,caption:C,favorite:!0,checked:a.split(/\s+/).length<20},v=a.includes("https://")?b:w;e(Rt(v)).unwrap().then(()=>(c==null?void 0:c.target)&&ln()).finally(()=>{var m;return(m=c==null?void 0:c.target)==null?void 0:m.blur()})}catch(b){c==null||c.currentTarget.blur(),re.error(`Invalid element, ${b.message}`)}};return $.jsx(pe,{onClick:h,$s:"m",$round:!0,$bs:Un,children:$.jsx(cn,{size:18})})},{button:Hn}=Q.shadows,Kn=()=>{const e=le(),{elementTrash:n}=fe(),t=()=>{confirm("Are you sure you want to delete the selected Element(s)?")&&e(un(n.map(h=>h._id).join("&"))).unwrap().then(()=>e(pn()))};return $.jsx(pe,{onClick:t,$s:"m",$round:!0,$bs:Hn,children:$.jsx(Ln,{size:16})})};function Yn(e){return fn({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M250.73,210.63l-56-112a12,12,0,0,0-21.46,0l-20.52,41A84.2,84.2,0,0,1,114,126.22,107.48,107.48,0,0,0,139.33,68H160a12,12,0,0,0,0-24H108V32a12,12,0,0,0-24,0V44H32a12,12,0,0,0,0,24h83.13A83.69,83.69,0,0,1,96,110.35,84,84,0,0,1,83.6,91a12,12,0,1,0-21.81,10A107.55,107.55,0,0,0,78,126.24,83.54,83.54,0,0,1,32,140a12,12,0,0,0,0,24,107.47,107.47,0,0,0,64-21.07,108.4,108.4,0,0,0,45.39,19.44l-24.13,48.26a12,12,0,1,0,21.46,10.73L151.41,196h65.17l12.68,25.36a12,12,0,1,0,21.47-10.73ZM163.41,172,184,130.83,204.58,172Z"},child:[]}]})(e)}const{button:Qn}=Q.shadows,Zn=()=>{const{activeCluster:e}=ie();z.useEffect(()=>{const d=async o=>{o.metaKey&&o.key==="d"&&(o.preventDefault(),await c())};return addEventListener("keydown",d),()=>{removeEventListener("keydown",d)}},[]);let n=[];function t(d){d.forEach(o=>{const a=window.open(o,"_blank");a?n.push(a):re.error(`Failed to open tab: ${o}`)})}const h=()=>{n.forEach(d=>{d.close()}),n=[]},c=async()=>{const d=window.getSelection().toString();d&&await Et(d);const o=await kt();let a=[];e.lang.includes("de")&&a.push(`https://www.verbformen.com/conjugation/?w=${o}`),e.lang.includes("en")&&a.push(`https://dictionary.cambridge.org/dictionary/english-russian/${o}`),h(),t(a)};return $.jsx(pe,{onClick:c,$s:"m",$round:!0,$bs:Qn,children:$.jsx(Yn,{size:18})})};var Xn={exports:{}};(function(e){var n=function(t){var h=Object.prototype,c=h.hasOwnProperty,d=Object.defineProperty||function(s,i,g){s[i]=g.value},o,a=typeof Symbol=="function"?Symbol:{},u=a.iterator||"@@iterator",C=a.asyncIterator||"@@asyncIterator",A=a.toStringTag||"@@toStringTag";function b(s,i,g){return Object.defineProperty(s,i,{value:g,enumerable:!0,configurable:!0,writable:!0}),s[i]}try{b({},"")}catch{b=function(i,g,L){return i[g]=L}}function w(s,i,g,L){var k=i&&i.prototype instanceof l?i:l,O=Object.create(k.prototype),H=new W(L||[]);return d(O,"_invoke",{value:S(s,g,H)}),O}t.wrap=w;function v(s,i,g){try{return{type:"normal",arg:s.call(i,g)}}catch(L){return{type:"throw",arg:L}}}var m="suspendedStart",R="suspendedYield",y="executing",p="completed",r={};function l(){}function f(){}function T(){}var x={};b(x,u,function(){return this});var j=Object.getPrototypeOf,D=j&&j(j(M([])));D&&D!==h&&c.call(D,u)&&(x=D);var V=T.prototype=l.prototype=Object.create(x);f.prototype=T,d(V,"constructor",{value:T,configurable:!0}),d(T,"constructor",{value:f,configurable:!0}),f.displayName=b(T,A,"GeneratorFunction");function I(s){["next","throw","return"].forEach(function(i){b(s,i,function(g){return this._invoke(i,g)})})}t.isGeneratorFunction=function(s){var i=typeof s=="function"&&s.constructor;return i?i===f||(i.displayName||i.name)==="GeneratorFunction":!1},t.mark=function(s){return Object.setPrototypeOf?Object.setPrototypeOf(s,T):(s.__proto__=T,b(s,A,"GeneratorFunction")),s.prototype=Object.create(V),s},t.awrap=function(s){return{__await:s}};function N(s,i){function g(O,H,K,Z){var q=v(s[O],s,H);if(q.type==="throw")Z(q.arg);else{var ge=q.arg,ae=ge.value;return ae&&typeof ae=="object"&&c.call(ae,"__await")?i.resolve(ae.__await).then(function(ne){g("next",ne,K,Z)},function(ne){g("throw",ne,K,Z)}):i.resolve(ae).then(function(ne){ge.value=ne,K(ge)},function(ne){return g("throw",ne,K,Z)})}}var L;function k(O,H){function K(){return new i(function(Z,q){g(O,H,Z,q)})}return L=L?L.then(K,K):K()}d(this,"_invoke",{value:k})}I(N.prototype),b(N.prototype,C,function(){return this}),t.AsyncIterator=N,t.async=function(s,i,g,L,k){k===void 0&&(k=Promise);var O=new N(w(s,i,g,L),k);return t.isGeneratorFunction(i)?O:O.next().then(function(H){return H.done?H.value:O.next()})};function S(s,i,g){var L=m;return function(O,H){if(L===y)throw new Error("Generator is already running");if(L===p){if(O==="throw")throw H;return U()}for(g.method=O,g.arg=H;;){var K=g.delegate;if(K){var Z=_(K,g);if(Z){if(Z===r)continue;return Z}}if(g.method==="next")g.sent=g._sent=g.arg;else if(g.method==="throw"){if(L===m)throw L=p,g.arg;g.dispatchException(g.arg)}else g.method==="return"&&g.abrupt("return",g.arg);L=y;var q=v(s,i,g);if(q.type==="normal"){if(L=g.done?p:R,q.arg===r)continue;return{value:q.arg,done:g.done}}else q.type==="throw"&&(L=p,g.method="throw",g.arg=q.arg)}}}function _(s,i){var g=i.method,L=s.iterator[g];if(L===o)return i.delegate=null,g==="throw"&&s.iterator.return&&(i.method="return",i.arg=o,_(s,i),i.method==="throw")||g!=="return"&&(i.method="throw",i.arg=new TypeError("The iterator does not provide a '"+g+"' method")),r;var k=v(L,s.iterator,i.arg);if(k.type==="throw")return i.method="throw",i.arg=k.arg,i.delegate=null,r;var O=k.arg;if(!O)return i.method="throw",i.arg=new TypeError("iterator result is not an object"),i.delegate=null,r;if(O.done)i[s.resultName]=O.value,i.next=s.nextLoc,i.method!=="return"&&(i.method="next",i.arg=o);else return O;return i.delegate=null,r}I(V),b(V,A,"Generator"),b(V,u,function(){return this}),b(V,"toString",function(){return"[object Generator]"});function E(s){var i={tryLoc:s[0]};1 in s&&(i.catchLoc=s[1]),2 in s&&(i.finallyLoc=s[2],i.afterLoc=s[3]),this.tryEntries.push(i)}function P(s){var i=s.completion||{};i.type="normal",delete i.arg,s.completion=i}function W(s){this.tryEntries=[{tryLoc:"root"}],s.forEach(E,this),this.reset(!0)}t.keys=function(s){var i=Object(s),g=[];for(var L in i)g.push(L);return g.reverse(),function k(){for(;g.length;){var O=g.pop();if(O in i)return k.value=O,k.done=!1,k}return k.done=!0,k}};function M(s){if(s!=null){var i=s[u];if(i)return i.call(s);if(typeof s.next=="function")return s;if(!isNaN(s.length)){var g=-1,L=function k(){for(;++g<s.length;)if(c.call(s,g))return k.value=s[g],k.done=!1,k;return k.value=o,k.done=!0,k};return L.next=L}}throw new TypeError(typeof s+" is not iterable")}t.values=M;function U(){return{value:o,done:!0}}return W.prototype={constructor:W,reset:function(s){if(this.prev=0,this.next=0,this.sent=this._sent=o,this.done=!1,this.delegate=null,this.method="next",this.arg=o,this.tryEntries.forEach(P),!s)for(var i in this)i.charAt(0)==="t"&&c.call(this,i)&&!isNaN(+i.slice(1))&&(this[i]=o)},stop:function(){this.done=!0;var s=this.tryEntries[0],i=s.completion;if(i.type==="throw")throw i.arg;return this.rval},dispatchException:function(s){if(this.done)throw s;var i=this;function g(Z,q){return O.type="throw",O.arg=s,i.next=Z,q&&(i.method="next",i.arg=o),!!q}for(var L=this.tryEntries.length-1;L>=0;--L){var k=this.tryEntries[L],O=k.completion;if(k.tryLoc==="root")return g("end");if(k.tryLoc<=this.prev){var H=c.call(k,"catchLoc"),K=c.call(k,"finallyLoc");if(H&&K){if(this.prev<k.catchLoc)return g(k.catchLoc,!0);if(this.prev<k.finallyLoc)return g(k.finallyLoc)}else if(H){if(this.prev<k.catchLoc)return g(k.catchLoc,!0)}else if(K){if(this.prev<k.finallyLoc)return g(k.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(s,i){for(var g=this.tryEntries.length-1;g>=0;--g){var L=this.tryEntries[g];if(L.tryLoc<=this.prev&&c.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var k=L;break}}k&&(s==="break"||s==="continue")&&k.tryLoc<=i&&i<=k.finallyLoc&&(k=null);var O=k?k.completion:{};return O.type=s,O.arg=i,k?(this.method="next",this.next=k.finallyLoc,r):this.complete(O)},complete:function(s,i){if(s.type==="throw")throw s.arg;return s.type==="break"||s.type==="continue"?this.next=s.arg:s.type==="return"?(this.rval=this.arg=s.arg,this.method="return",this.next="end"):s.type==="normal"&&i&&(this.next=i),r},finish:function(s){for(var i=this.tryEntries.length-1;i>=0;--i){var g=this.tryEntries[i];if(g.finallyLoc===s)return this.complete(g.completion,g.afterLoc),P(g),r}},catch:function(s){for(var i=this.tryEntries.length-1;i>=0;--i){var g=this.tryEntries[i];if(g.tryLoc===s){var L=g.completion;if(L.type==="throw"){var k=L.arg;P(g)}return k}}throw new Error("illegal catch attempt")},delegateYield:function(s,i,g){return this.delegate={iterator:M(s),resultName:i,nextLoc:g},this.method==="next"&&(this.arg=o),r}},t}(e.exports);try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})(Xn);var be={},Lt={},X={};Object.defineProperty(X,"__esModule",{value:!0});X.browserSupportsPolyfills=X.compareTwoStringsUsingDiceCoefficient=X.commandToRegExp=X.concatTranscripts=X.debounce=void 0;var Jn=function(n,t,h){var c;return function(){var d=this,o=arguments,a=function(){c=null,h||n.apply(d,o)},u=h&&!c;clearTimeout(c),c=setTimeout(a,t),u&&n.apply(d,o)}};X.debounce=Jn;var er=function(){for(var n=arguments.length,t=new Array(n),h=0;h<n;h++)t[h]=arguments[h];return t.map(function(c){return c.trim()}).join(" ").trim()};X.concatTranscripts=er;var tr=/\s*\((.*?)\)\s*/g,nr=/(\(\?:[^)]+\))\?/g,rr=/(\(\?)?:\w+/g,ir=/\*/g,sr=/[-{}[\]+?.,\\^$|#]/g,ar=function(n){return n instanceof RegExp?new RegExp(n.source,"i"):(n=n.replace(sr,"\\$&").replace(tr,"(?:$1)?").replace(rr,function(t,h){return h?t:"([^\\s]+)"}).replace(ir,"(.*?)").replace(nr,"\\s*$1?\\s*"),new RegExp("^"+n+"$","i"))};X.commandToRegExp=ar;var or=function(n,t){if(n=n.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!n.length&&!t.length)return 1;if(!n.length||!t.length)return 0;if(n===t)return 1;if(n.length===1&&t.length===1||n.length<2||t.length<2)return 0;for(var h=new Map,c=0;c<n.length-1;c++){var d=n.substring(c,c+2),o=h.has(d)?h.get(d)+1:1;h.set(d,o)}for(var a=0,u=0;u<t.length-1;u++){var C=t.substring(u,u+2),A=h.has(C)?h.get(C):0;A>0&&(h.set(C,A-1),a++)}return 2*a/(n.length+t.length-2)};X.compareTwoStringsUsingDiceCoefficient=or;var cr=function(){return typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0)};X.browserSupportsPolyfills=cr;var he={},ce={};Object.defineProperty(ce,"__esModule",{value:!0});ce.APPEND_TRANSCRIPT=ce.CLEAR_TRANSCRIPT=void 0;var lr="CLEAR_TRANSCRIPT";ce.CLEAR_TRANSCRIPT=lr;var ur="APPEND_TRANSCRIPT";ce.APPEND_TRANSCRIPT=ur;Object.defineProperty(he,"__esModule",{value:!0});he.appendTranscript=he.clearTranscript=void 0;var xt=ce,pr=function(){return{type:xt.CLEAR_TRANSCRIPT}};he.clearTranscript=pr;var fr=function(n,t){return{type:xt.APPEND_TRANSCRIPT,payload:{interimTranscript:n,finalTranscript:t}}};he.appendTranscript=fr;var De={};Object.defineProperty(De,"__esModule",{value:!0});De.transcriptReducer=void 0;var bt=ce,hr=X,dr=function(n,t){switch(t.type){case bt.CLEAR_TRANSCRIPT:return{interimTranscript:"",finalTranscript:""};case bt.APPEND_TRANSCRIPT:return{interimTranscript:t.payload.interimTranscript,finalTranscript:(0,hr.concatTranscripts)(n.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};De.transcriptReducer=dr;var jt={},Ye={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){return/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"")};e.default=n})(Ye);var Qe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.isNative=void 0;var n=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),t=function(d){return d===n};e.isNative=t;var h=n;e.default=h})(Qe);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=c(Ye),t=X,h=Qe;function c(b){return b&&b.__esModule?b:{default:b}}function d(b,w,v,m,R,y,p){try{var r=b[y](p),l=r.value}catch(f){v(f);return}r.done?w(l):Promise.resolve(l).then(m,R)}function o(b){return function(){var w=this,v=arguments;return new Promise(function(m,R){var y=b.apply(w,v);function p(l){d(y,m,R,p,r,"next",l)}function r(l){d(y,m,R,p,r,"throw",l)}p(void 0)})}}function a(b,w){if(!(b instanceof w))throw new TypeError("Cannot call a class as a function")}function u(b,w){for(var v=0;v<w.length;v++){var m=w[v];m.enumerable=m.enumerable||!1,m.configurable=!0,"value"in m&&(m.writable=!0),Object.defineProperty(b,m.key,m)}}function C(b,w,v){return w&&u(b.prototype,w),v&&u(b,v),b}var A=function(){function b(w){a(this,b),this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=function(){},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(w),(0,n.default)()&&(this.updateFinalTranscript=(0,t.debounce)(this.updateFinalTranscript,250,!0))}return C(b,[{key:"setSpeechRecognition",value:function(v){var m=!!v&&((0,h.isNative)(v)||(0,t.browserSupportsPolyfills)());m&&(this.disableRecognition(),this.recognition=new v,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(m)}},{key:"subscribe",value:function(v,m){this.subscribers[v]=m}},{key:"unsubscribe",value:function(v){delete this.subscribers[v]}},{key:"emitListeningChange",value:function(v){var m=this;this.listening=v,Object.keys(this.subscribers).forEach(function(R){var y=m.subscribers[R].onListeningChange;y(v)})}},{key:"emitMicrophoneAvailabilityChange",value:function(v){var m=this;this.isMicrophoneAvailable=v,Object.keys(this.subscribers).forEach(function(R){var y=m.subscribers[R].onMicrophoneAvailabilityChange;y(v)})}},{key:"emitTranscriptChange",value:function(v,m){var R=this;Object.keys(this.subscribers).forEach(function(y){var p=R.subscribers[y].onTranscriptChange;p(v,m)})}},{key:"emitClearTranscript",value:function(){var v=this;Object.keys(this.subscribers).forEach(function(m){var R=v.subscribers[m].onClearTranscript;R()})}},{key:"emitBrowserSupportsSpeechRecognitionChange",value:function(v){var m=this;Object.keys(this.subscribers).forEach(function(R){var y=m.subscribers[R],p=y.onBrowserSupportsSpeechRecognitionChange,r=y.onBrowserSupportsContinuousListeningChange;p(v),r(v)})}},{key:"disconnect",value:function(v){if(this.recognition&&this.listening)switch(v){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}},{key:"disableRecognition",value:function(){this.recognition&&(this.recognition.onresult=function(){},this.recognition.onend=function(){},this.recognition.onerror=function(){},this.listening&&this.stopListening())}},{key:"onError",value:function(v){v&&v.error&&v.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}},{key:"onRecognitionDisconnect",value:function(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}},{key:"updateTranscript",value:function(v){var m=v.results,R=v.resultIndex,y=R===void 0?m.length-1:R;this.interimTranscript="",this.finalTranscript="";for(var p=y;p<m.length;++p)m[p].isFinal&&(!(0,n.default)()||m[p][0].confidence>0)?this.updateFinalTranscript(m[p][0].transcript):this.interimTranscript=(0,t.concatTranscripts)(this.interimTranscript,m[p][0].transcript);var r=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(r=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,r||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}},{key:"updateFinalTranscript",value:function(v){this.finalTranscript=(0,t.concatTranscripts)(this.finalTranscript,v)}},{key:"resetTranscript",value:function(){this.disconnect("RESET")}},{key:"startListening",value:function(){var w=o(regeneratorRuntime.mark(function m(){var R,y,p,r,l,f,T=arguments;return regeneratorRuntime.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(R=T.length>0&&T[0]!==void 0?T[0]:{},y=R.continuous,p=y===void 0?!1:y,r=R.language,this.recognition){j.next=3;break}return j.abrupt("return");case 3:if(l=p!==this.recognition.continuous,f=r&&r!==this.recognition.lang,!(l||f)){j.next=11;break}if(!this.listening){j.next=9;break}return j.next=9,this.stopListening();case 9:this.recognition.continuous=l?p:this.recognition.continuous,this.recognition.lang=f?r:this.recognition.lang;case 11:if(this.listening){j.next=22;break}return this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript()),j.prev=13,j.next=16,this.start();case 16:this.emitListeningChange(!0),j.next=22;break;case 19:j.prev=19,j.t0=j.catch(13),j.t0 instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1);case 22:case"end":return j.stop()}},m,this,[[13,19]])}));function v(){return w.apply(this,arguments)}return v}()},{key:"abortListening",value:function(){var w=o(regeneratorRuntime.mark(function m(){var R=this;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.disconnect("ABORT"),this.emitListeningChange(!1),p.next=4,new Promise(function(r){R.onStopListening=r});case 4:case"end":return p.stop()}},m,this)}));function v(){return w.apply(this,arguments)}return v}()},{key:"stopListening",value:function(){var w=o(regeneratorRuntime.mark(function m(){var R=this;return regeneratorRuntime.wrap(function(p){for(;;)switch(p.prev=p.next){case 0:return this.disconnect("STOP"),this.emitListeningChange(!1),p.next=4,new Promise(function(r){R.onStopListening=r});case 4:case"end":return p.stop()}},m,this)}));function v(){return w.apply(this,arguments)}return v}()},{key:"getRecognition",value:function(){return this.recognition}},{key:"start",value:function(){var w=o(regeneratorRuntime.mark(function m(){return regeneratorRuntime.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:if(!(this.recognition&&!this.listening)){y.next=4;break}return y.next=3,this.recognition.start();case 3:this.listening=!0;case 4:case"end":return y.stop()}},m,this)}));function v(){return w.apply(this,arguments)}return v}()},{key:"stop",value:function(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}},{key:"abort",value:function(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}}]),b}();e.default=A})(jt);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.useSpeechRecognition=void 0;var n=z,t=X,h=he,c=De,d=u(jt),o=u(Ye),a=u(Qe);function u(S){return S&&S.__esModule?S:{default:S}}function C(S,_,E,P,W,M,U){try{var s=S[M](U),i=s.value}catch(g){E(g);return}s.done?_(i):Promise.resolve(i).then(P,W)}function A(S){return function(){var _=this,E=arguments;return new Promise(function(P,W){var M=S.apply(_,E);function U(i){C(M,P,W,U,s,"next",i)}function s(i){C(M,P,W,U,s,"throw",i)}U(void 0)})}}function b(S){return m(S)||v(S)||r(S)||w()}function w(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v(S){if(typeof Symbol<"u"&&Symbol.iterator in Object(S))return Array.from(S)}function m(S){if(Array.isArray(S))return l(S)}function R(S){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?R=function(E){return typeof E}:R=function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},R(S)}function y(S,_){return T(S)||f(S,_)||r(S,_)||p()}function p(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r(S,_){if(S){if(typeof S=="string")return l(S,_);var E=Object.prototype.toString.call(S).slice(8,-1);if(E==="Object"&&S.constructor&&(E=S.constructor.name),E==="Map"||E==="Set")return Array.from(S);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return l(S,_)}}function l(S,_){(_==null||_>S.length)&&(_=S.length);for(var E=0,P=new Array(_);E<_;E++)P[E]=S[E];return P}function f(S,_){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(S)))){var E=[],P=!0,W=!1,M=void 0;try{for(var U=S[Symbol.iterator](),s;!(P=(s=U.next()).done)&&(E.push(s.value),!(_&&E.length===_));P=!0);}catch(i){W=!0,M=i}finally{try{!P&&U.return!=null&&U.return()}finally{if(W)throw M}}return E}}function T(S){if(Array.isArray(S))return S}var x=!!a.default,j=x&&!(0,o.default)(),D,V=function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},E=_.transcribing,P=E===void 0?!0:E,W=_.clearTranscriptOnListen,M=W===void 0?!0:W,U=_.commands,s=U===void 0?[]:U,i=(0,n.useState)(I.getRecognitionManager()),g=y(i,1),L=g[0],k=(0,n.useState)(x),O=y(k,2),H=O[0],K=O[1],Z=(0,n.useState)(j),q=y(Z,2),ge=q[0],ae=q[1],ne=(0,n.useReducer)(c.transcriptReducer,{interimTranscript:L.interimTranscript,finalTranscript:""}),Xe=y(ne,2),Je=Xe[0],et=Je.interimTranscript,tt=Je.finalTranscript,nt=Xe[1],Ft=(0,n.useState)(L.listening),rt=y(Ft,2),Vt=rt[0],Gt=rt[1],Ut=(0,n.useState)(L.isMicrophoneAvailable),it=y(Ut,2),qt=it[0],Ht=it[1],st=(0,n.useRef)(s);st.current=s;var at=function(){nt((0,h.clearTranscript)())},me=(0,n.useCallback)(function(){L.resetTranscript(),at()},[L]),Kt=function(Y,te,oe){var se=R(Y)==="object"?Y.toString():Y,ve=se.replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),$e=(0,t.compareTwoStringsUsingDiceCoefficient)(ve,te);return $e>=oe?{command:Y,commandWithoutSpecials:ve,howSimilar:$e,isFuzzyMatch:!0}:null},Yt=function(Y,te){var oe=(0,t.commandToRegExp)(Y),se=oe.exec(te);return se?{command:Y,parameters:se.slice(1)}:null},ot=(0,n.useCallback)(function(ee,Y){st.current.forEach(function(te){var oe=te.command,se=te.callback,ve=te.matchInterim,$e=ve===void 0?!1:ve,ut=te.isFuzzyMatch,pt=ut===void 0?!1:ut,ft=te.fuzzyMatchingThreshold,Zt=ft===void 0?.8:ft,ht=te.bestMatchOnly,Xt=ht===void 0?!1:ht,Se=!Y&&$e?ee.trim():Y.trim(),Jt=Array.isArray(oe)?oe:[oe],Te=Jt.map(function(J){return pt?Kt(J,Se,Zt):Yt(J,Se)}).filter(function(J){return J});if(pt&&Xt&&Te.length>=2){Te.sort(function(J,Ie){return Ie.howSimilar-J.howSimilar});var ze=Te[0],en=ze.command,tn=ze.commandWithoutSpecials,nn=ze.howSimilar;se(tn,Se,nn,{command:en,resetTranscript:me})}else Te.forEach(function(J){if(J.isFuzzyMatch){var Ie=J.command,rn=J.commandWithoutSpecials,sn=J.howSimilar;se(rn,Se,sn,{command:Ie,resetTranscript:me})}else{var an=J.command,on=J.parameters;se.apply(void 0,b(on).concat([{command:an,resetTranscript:me}]))}})})},[me]),ct=(0,n.useCallback)(function(ee,Y){P&&nt((0,h.appendTranscript)(ee,Y)),ot(ee,Y)},[ot,P]),lt=(0,n.useCallback)(function(){M&&at()},[M]);(0,n.useEffect)(function(){var ee=I.counter;I.counter+=1;var Y={onListeningChange:Gt,onMicrophoneAvailabilityChange:Ht,onTranscriptChange:ct,onClearTranscript:lt,onBrowserSupportsSpeechRecognitionChange:K,onBrowserSupportsContinuousListeningChange:ae};return L.subscribe(ee,Y),function(){L.unsubscribe(ee)}},[P,M,L,ct,lt]);var Qt=(0,t.concatTranscripts)(tt,et);return{transcript:Qt,interimTranscript:et,finalTranscript:tt,listening:Vt,isMicrophoneAvailable:qt,resetTranscript:me,browserSupportsSpeechRecognition:H,browserSupportsContinuousListening:ge}};e.useSpeechRecognition=V;var I={counter:0,applyPolyfill:function(_){D?D.setSpeechRecognition(_):D=new d.default(_);var E=!!_&&(0,t.browserSupportsPolyfills)();x=E,j=E},removePolyfill:function(){D?D.setSpeechRecognition(a.default):D=new d.default(a.default),x=!!a.default,j=x&&!(0,o.default)()},getRecognitionManager:function(){return D||(D=new d.default(a.default)),D},getRecognition:function(){var _=I.getRecognitionManager();return _.getRecognition()},startListening:function(){var S=A(regeneratorRuntime.mark(function E(){var P,W,M,U,s=arguments;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return P=s.length>0&&s[0]!==void 0?s[0]:{},W=P.continuous,M=P.language,U=I.getRecognitionManager(),g.next=4,U.startListening({continuous:W,language:M});case 4:case"end":return g.stop()}},E)}));function _(){return S.apply(this,arguments)}return _}(),stopListening:function(){var S=A(regeneratorRuntime.mark(function E(){var P;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return P=I.getRecognitionManager(),M.next=3,P.stopListening();case 3:case"end":return M.stop()}},E)}));function _(){return S.apply(this,arguments)}return _}(),abortListening:function(){var S=A(regeneratorRuntime.mark(function E(){var P;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return P=I.getRecognitionManager(),M.next=3,P.abortListening();case 3:case"end":return M.stop()}},E)}));function _(){return S.apply(this,arguments)}return _}(),browserSupportsSpeechRecognition:function(){return x},browserSupportsContinuousListening:function(){return j}},N=I;e.default=N})(Lt);(function(e){function n(o){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(u){return typeof u}:n=function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},n(o)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"useSpeechRecognition",{enumerable:!0,get:function(){return t.useSpeechRecognition}}),e.default=void 0;var t=c(Lt);function h(){if(typeof WeakMap!="function")return null;var o=new WeakMap;return h=function(){return o},o}function c(o){if(o&&o.__esModule)return o;if(o===null||n(o)!=="object"&&typeof o!="function")return{default:o};var a=h();if(a&&a.has(o))return a.get(o);var u={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var A in o)if(Object.prototype.hasOwnProperty.call(o,A)){var b=C?Object.getOwnPropertyDescriptor(o,A):null;b&&(b.get||b.set)?Object.defineProperty(u,A,b):u[A]=o[A]}return u.default=o,a&&a.set(o,u),u}var d=t.default;e.default=d})(be);const xe=hn(be),{colors:G,shadows:yt,indents:Be}=Q,gr=we`
  margin-bottom: 7px;
  padding-block: ${Be.xs};

  display: grid;
  align-items: center;
  grid-template-columns: 1fr 25fr 1fr;

  border: 1px solid transparent;
  background-color: ${({licolor:e})=>e};
  border-radius: ${Be.xs};
  font-size: 22px;

  &:last-of-type {
    margin-bottom: ${Be.s};
  }
`,mr=F.li`
  ${gr}

  transition: box-shadow 250ms, border-color 250ms;

  &#active-element {
    border-color: ${G.border};
    background-color: ${G.background};
    box-shadow: ${yt.back};

    &:hover {
      border-color: ${G.accent};
    }
    & div button {
      transition: color 250ms;
      color: ${G.smokeBlack};
      &:hover {
        color: ${G.hovered};
      }
    }
  }

  & div button {
    transition: color 250ms;
    &:hover {
      color: ${G.hovered};
    }
  }

  &:hover {
    border-color: ${G.accent};
    box-shadow: ${yt.back};
  }

  &:hover label,
  &:hover button {
    opacity: 1;
  }
`,Pt=we`
  min-height: 19px;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  & input {
    ${jn}
  }
`,vr=F.label`
  ${Pt}

  & svg {
    transition: stroke 250ms;
    stroke-width: 2px;
    color: ${({$hovered:e})=>e?G.yellow:"transparent"};
    stroke: ${({$hovered:e})=>e?G.yellow:G.border};
  }
  &:hover svg {
    stroke: ${G.placeholder};
  }
`,br=F.label`
  ${Pt}
  opacity: ${({$hovered:e})=>e?1:0};
  transition: opacity 250ms;

  & svg {
    transition: border-color 250ms, color 250ms;
    padding: 1px;
    border: 2px solid ${G.border};
    border-radius: 50%;
    color: ${({$hovered:e})=>e?G.border:"transparent"};
  }
  &:hover svg {
    border-color: ${G.placeholder};
    color: ${({$hovered:e})=>e?G.placeholder:"transparent"};
  }
`,de=we`
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: transparent;
  border-color: transparent;
  transition: opacity 250ms color 250ms;
  color: ${G.black};

  & svg {
    transition: color 250ms;
    color: ${G.border};
  }
  &:hover,
  &:hover svg {
    color: ${G.placeholder};
  }
`,yr=F.button`
  ${de}

  opacity: ${({$hovered:e})=>e?1:0};
`,wr=F.button`
  ${de}

  opacity: 0;
`,{colors:Oe,indents:Mt}=Q,Ot=we`
  padding-block: 4px;
  display: grid;
  align-items: start;
  grid-template-columns: 20fr 1fr 20fr;
`,$r=F.div`
  ${Ot}
`,Sr=F.form`
  ${Ot}

  max-height: 70vh;
  overflow-y: scroll;
  scrollbar-width: none;
  grid-template-columns: 12fr 1fr 12fr;
`,wt=F.textarea`
  height: 84px;
  outline: none;
  border: 1px solid ${Oe.accent};
  border-radius: ${Mt.xs};
  resize: none;
  overflow: clip;
  transition: height 150ms;
`,Tr=F.div`
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  &::after {
    content: '';
    height: calc(100% - 8px);
    width: 1px;
    border: 1px solid ${Oe.borderLight};
    transition: border-color 250ms;
  }

  &:hover::after {
    border-color: ${Oe.placeholder};
  }
`,Rr=F.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,Ar=F.button`
  ${de}
`;F.button`
  ${de}
`;const He=F.button`
  ${de}
`,Cr=F.button`
  ${de}
`,$t=F.button`
  height: 100%;
  text-align: left;
  display: flex;
  align-items: top;
  background-color: transparent;
  border-color: transparent;
  border-radius: ${Mt.xs};
  color: ${Oe.black};
  transition: background-color 250ms;
`,Dt=we`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
`,kr=F.iframe`
  ${Dt}

  height: 60px;
  border-radius: 30px;
`,Er=F.audio`
  ${Dt}
`,Ze=({el:e,setIsForm:n})=>{const t=le(),h=z.useRef(null),c=z.useRef(null),d=z.useRef(null),{user:o}=ue(),{activeCluster:a}=ie(),[u,C]=z.useState(""),{_id:A,element:b,caption:w}=e,{register:v,watch:m,setValue:R,handleSubmit:y,setFocus:p}=Pn({mode:"onBlur",defaultValues:{element:b,caption:w}});z.useEffect(()=>{R("caption",w)},[w,R]);const{ref:r,...l}=v("element"),{ref:f,...T}=v("caption"),x=[h.current,c.current,d.current],j=[m("caption"),m("element")];In(x,j),z.useEffect(()=>{p("element"),u&&b.trim().startsWith("der")?R("element",u+b.replace("der","").trim()+", "):u&&b.trim().startsWith("die")?R("element",u+b.replace("die","").trim()+", "):u&&b.trim().startsWith("das")?R("element",u+b.replace("das","").trim()+", "):u?R("element",u+b+", "):R("element",u+b)},[u,b,p,R]),z.useEffect(()=>{const N=async S=>{(S.code==="NumpadAdd"||S.ctrlKey&&S.key==="Escape")&&(S.preventDefault(),await I(o.engine),y(D)()),S.key==="Enter"&&(S.preventDefault(),y(D)()),S.key==="Escape"&&n(!1)};return addEventListener("keydown",N),()=>{removeEventListener("keydown",N)}},[]);const D=N=>{const S=o.lang;let _=N.caption.trim(),E=Ue(N.element,a.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();E=Me(E,","),_=Me(_,","),o.lang.includes("en")&&a.lang.includes("de")&&(E.includes("hat")||E.includes("ist"))&&E.split(`
`)[0].split(/,\s+/)[0].endsWith("n")&&(_=_.split(/,\s+/).map(M=>M.startsWith("to ")?M:`to ${M}`).join(", ")),t(A?je({_id:A,lang:S,element:E,caption:_}):Rt({...e,caption:_})).then(t(At())),n(!1)},V=()=>{u===""&&C("der "),u==="der "&&C("die "),u==="die "&&C("das "),u==="das "&&C("")},I=async N=>{const S=m("element"),_=Ue(S,a.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim(),E={from:a.lang,to:o.lang},P=await ye(_,E,N);R("caption",P)};return $.jsxs(Sr,{onSubmit:y(D),children:[$.jsx(wt,{...l,name:"element",ref:N=>{r(N),h.current=N}}),$.jsxs(Rr,{ref:d,children:[$.jsx(Cr,{type:"button",onClick:V,children:$.jsx(Mn,{size:"18px"})}),$.jsx(He,{type:"button",onClick:()=>I("google"),children:$.jsx(dn,{size:"16px"})}),$.jsx(He,{type:"button",onClick:()=>I("deepl"),children:$.jsx(gn,{size:"18px"})}),$.jsx(Ar,{children:$.jsx(mn,{size:"16px"})})]}),$.jsx(wt,{...T,name:"caption",ref:N=>{f(N),c.current=N}})]})};Ze.propTypes={el:B.object,setIsForm:B.func};const{button:_r}=Q.shadows,{l:Lr}=Q.indents,xr=()=>{const{user:e}=ue(),[n,t]=z.useState(!1),{activeCluster:h}=ie(),[c,d]=z.useState(""),[o,a]=z.useState(""),{transcript:u,listening:C,resetTranscript:A}=be.useSpeechRecognition(),{isMicrophoneAvailable:b}=be.useSpeechRecognition(),{browserSupportsSpeechRecognition:w}=be.useSpeechRecognition(),v=c.endsWith(", ")?u:u.replace(/^./,p=>p.toUpperCase()),m=`${c}${v}`,R=(p,r)=>p.trim().endsWith(r)?`${p.trim()} `:`${p.trim()}${r} `;if(z.useEffect(()=>{if(!C)return;const p=[".","?","!",","],r=l=>{if(p.includes(l.key)){l.preventDefault();const f=R(m,l.key);d(f),A()}if(l.key==="Backspace"){l.preventDefault();const f=m.substring(0,m.length-1);d(f),A()}if(l.code==="Space"){l.preventDefault();const f=m+" ";d(f),A()}};return addEventListener("keydown",r),()=>{removeEventListener("keydown",r)}},[m,C,c,A]),z.useEffect(()=>{const p=async r=>{if(r.metaKey&&r.key==="r")if(r.preventDefault(),!C)d(""),t(!0),xe.startListening({language:h.lang,continuous:!0});else{xe.stopListening();const l=R(m,".");c&&d(l);const f={from:h.lang,to:e.lang},T=await ye(m,f,e.engine);a(T),A()}};return addEventListener("keydown",p),()=>{removeEventListener("keydown",p)}},[h.lang,m,C,c,A,e.lang,e.engine]),!w||!b)return;const y=async p=>{if(p==null||p.currentTarget.blur(),!C)d(""),t(!0),xe.startListening({language:h.lang,continuous:!0});else{xe.stopListening();const r=R(m,".");c&&d(r);const l={from:h.lang,to:e.lang},f=await ye(m,l,e.engine);a(f),A()}};return $.jsxs($.Fragment,{children:[$.jsx(pe,{onClick:y,$s:"m",$round:!0,$bs:_r,children:C?$.jsx(bn,{size:18}):$.jsx(vn,{size:18})}),n&&$.jsx(yn,{$x:`left: ${Lr}`,$y:"top: 50%",$bd:"none",onClick:()=>t(!1),children:$.jsx(Ze,{el:{cluster:h._id,element:m,caption:o,favorite:!0,checked:m.split(/\s+/).length<20},setIsForm:()=>null})})]})},{m:jr,s:Pr}=Q.indents,zt=({className:e})=>{const{pathname:n}=wn(),{elementTrash:t}=fe(),{activeCluster:h}=ie(),c=t.length>0?" 1fr":"",d=h?" 1fr":"",o=c+d+" 1fr 1fr";if(n.includes("/element"))return $.jsxs(Ke,{className:e,$m:`${Pr} ${jr}`,$pos:"fixed",$side:"left",$high:"bottom",$gtc:o,children:[$.jsx(Zn,{}),$.jsx(xr,{}),d&&$.jsx(qn,{}),c&&$.jsx(Kn,{})]})};zt.propTypes={className:B.string};const{colors:We}=Q,Mr=F.div`
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  &:hover svg {
    stroke: ${We.yellow};
  }

  & svg {
    transition: stroke 250ms;
    stroke: ${We.hovered};
    /* stroke: ${({$colored:e})=>e&&We.yellow}; */
    @keyframes refresh-spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(-360deg);
      }
    }
    animation: refresh-spin infinite 12s linear;
  }
`,It=({onClick:e})=>$.jsx(Mr,{onClick:e,children:$.jsx($n,{size:"35px"})});It.propTypes={onClick:B.func};const{background:Fe}=Q.colors,{button:St}=Q.shadows,{m:Or,s:Dr}=Q.indents,Nt=({className:e,filtredElements:n,setLiColor:t})=>{const{user:h}=ue(),{activeCluster:c}=ie(),{activeElement:d}=fe(),[o,a]=z.useState(null);if(z.useEffect(()=>{const y=window.speechSynthesis.getVoices();Array.isArray(y)&&y.length>0&&a(y),"onvoiceschanged"in window.speechSynthesis&&(window.speechSynthesis.onvoiceschanged=()=>{const p=window.speechSynthesis.getVoices();a(p)})},[]),!Array.isArray(o)||o.length===0)return;const u=y=>{if(!y.length)return;let p="",r=0;const l=y.reduce((f,T)=>(f[T.lang]||(f[T.lang]=0),f[T.lang]+=1,f),{});for(const f in l)l[f]>r&&(r=l[f],p=f);return p},C=n.length?u(n):h.lang,A=(y,p)=>y.replaceAll(", `",`;${p} `).replaceAll(" `",`${p} `).replaceAll(",`",";"),b=({text:y,playList:p,divider:r})=>{let l="";for(let f=0;f<p.length;f+=1){let T=p[f][y];const x=`@±@${p[f].lang}${r}`;T.endsWith(".")||T.endsWith("!")||T.endsWith("?")||T.endsWith('"')?(l+=A(T,r).replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",y!=="caption"?`__${r}`:`__${x}`).replaceAll(".",y!=="caption"?`.${r}`:`.${x}`).replaceAll(",",y!=="caption"?`,${r}`:`,${x}`).replaceAll("!",y!=="caption"?`!${r}`:`!${x}`).replaceAll("?",y!=="caption"?`?${r}`:`?${x}`).replaceAll(":",y!=="caption"?`:${r}`:`:${x}`),c.lang.includes("de")&&(l=l.replaceAll(`0.${r}`,"0.").replaceAll(`1.${r}`,"1.").replaceAll(`2.${r}`,"2.").replaceAll(`3.${r}`,"3.").replaceAll(`4.${r}`,"4.").replaceAll(`5.${r}`,"5.").replaceAll(`6.${r}`,"6.").replaceAll(`7.${r}`,"7.").replaceAll(`8.${r}`,"8.").replaceAll(`9.${r}`,"9."))):p[f].element.startsWith("[")||(y==="caption"&&(T.includes(" [")&&(T=T.substring(0,T.indexOf(" ["))),T=`${T}@±@${p[f].lang}`),l+=T+r)}return l},w=o,v=y=>{y.currentTarget.blur(),t(Fe);const p="$*@",r=n.findIndex(T=>T.element===d.element),l=n.splice(r===-1?0:r),f=Pe({setLiColor:t,divider:p,voices:w,text:b({text:"element",playList:l,divider:p}),lang:c.lang,rate:c.rate});f&&re.error(f)},m=y=>{y.currentTarget.blur();const p="$*@";t(Fe);const r=n.findIndex(T=>T.element===d.element),l=n.splice(r===-1?0:r),f=Pe({setLiColor:t,divider:p,voices:w,text:b({text:"caption",playList:l,divider:p}),lang:C,rate:h.rate});f&&re.error(f)},R=y=>{y.currentTarget.blur(),t(Fe);let p="";const r="$*@",l=n.findIndex(x=>x.element===d.element),f=n.splice(l===-1?0:l);for(let x=0;x<f.length;x+=1){const{element:j,caption:D,lang:V}=f[x];if(!j.startsWith("[")){const I=A(j,""),N=D.includes(" [")?D.substring(0,D.indexOf(" [")):A(D,"");p+=I+`@±@${V}`+N+r}}const T=Sn({setLiColor:t,divider:r,voices:w,text:p,lang:c.lang,rate:h.rate});T&&re.error(T)};return $.jsxs(Ke,{className:e,$m:`${Dr} ${Or}`,$pos:"fixed",$side:"right",$high:"bottom",$gtc:"1fr 0.5fr 1fr",children:[$.jsx(pe,{onClick:v,$s:"m",$round:!0,$bs:St,children:(c==null?void 0:c.lang.at(0).toUpperCase())+(c==null?void 0:c.lang.substring(1))}),$.jsx(It,{onClick:R}),$.jsx(pe,{onClick:m,$s:"m",$round:!0,$bs:St,children:(C==null?void 0:C.at(0).toUpperCase())+(C==null?void 0:C.substring(1))})]})};Nt.propTypes={className:B.string,filtredElements:B.array,setLiColor:B.func};const Bt=({el:e,sortByDate:n,setSortByDate:t,setLiColor:h})=>{const c=le(),{user:d}=ue(),{activeCluster:o}=ie(),{element:a,caption:u}=e,C="$*@",A=(r,l)=>{let f="";return l?(r.trim().endsWith(".")||r.trim().endsWith("!")||r.trim().endsWith("?")||r.endsWith('"')?(f=r.trim().replaceAll(", `",`;${l} `).replaceAll(" `",`${l} `).replaceAll(",`",";").replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",`__${l}`).replaceAll(".",`.${l}`).replaceAll(",",`,${l}`).replaceAll("!",`!${l}`).replaceAll("?",`?${l}`).replaceAll(":",`:${l}`),o.lang.includes("de")&&(f=f.replaceAll(`0.${l}`,"0.").replaceAll(`1.${l}`,"1.").replaceAll(`2.${l}`,"2.").replaceAll(`3.${l}`,"3.").replaceAll(`4.${l}`,"4.").replaceAll(`5.${l}`,"5.").replaceAll(`6.${l}`,"6.").replaceAll(`7.${l}`,"7.").replaceAll(`8.${l}`,"8.").replaceAll(`9.${l}`,"9."))):f=r.trim()+l,f.includes("[")?f.substring(0,f.indexOf("["))+l:f):r},b=r=>{r.currentTarget.blur();const l=Pe({setLiColor:h,divider:C,voices:window.speechSynthesis.getVoices(),text:A(a,C),lang:o.lang,rate:o.rate});l&&re.error(l)},w=r=>{r.currentTarget.blur();const l=Pe({setLiColor:h,divider:C,voices:window.speechSynthesis.getVoices(),text:A(u,C),lang:e.lang,rate:d.rate});l&&re.error(l)},v=r=>{t(!n),n?re.success("Below is Recent"):re.success("Above is Recent"),r.stopPropagation()},m=r=>{const{_id:l}=o;c(Ct(e)),r.currentTarget.closest("li").id!=="active-element"&&c(Ve({_id:l,activeEl:e._id}))},R=u.endsWith("mp3"),y=!R&&u.startsWith("http"),p=!R&&!y;return $.jsxs($r,{onClick:m,children:[$.jsx($t,{onClick:b,children:a}),$.jsx(Tr,{onClick:v}),R&&$.jsx(Er,{controls:!0,src:mt(u)}),y&&$.jsx(kr,{src:mt(u)}),p&&$.jsx($t,{onClick:w,children:u})]})};Bt.propTypes={el:B.object,sortByDate:B.bool,setSortByDate:B.func,$active:B.bool,$hovered:B.bool,setLiColor:B.func};const Wt=({el:e,index:n,length:t,sortByDate:h,setSortByDate:c,translateAll:d,liColor:o,setLiColor:a})=>{const u=le(),{elementTrash:C,activeElement:A}=fe(),[b,w]=z.useState(!1),{_id:v,favorite:m,checked:R}=e,y=C.find(x=>x._id===v),p=()=>{u(je({_id:v,favorite:!m}))},r=()=>{u(je({_id:v,checked:!R}))},l=()=>u(kn(e)),f=()=>w(!b),T=v===(A==null?void 0:A._id);return $.jsxs(mr,{id:T?"active-element":null,licolor:o,children:[$.jsxs(Ge,{$h:"100%",$p:"0",$fd:"column",children:[$.jsxs(vr,{$hovered:m,children:[$.jsx("input",{type:"checkbox",name:"favorite",checked:m,onChange:p}),$.jsx(xn,{size:"20px"})]}),$.jsxs(br,{$hovered:R,children:[$.jsx("input",{type:"checkbox",name:"checked",checked:R,onChange:r}),$.jsx(Tn,{size:"15px"})]}),b&&t===n+1&&$.jsx(He,{onClick:d,children:$.jsx(Rn,{size:"16px"})})]}),b&&$.jsx(Ze,{el:e,setIsForm:w}),!b&&$.jsx(Bt,{el:e,sortByDate:h,setSortByDate:c,setLiColor:a}),$.jsxs(Ge,{$h:"100%",$p:"0",$fd:"column",children:[$.jsx(yr,{$hovered:y,onClick:l,children:$.jsx(An,{size:"16px"})}),$.jsx(wr,{onClick:f,children:$.jsx(Cn,{size:"15px"})})]})]})};Wt.propTypes={el:B.object,index:B.number,length:B.number,sortByDate:B.bool,setSortByDate:B.func,translateAll:B.func,liColor:B.string,setLiColor:B.func};const zr=F.ul`
  width: 100%;
  list-style: none;
`,{white:Ir}=Q.colors,Nr=()=>{const e=le(),{ref:n,inView:t,entry:h}=Gn({initialInView:!0,rootMargin:"0px 0px -30px 0px"}),{user:c}=ue(),{activeCluster:d}=ie(),{allElements:o,elementTrash:a,elementFilter:u,isLoading:C}=fe(),[A,b]=z.useState(Ir);let{elementSelect:w}=fe();w=w||[];const[v,m]=z.useState(!1);z.useEffect(()=>{d&&e(At({cluster:d._id})).unwrap().then(({result:f})=>{if(!d.activeEl)return;const T=f.elements.find(({_id:x})=>x===d.activeEl);e(Ct(T))}).then(()=>{const f=document.getElementById("active-element");f&&En(f)})},[]);const R=o.filter(f=>f.cluster===(d==null?void 0:d._id)).sort((f,T)=>f.createdAt.localeCompare(T.createdAt)),p=(()=>{const f=a.map(T=>T._id);return w.includes("trash")?R.filter(T=>f.includes(T._id)):R})().filter(({element:f,caption:T,favorite:x,checked:j})=>{const D=f.toLowerCase().replace("·","").includes(u)||f.toLowerCase().includes(u)||T.toLowerCase().includes(u),V=w.includes("wordlist")?D&&On(f):D,I=()=>w.some(S=>["favorite","unfavorite"].includes(S))?w.includes("favorite")?V&&x===!0:V&&x===!1:V;return(()=>w.some(S=>["checked","unchecked"].includes(S))?w.includes("checked")?I()&&j===!0:I()&&j===!1:I())()}).sort(v?(f,T)=>T.createdAt.localeCompare(f.createdAt):(f,T)=>f.createdAt.localeCompare(T.createdAt)),r=async()=>{const f=c.lang;let T=0;await p.forEach(async x=>{if(T>1)return;const{_id:j,element:D}=x;if(!D.startsWith("[")||f!==x.lang){const V={from:d.lang,to:f},I=await ye(D,V,c.engine);e(je({_id:j,lang:f,caption:I})),T=T+1}})},l=window.innerHeight<(h==null?void 0:h.target.getBoundingClientRect().y)+(h==null?void 0:h.target.getBoundingClientRect().height)*1.5;return $.jsxs($.Fragment,{children:[$.jsxs(zr,{children:[p.map((f,T,x)=>$.jsx(Wt,{el:f,index:T,length:x.length,sortByDate:v,setSortByDate:m,translateAll:r,liColor:A,setLiColor:b},f._id)),$.jsxs("div",{ref:n,children:[$.jsx(_t,{}),$.jsx(zt,{className:!t||!l?"shown":"hidden"}),$.jsx(Nt,{className:!t||!l?"shown":"hidden",filtredElements:p,setLiColor:b})]})]}),C&&$.jsx(_n,{})]})},{s:Tt,m:Br}=Q.indents,qr=()=>$.jsx(Ge,{$p:`0 ${Br} ${Tt} ${Tt}`,children:$.jsx(Nr,{})});export{qr as default};
