import{U as ze,r as I,t as Q,P as B,u as le,b as he,q as ie,j as y,T as He,V as Te,x as Fe,E as dt,H as gt,w as ue,S as cn,W as Rt,X as ln,Q as re,z as pe,Y as un,Z as pn,G as fn,i as hn,n as ye,s as F,_ as dn,$ as gn,a0 as mn,a1 as xe,a2 as At,a3 as vn,a4 as bn,M as yn,a5 as wn,a6 as $n,a7 as je,a8 as Sn,a9 as mt,aa as Ct,F as Ve,D as Tn,ab as Rn,C as An,A as Cn,ac as kn,N as En,ad as _n}from"./index-0e7252f7.js";import{r as kt,H as Ln,T as xn}from"./index-b2a403b2.js";import{w as Et}from"./writeClipboard-00a6cbf2.js";import{v as jn,u as Pn}from"./index.esm-4d904431.js";import{a as Mn}from"./index-2545ae01.js";const Ge=(e,n)=>{if(!n.includes("de"))return e;const t=e.trim().split(`
`);return t.length===1?e:["der","die","das"].includes(t[0].split(" ")[0])?`${t[0].trim()}, ${t[1].split("·")[1].replaceAll("⁰","").replaceAll("/"," / ").trim()}`:(e.includes("hat")||e.includes("ist"))&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e.includes("am")&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e},On=e=>/[a-z]/.test(e.charAt(0)),{VITE_DEEPL_API_KEY:Dn}={VITE_GOOGLE_CLIENT_ID:"689266183428-lh3lmpaqnd2qd6t93voa8s6ipt3836q1.apps.googleusercontent.com",VITE_DEEPL_API_KEY:"d15bf272-fb1f-4f29-bbc3-d3bbdd686c53:fx",VITE_GOOGLE_API_KEY:"AIzaSyDqQndBxYEuOG7F6iYDqQoiNF90tptRmBQ",VITE_PROD_BACK_URL:"https://studyorganizer.onrender.com",BASE_URL:"/studyorganizer/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},In={google:"",deepl:Dn},Ke=async(e,{from:n,to:t},h)=>{var i,a;ze.engine=h,ze.key=In[h];const c=e.replaceAll(" ·",",").replaceAll("·","");let u=await ze(`${c}`,{from:n,to:t});try{if(t.includes("en")&&c.toLowerCase().includes("uhr")&&(u=u.replaceAll("a.m. on","am on").replaceAll("p.m. on","pm on").replaceAll("a.m. to","am to").replaceAll("p.m. to","pm to").replaceAll("a.m.","am.").replaceAll("p.m.","pm.")),[".","!","?"].includes(c.at(c.length-1)))return u;const A=c.split(c.includes(", ")?", ":/\s+/),C=u.split(", "),d=t.includes("de")?C[0]:C[0].at(0).toLowerCase()+C[0].substring(1);return A.length===1?u.toLocaleLowerCase()+", ":["der","die","das"].includes(A[0].split(" ")[0])?u.replace("The ","").replace("the ","").split(", ")[0].toLocaleLowerCase()+", ":t.includes("en")&&((i=A[2])!=null&&i.startsWith("am"))?C[2].startsWith("the")?u:`${d}, ${C[1]}, the ${C[2]}`:(A[0].endsWith("n")&&["hat","ist"].includes((a=A[2])==null?void 0:a.split(" ")[0])&&n.includes("de")&&(u=t.includes("en")?"to "+d+", ":d+", "),u)}catch(l){return l.message}},Pe=(e,n)=>e.endsWith(n)?e.substring(0,e.length-1):e,zn=(e,n)=>{let t=84;e[0]&&(t=Number(e[0].style.height.replace("px",""))),I.useEffect(()=>{if(!e[0])return;let h=Math.max(...e.map(c=>c.scrollHeight));t!==h&&(h=h<=90?h:h+6,e.forEach(c=>{c.style.height=h+"px"}))},[t,e,n])},Re=[{value:"de",label:"German"},{value:"en",label:"English"},{value:"uk",label:"Ukrainian"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"it",label:"Italian"}],Ae=[{value:.3,label:"Rate: 0.3"},{value:.4,label:"Rate: 0.4"},{value:.5,label:"Rate: 0.5"},{value:.6,label:"Rate: 0.6"},{value:.8,label:"Rate: 0.8"},{value:1,label:"Rate: 1"},{value:1.25,label:"Rate: 1.25"},{value:1.5,label:"Rate: 1.5"}];var Ue=new Map,Ce=new WeakMap,vt=0,Nn=void 0;function Bn(e){return e?(Ce.has(e)||(vt+=1,Ce.set(e,vt.toString())),Ce.get(e)):"0"}function Wn(e){return Object.keys(e).sort().filter(n=>e[n]!==void 0).map(n=>`${n}_${n==="root"?Bn(e.root):e[n]}`).toString()}function Fn(e){const n=Wn(e);let t=Ue.get(n);if(!t){const h=new Map;let c;const u=new IntersectionObserver(i=>{i.forEach(a=>{var l;const A=a.isIntersecting&&c.some(C=>a.intersectionRatio>=C);e.trackVisibility&&typeof a.isVisible>"u"&&(a.isVisible=A),(l=h.get(a.target))==null||l.forEach(C=>{C(A,a)})})},e);c=u.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),t={id:n,observer:u,elements:h},Ue.set(n,t)}return t}function Vn(e,n,t={},h=Nn){if(typeof window.IntersectionObserver>"u"&&h!==void 0){const l=e.getBoundingClientRect();return n(h,{isIntersecting:h,target:e,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:l,intersectionRect:l,rootBounds:l}),()=>{}}const{id:c,observer:u,elements:i}=Fn(t),a=i.get(e)||[];return i.has(e)||i.set(e,a),a.push(n),u.observe(e),function(){a.splice(a.indexOf(n),1),a.length===0&&(i.delete(e),u.unobserve(e)),i.size===0&&(u.disconnect(),Ue.delete(c))}}function Gn({threshold:e,delay:n,trackVisibility:t,rootMargin:h,root:c,triggerOnce:u,skip:i,initialInView:a,fallbackInView:l,onChange:A}={}){var C;const[d,S]=I.useState(null),p=I.useRef(A),[w,R]=I.useState({inView:!!a,entry:void 0});p.current=A,I.useEffect(()=>{if(i||!d)return;let v;return v=Vn(d,(b,T)=>{R({inView:b,entry:T}),p.current&&p.current(b,T),T.isIntersecting&&u&&v&&(v(),v=void 0)},{root:c,rootMargin:h,threshold:e,trackVisibility:t,delay:n},l),()=>{v&&v()}},[Array.isArray(e)?e.toString():e,d,c,h,u,i,t,l,n]);const f=(C=w.entry)==null?void 0:C.target,g=I.useRef(void 0);!d&&f&&!u&&!i&&g.current!==f&&(g.current=f,R({inView:!!a,entry:void 0}));const o=[S,w.inView,w.entry];return o.ref=o[0],o.inView=o[1],o.entry=o[2],o}const{backgroundHoverd:ke,white:Ee,borderLight:_e}=Q.colors,_t=()=>{const e=le(),{user:n}=he(),{activeCluster:t}=ie(),h=({value:a})=>{e(Fe({_id:t._id,lang:a})).unwrap().then(l=>e(dt(l.result.cluster)))},c=({value:a})=>{e(Fe({_id:t._id,rate:a})).unwrap().then(l=>e(dt(l.result.cluster)))},u=({value:a})=>{const l=new FormData;l.append("lang",a),e(gt(l))},i=({value:a})=>{const l=new FormData;l.append("rate",a),e(gt(l))};return y.jsxs(He,{$m:"0",$cg:"8px",$ai:"center",$gtc:"2fr 2fr 2fr 2fr",children:[y.jsx(Te,{options:Re,defaultValue:Re.find(a=>a.value===(t==null?void 0:t.lang)),onChange:h,placeholder:"Language...",$ol:ke,$b:Ee,$bh:_e}),y.jsx(Te,{options:Ae,defaultValue:Ae.find(a=>a.value==(t==null?void 0:t.rate)),onChange:c,placeholder:"Rate...",$ol:ke,$b:Ee,$bh:_e}),y.jsx(Te,{options:Re,defaultValue:Re.find(a=>a.value===n.lang),onChange:u,placeholder:"Language...",$ol:ke,$b:Ee,$bh:_e}),y.jsx(Te,{options:Ae,defaultValue:Ae.find(a=>a.value==n.rate),onChange:i,placeholder:"Rate...",$ol:ke,$b:Ee,$bh:_e})]})};_t.propTypes={filtredElements:B.array,setLiColor:B.func};const{button:Un}=Q.shadows,qn=()=>{const e=le(),{user:n}=he(),{activeCluster:t}=ie();I.useEffect(()=>{const c=async u=>{u.key==="e"&&u.metaKey&&(u.preventDefault(),await h())};return addEventListener("keydown",c),()=>{removeEventListener("keydown",c)}},[]);const h=async c=>{const u=window.getSelection().toString();u&&await Et(u);const i=await kt();let a=Ge(i,t.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();a=Pe(a,",");const l={from:t.lang,to:n.lang};let A=await Ke(a,l,n.engine);A=Pe(A.trim(),",");const{_id:C}=t;try{const d={cluster:C,element:"[]",caption:a},S={cluster:C,element:a,caption:A,favorite:!0,checked:a.split(/\s+/).length<20},p=a.includes("https://")?d:S;e(Rt(p)).unwrap().then(()=>(c==null?void 0:c.target)&&ln()).finally(()=>{var w;return(w=c==null?void 0:c.target)==null?void 0:w.blur()})}catch(d){c==null||c.currentTarget.blur(),re.error(`Invalid element, ${d.message}`)}};return y.jsx(ue,{onClick:h,$s:"m",$round:!0,$bs:Un,children:y.jsx(cn,{size:18})})},{button:Hn}=Q.shadows,Kn=()=>{const e=le(),{elementTrash:n}=pe(),t=()=>{confirm("Are you sure you want to delete the selected Element(s)?")&&e(un(n.map(h=>h._id).join("&"))).unwrap().then(()=>e(pn()))};return y.jsx(ue,{onClick:t,$s:"m",$round:!0,$bs:Hn,children:y.jsx(Ln,{size:16})})};function Yn(e){return fn({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M250.73,210.63l-56-112a12,12,0,0,0-21.46,0l-20.52,41A84.2,84.2,0,0,1,114,126.22,107.48,107.48,0,0,0,139.33,68H160a12,12,0,0,0,0-24H108V32a12,12,0,0,0-24,0V44H32a12,12,0,0,0,0,24h83.13A83.69,83.69,0,0,1,96,110.35,84,84,0,0,1,83.6,91a12,12,0,1,0-21.81,10A107.55,107.55,0,0,0,78,126.24,83.54,83.54,0,0,1,32,140a12,12,0,0,0,0,24,107.47,107.47,0,0,0,64-21.07,108.4,108.4,0,0,0,45.39,19.44l-24.13,48.26a12,12,0,1,0,21.46,10.73L151.41,196h65.17l12.68,25.36a12,12,0,1,0,21.47-10.73ZM163.41,172,184,130.83,204.58,172Z"},child:[]}]})(e)}const{button:Qn}=Q.shadows,Zn=()=>{const{activeCluster:e}=ie();I.useEffect(()=>{const u=async i=>{i.metaKey&&i.key==="d"&&(i.preventDefault(),await c())};return addEventListener("keydown",u),()=>{removeEventListener("keydown",u)}},[]);let n=[];function t(u){u.forEach(i=>{const a=window.open(i,"_blank");a?n.push(a):re.error(`Failed to open tab: ${i}`)})}const h=()=>{n.forEach(u=>{u.close()}),n=[]},c=async()=>{const u=window.getSelection().toString();u&&await Et(u);const i=await kt();let a=[];e.lang.includes("de")&&a.push(`https://www.verbformen.com/conjugation/?w=${i}`),e.lang.includes("en")&&a.push(`https://dictionary.cambridge.org/dictionary/english-russian/${i}`),h(),t(a)};return y.jsx(ue,{onClick:c,$s:"m",$round:!0,$bs:Qn,children:y.jsx(Yn,{size:18})})};var Xn={exports:{}};(function(e){var n=function(t){var h=Object.prototype,c=h.hasOwnProperty,u=Object.defineProperty||function(s,r,m){s[r]=m.value},i,a=typeof Symbol=="function"?Symbol:{},l=a.iterator||"@@iterator",A=a.asyncIterator||"@@asyncIterator",C=a.toStringTag||"@@toStringTag";function d(s,r,m){return Object.defineProperty(s,r,{value:m,enumerable:!0,configurable:!0,writable:!0}),s[r]}try{d({},"")}catch{d=function(r,m,L){return r[m]=L}}function S(s,r,m,L){var k=r&&r.prototype instanceof v?r:v,O=Object.create(k.prototype),H=new W(L||[]);return u(O,"_invoke",{value:$(s,m,H)}),O}t.wrap=S;function p(s,r,m){try{return{type:"normal",arg:s.call(r,m)}}catch(L){return{type:"throw",arg:L}}}var w="suspendedStart",R="suspendedYield",f="executing",g="completed",o={};function v(){}function b(){}function T(){}var x={};d(x,l,function(){return this});var j=Object.getPrototypeOf,D=j&&j(j(M([])));D&&D!==h&&c.call(D,l)&&(x=D);var V=T.prototype=v.prototype=Object.create(x);b.prototype=T,u(V,"constructor",{value:T,configurable:!0}),u(T,"constructor",{value:b,configurable:!0}),b.displayName=d(T,C,"GeneratorFunction");function z(s){["next","throw","return"].forEach(function(r){d(s,r,function(m){return this._invoke(r,m)})})}t.isGeneratorFunction=function(s){var r=typeof s=="function"&&s.constructor;return r?r===b||(r.displayName||r.name)==="GeneratorFunction":!1},t.mark=function(s){return Object.setPrototypeOf?Object.setPrototypeOf(s,T):(s.__proto__=T,d(s,C,"GeneratorFunction")),s.prototype=Object.create(V),s},t.awrap=function(s){return{__await:s}};function N(s,r){function m(O,H,K,Z){var q=p(s[O],s,H);if(q.type==="throw")Z(q.arg);else{var ge=q.arg,ae=ge.value;return ae&&typeof ae=="object"&&c.call(ae,"__await")?r.resolve(ae.__await).then(function(ne){m("next",ne,K,Z)},function(ne){m("throw",ne,K,Z)}):r.resolve(ae).then(function(ne){ge.value=ne,K(ge)},function(ne){return m("throw",ne,K,Z)})}}var L;function k(O,H){function K(){return new r(function(Z,q){m(O,H,Z,q)})}return L=L?L.then(K,K):K()}u(this,"_invoke",{value:k})}z(N.prototype),d(N.prototype,A,function(){return this}),t.AsyncIterator=N,t.async=function(s,r,m,L,k){k===void 0&&(k=Promise);var O=new N(S(s,r,m,L),k);return t.isGeneratorFunction(r)?O:O.next().then(function(H){return H.done?H.value:O.next()})};function $(s,r,m){var L=w;return function(O,H){if(L===f)throw new Error("Generator is already running");if(L===g){if(O==="throw")throw H;return U()}for(m.method=O,m.arg=H;;){var K=m.delegate;if(K){var Z=_(K,m);if(Z){if(Z===o)continue;return Z}}if(m.method==="next")m.sent=m._sent=m.arg;else if(m.method==="throw"){if(L===w)throw L=g,m.arg;m.dispatchException(m.arg)}else m.method==="return"&&m.abrupt("return",m.arg);L=f;var q=p(s,r,m);if(q.type==="normal"){if(L=m.done?g:R,q.arg===o)continue;return{value:q.arg,done:m.done}}else q.type==="throw"&&(L=g,m.method="throw",m.arg=q.arg)}}}function _(s,r){var m=r.method,L=s.iterator[m];if(L===i)return r.delegate=null,m==="throw"&&s.iterator.return&&(r.method="return",r.arg=i,_(s,r),r.method==="throw")||m!=="return"&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+m+"' method")),o;var k=p(L,s.iterator,r.arg);if(k.type==="throw")return r.method="throw",r.arg=k.arg,r.delegate=null,o;var O=k.arg;if(!O)return r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,o;if(O.done)r[s.resultName]=O.value,r.next=s.nextLoc,r.method!=="return"&&(r.method="next",r.arg=i);else return O;return r.delegate=null,o}z(V),d(V,C,"Generator"),d(V,l,function(){return this}),d(V,"toString",function(){return"[object Generator]"});function E(s){var r={tryLoc:s[0]};1 in s&&(r.catchLoc=s[1]),2 in s&&(r.finallyLoc=s[2],r.afterLoc=s[3]),this.tryEntries.push(r)}function P(s){var r=s.completion||{};r.type="normal",delete r.arg,s.completion=r}function W(s){this.tryEntries=[{tryLoc:"root"}],s.forEach(E,this),this.reset(!0)}t.keys=function(s){var r=Object(s),m=[];for(var L in r)m.push(L);return m.reverse(),function k(){for(;m.length;){var O=m.pop();if(O in r)return k.value=O,k.done=!1,k}return k.done=!0,k}};function M(s){if(s!=null){var r=s[l];if(r)return r.call(s);if(typeof s.next=="function")return s;if(!isNaN(s.length)){var m=-1,L=function k(){for(;++m<s.length;)if(c.call(s,m))return k.value=s[m],k.done=!1,k;return k.value=i,k.done=!0,k};return L.next=L}}throw new TypeError(typeof s+" is not iterable")}t.values=M;function U(){return{value:i,done:!0}}return W.prototype={constructor:W,reset:function(s){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(P),!s)for(var r in this)r.charAt(0)==="t"&&c.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=i)},stop:function(){this.done=!0;var s=this.tryEntries[0],r=s.completion;if(r.type==="throw")throw r.arg;return this.rval},dispatchException:function(s){if(this.done)throw s;var r=this;function m(Z,q){return O.type="throw",O.arg=s,r.next=Z,q&&(r.method="next",r.arg=i),!!q}for(var L=this.tryEntries.length-1;L>=0;--L){var k=this.tryEntries[L],O=k.completion;if(k.tryLoc==="root")return m("end");if(k.tryLoc<=this.prev){var H=c.call(k,"catchLoc"),K=c.call(k,"finallyLoc");if(H&&K){if(this.prev<k.catchLoc)return m(k.catchLoc,!0);if(this.prev<k.finallyLoc)return m(k.finallyLoc)}else if(H){if(this.prev<k.catchLoc)return m(k.catchLoc,!0)}else if(K){if(this.prev<k.finallyLoc)return m(k.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(s,r){for(var m=this.tryEntries.length-1;m>=0;--m){var L=this.tryEntries[m];if(L.tryLoc<=this.prev&&c.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var k=L;break}}k&&(s==="break"||s==="continue")&&k.tryLoc<=r&&r<=k.finallyLoc&&(k=null);var O=k?k.completion:{};return O.type=s,O.arg=r,k?(this.method="next",this.next=k.finallyLoc,o):this.complete(O)},complete:function(s,r){if(s.type==="throw")throw s.arg;return s.type==="break"||s.type==="continue"?this.next=s.arg:s.type==="return"?(this.rval=this.arg=s.arg,this.method="return",this.next="end"):s.type==="normal"&&r&&(this.next=r),o},finish:function(s){for(var r=this.tryEntries.length-1;r>=0;--r){var m=this.tryEntries[r];if(m.finallyLoc===s)return this.complete(m.completion,m.afterLoc),P(m),o}},catch:function(s){for(var r=this.tryEntries.length-1;r>=0;--r){var m=this.tryEntries[r];if(m.tryLoc===s){var L=m.completion;if(L.type==="throw"){var k=L.arg;P(m)}return k}}throw new Error("illegal catch attempt")},delegateYield:function(s,r,m){return this.delegate={iterator:M(s),resultName:r,nextLoc:m},this.method==="next"&&(this.arg=i),o}},t}(e.exports);try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})(Xn);var be={},Lt={},X={};Object.defineProperty(X,"__esModule",{value:!0});X.browserSupportsPolyfills=X.compareTwoStringsUsingDiceCoefficient=X.commandToRegExp=X.concatTranscripts=X.debounce=void 0;var Jn=function(n,t,h){var c;return function(){var u=this,i=arguments,a=function(){c=null,h||n.apply(u,i)},l=h&&!c;clearTimeout(c),c=setTimeout(a,t),l&&n.apply(u,i)}};X.debounce=Jn;var er=function(){for(var n=arguments.length,t=new Array(n),h=0;h<n;h++)t[h]=arguments[h];return t.map(function(c){return c.trim()}).join(" ").trim()};X.concatTranscripts=er;var tr=/\s*\((.*?)\)\s*/g,nr=/(\(\?:[^)]+\))\?/g,rr=/(\(\?)?:\w+/g,ir=/\*/g,sr=/[-{}[\]+?.,\\^$|#]/g,ar=function(n){return n instanceof RegExp?new RegExp(n.source,"i"):(n=n.replace(sr,"\\$&").replace(tr,"(?:$1)?").replace(rr,function(t,h){return h?t:"([^\\s]+)"}).replace(ir,"(.*?)").replace(nr,"\\s*$1?\\s*"),new RegExp("^"+n+"$","i"))};X.commandToRegExp=ar;var or=function(n,t){if(n=n.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!n.length&&!t.length)return 1;if(!n.length||!t.length)return 0;if(n===t)return 1;if(n.length===1&&t.length===1||n.length<2||t.length<2)return 0;for(var h=new Map,c=0;c<n.length-1;c++){var u=n.substring(c,c+2),i=h.has(u)?h.get(u)+1:1;h.set(u,i)}for(var a=0,l=0;l<t.length-1;l++){var A=t.substring(l,l+2),C=h.has(A)?h.get(A):0;C>0&&(h.set(A,C-1),a++)}return 2*a/(n.length+t.length-2)};X.compareTwoStringsUsingDiceCoefficient=or;var cr=function(){return typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0)};X.browserSupportsPolyfills=cr;var fe={},ce={};Object.defineProperty(ce,"__esModule",{value:!0});ce.APPEND_TRANSCRIPT=ce.CLEAR_TRANSCRIPT=void 0;var lr="CLEAR_TRANSCRIPT";ce.CLEAR_TRANSCRIPT=lr;var ur="APPEND_TRANSCRIPT";ce.APPEND_TRANSCRIPT=ur;Object.defineProperty(fe,"__esModule",{value:!0});fe.appendTranscript=fe.clearTranscript=void 0;var xt=ce,pr=function(){return{type:xt.CLEAR_TRANSCRIPT}};fe.clearTranscript=pr;var fr=function(n,t){return{type:xt.APPEND_TRANSCRIPT,payload:{interimTranscript:n,finalTranscript:t}}};fe.appendTranscript=fr;var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.transcriptReducer=void 0;var bt=ce,hr=X,dr=function(n,t){switch(t.type){case bt.CLEAR_TRANSCRIPT:return{interimTranscript:"",finalTranscript:""};case bt.APPEND_TRANSCRIPT:return{interimTranscript:t.payload.interimTranscript,finalTranscript:(0,hr.concatTranscripts)(n.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};Oe.transcriptReducer=dr;var jt={},Ye={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){return/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"")};e.default=n})(Ye);var Qe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.isNative=void 0;var n=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),t=function(u){return u===n};e.isNative=t;var h=n;e.default=h})(Qe);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=c(Ye),t=X,h=Qe;function c(d){return d&&d.__esModule?d:{default:d}}function u(d,S,p,w,R,f,g){try{var o=d[f](g),v=o.value}catch(b){p(b);return}o.done?S(v):Promise.resolve(v).then(w,R)}function i(d){return function(){var S=this,p=arguments;return new Promise(function(w,R){var f=d.apply(S,p);function g(v){u(f,w,R,g,o,"next",v)}function o(v){u(f,w,R,g,o,"throw",v)}g(void 0)})}}function a(d,S){if(!(d instanceof S))throw new TypeError("Cannot call a class as a function")}function l(d,S){for(var p=0;p<S.length;p++){var w=S[p];w.enumerable=w.enumerable||!1,w.configurable=!0,"value"in w&&(w.writable=!0),Object.defineProperty(d,w.key,w)}}function A(d,S,p){return S&&l(d.prototype,S),p&&l(d,p),d}var C=function(){function d(S){a(this,d),this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=function(){},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(S),(0,n.default)()&&(this.updateFinalTranscript=(0,t.debounce)(this.updateFinalTranscript,250,!0))}return A(d,[{key:"setSpeechRecognition",value:function(p){var w=!!p&&((0,h.isNative)(p)||(0,t.browserSupportsPolyfills)());w&&(this.disableRecognition(),this.recognition=new p,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(w)}},{key:"subscribe",value:function(p,w){this.subscribers[p]=w}},{key:"unsubscribe",value:function(p){delete this.subscribers[p]}},{key:"emitListeningChange",value:function(p){var w=this;this.listening=p,Object.keys(this.subscribers).forEach(function(R){var f=w.subscribers[R].onListeningChange;f(p)})}},{key:"emitMicrophoneAvailabilityChange",value:function(p){var w=this;this.isMicrophoneAvailable=p,Object.keys(this.subscribers).forEach(function(R){var f=w.subscribers[R].onMicrophoneAvailabilityChange;f(p)})}},{key:"emitTranscriptChange",value:function(p,w){var R=this;Object.keys(this.subscribers).forEach(function(f){var g=R.subscribers[f].onTranscriptChange;g(p,w)})}},{key:"emitClearTranscript",value:function(){var p=this;Object.keys(this.subscribers).forEach(function(w){var R=p.subscribers[w].onClearTranscript;R()})}},{key:"emitBrowserSupportsSpeechRecognitionChange",value:function(p){var w=this;Object.keys(this.subscribers).forEach(function(R){var f=w.subscribers[R],g=f.onBrowserSupportsSpeechRecognitionChange,o=f.onBrowserSupportsContinuousListeningChange;g(p),o(p)})}},{key:"disconnect",value:function(p){if(this.recognition&&this.listening)switch(p){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}},{key:"disableRecognition",value:function(){this.recognition&&(this.recognition.onresult=function(){},this.recognition.onend=function(){},this.recognition.onerror=function(){},this.listening&&this.stopListening())}},{key:"onError",value:function(p){p&&p.error&&p.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}},{key:"onRecognitionDisconnect",value:function(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}},{key:"updateTranscript",value:function(p){var w=p.results,R=p.resultIndex,f=R===void 0?w.length-1:R;this.interimTranscript="",this.finalTranscript="";for(var g=f;g<w.length;++g)w[g].isFinal&&(!(0,n.default)()||w[g][0].confidence>0)?this.updateFinalTranscript(w[g][0].transcript):this.interimTranscript=(0,t.concatTranscripts)(this.interimTranscript,w[g][0].transcript);var o=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(o=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,o||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}},{key:"updateFinalTranscript",value:function(p){this.finalTranscript=(0,t.concatTranscripts)(this.finalTranscript,p)}},{key:"resetTranscript",value:function(){this.disconnect("RESET")}},{key:"startListening",value:function(){var S=i(regeneratorRuntime.mark(function w(){var R,f,g,o,v,b,T=arguments;return regeneratorRuntime.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(R=T.length>0&&T[0]!==void 0?T[0]:{},f=R.continuous,g=f===void 0?!1:f,o=R.language,this.recognition){j.next=3;break}return j.abrupt("return");case 3:if(v=g!==this.recognition.continuous,b=o&&o!==this.recognition.lang,!(v||b)){j.next=11;break}if(!this.listening){j.next=9;break}return j.next=9,this.stopListening();case 9:this.recognition.continuous=v?g:this.recognition.continuous,this.recognition.lang=b?o:this.recognition.lang;case 11:if(this.listening){j.next=22;break}return this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript()),j.prev=13,j.next=16,this.start();case 16:this.emitListeningChange(!0),j.next=22;break;case 19:j.prev=19,j.t0=j.catch(13),j.t0 instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1);case 22:case"end":return j.stop()}},w,this,[[13,19]])}));function p(){return S.apply(this,arguments)}return p}()},{key:"abortListening",value:function(){var S=i(regeneratorRuntime.mark(function w(){var R=this;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.disconnect("ABORT"),this.emitListeningChange(!1),g.next=4,new Promise(function(o){R.onStopListening=o});case 4:case"end":return g.stop()}},w,this)}));function p(){return S.apply(this,arguments)}return p}()},{key:"stopListening",value:function(){var S=i(regeneratorRuntime.mark(function w(){var R=this;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.disconnect("STOP"),this.emitListeningChange(!1),g.next=4,new Promise(function(o){R.onStopListening=o});case 4:case"end":return g.stop()}},w,this)}));function p(){return S.apply(this,arguments)}return p}()},{key:"getRecognition",value:function(){return this.recognition}},{key:"start",value:function(){var S=i(regeneratorRuntime.mark(function w(){return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(this.recognition&&!this.listening)){f.next=4;break}return f.next=3,this.recognition.start();case 3:this.listening=!0;case 4:case"end":return f.stop()}},w,this)}));function p(){return S.apply(this,arguments)}return p}()},{key:"stop",value:function(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}},{key:"abort",value:function(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}}]),d}();e.default=C})(jt);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.useSpeechRecognition=void 0;var n=I,t=X,h=fe,c=Oe,u=l(jt),i=l(Ye),a=l(Qe);function l($){return $&&$.__esModule?$:{default:$}}function A($,_,E,P,W,M,U){try{var s=$[M](U),r=s.value}catch(m){E(m);return}s.done?_(r):Promise.resolve(r).then(P,W)}function C($){return function(){var _=this,E=arguments;return new Promise(function(P,W){var M=$.apply(_,E);function U(r){A(M,P,W,U,s,"next",r)}function s(r){A(M,P,W,U,s,"throw",r)}U(void 0)})}}function d($){return w($)||p($)||o($)||S()}function S(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function p($){if(typeof Symbol<"u"&&Symbol.iterator in Object($))return Array.from($)}function w($){if(Array.isArray($))return v($)}function R($){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?R=function(E){return typeof E}:R=function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},R($)}function f($,_){return T($)||b($,_)||o($,_)||g()}function g(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o($,_){if($){if(typeof $=="string")return v($,_);var E=Object.prototype.toString.call($).slice(8,-1);if(E==="Object"&&$.constructor&&(E=$.constructor.name),E==="Map"||E==="Set")return Array.from($);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return v($,_)}}function v($,_){(_==null||_>$.length)&&(_=$.length);for(var E=0,P=new Array(_);E<_;E++)P[E]=$[E];return P}function b($,_){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object($)))){var E=[],P=!0,W=!1,M=void 0;try{for(var U=$[Symbol.iterator](),s;!(P=(s=U.next()).done)&&(E.push(s.value),!(_&&E.length===_));P=!0);}catch(r){W=!0,M=r}finally{try{!P&&U.return!=null&&U.return()}finally{if(W)throw M}}return E}}function T($){if(Array.isArray($))return $}var x=!!a.default,j=x&&!(0,i.default)(),D,V=function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},E=_.transcribing,P=E===void 0?!0:E,W=_.clearTranscriptOnListen,M=W===void 0?!0:W,U=_.commands,s=U===void 0?[]:U,r=(0,n.useState)(z.getRecognitionManager()),m=f(r,1),L=m[0],k=(0,n.useState)(x),O=f(k,2),H=O[0],K=O[1],Z=(0,n.useState)(j),q=f(Z,2),ge=q[0],ae=q[1],ne=(0,n.useReducer)(c.transcriptReducer,{interimTranscript:L.interimTranscript,finalTranscript:""}),Xe=f(ne,2),Je=Xe[0],et=Je.interimTranscript,tt=Je.finalTranscript,nt=Xe[1],Ft=(0,n.useState)(L.listening),rt=f(Ft,2),Vt=rt[0],Gt=rt[1],Ut=(0,n.useState)(L.isMicrophoneAvailable),it=f(Ut,2),qt=it[0],Ht=it[1],st=(0,n.useRef)(s);st.current=s;var at=function(){nt((0,h.clearTranscript)())},me=(0,n.useCallback)(function(){L.resetTranscript(),at()},[L]),Kt=function(Y,te,oe){var se=R(Y)==="object"?Y.toString():Y,ve=se.replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),we=(0,t.compareTwoStringsUsingDiceCoefficient)(ve,te);return we>=oe?{command:Y,commandWithoutSpecials:ve,howSimilar:we,isFuzzyMatch:!0}:null},Yt=function(Y,te){var oe=(0,t.commandToRegExp)(Y),se=oe.exec(te);return se?{command:Y,parameters:se.slice(1)}:null},ot=(0,n.useCallback)(function(ee,Y){st.current.forEach(function(te){var oe=te.command,se=te.callback,ve=te.matchInterim,we=ve===void 0?!1:ve,ut=te.isFuzzyMatch,pt=ut===void 0?!1:ut,ft=te.fuzzyMatchingThreshold,Zt=ft===void 0?.8:ft,ht=te.bestMatchOnly,Xt=ht===void 0?!1:ht,$e=!Y&&we?ee.trim():Y.trim(),Jt=Array.isArray(oe)?oe:[oe],Se=Jt.map(function(J){return pt?Kt(J,$e,Zt):Yt(J,$e)}).filter(function(J){return J});if(pt&&Xt&&Se.length>=2){Se.sort(function(J,Ie){return Ie.howSimilar-J.howSimilar});var De=Se[0],en=De.command,tn=De.commandWithoutSpecials,nn=De.howSimilar;se(tn,$e,nn,{command:en,resetTranscript:me})}else Se.forEach(function(J){if(J.isFuzzyMatch){var Ie=J.command,rn=J.commandWithoutSpecials,sn=J.howSimilar;se(rn,$e,sn,{command:Ie,resetTranscript:me})}else{var an=J.command,on=J.parameters;se.apply(void 0,d(on).concat([{command:an,resetTranscript:me}]))}})})},[me]),ct=(0,n.useCallback)(function(ee,Y){P&&nt((0,h.appendTranscript)(ee,Y)),ot(ee,Y)},[ot,P]),lt=(0,n.useCallback)(function(){M&&at()},[M]);(0,n.useEffect)(function(){var ee=z.counter;z.counter+=1;var Y={onListeningChange:Gt,onMicrophoneAvailabilityChange:Ht,onTranscriptChange:ct,onClearTranscript:lt,onBrowserSupportsSpeechRecognitionChange:K,onBrowserSupportsContinuousListeningChange:ae};return L.subscribe(ee,Y),function(){L.unsubscribe(ee)}},[P,M,L,ct,lt]);var Qt=(0,t.concatTranscripts)(tt,et);return{transcript:Qt,interimTranscript:et,finalTranscript:tt,listening:Vt,isMicrophoneAvailable:qt,resetTranscript:me,browserSupportsSpeechRecognition:H,browserSupportsContinuousListening:ge}};e.useSpeechRecognition=V;var z={counter:0,applyPolyfill:function(_){D?D.setSpeechRecognition(_):D=new u.default(_);var E=!!_&&(0,t.browserSupportsPolyfills)();x=E,j=E},removePolyfill:function(){D?D.setSpeechRecognition(a.default):D=new u.default(a.default),x=!!a.default,j=x&&!(0,i.default)()},getRecognitionManager:function(){return D||(D=new u.default(a.default)),D},getRecognition:function(){var _=z.getRecognitionManager();return _.getRecognition()},startListening:function(){var $=C(regeneratorRuntime.mark(function E(){var P,W,M,U,s=arguments;return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return P=s.length>0&&s[0]!==void 0?s[0]:{},W=P.continuous,M=P.language,U=z.getRecognitionManager(),m.next=4,U.startListening({continuous:W,language:M});case 4:case"end":return m.stop()}},E)}));function _(){return $.apply(this,arguments)}return _}(),stopListening:function(){var $=C(regeneratorRuntime.mark(function E(){var P;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return P=z.getRecognitionManager(),M.next=3,P.stopListening();case 3:case"end":return M.stop()}},E)}));function _(){return $.apply(this,arguments)}return _}(),abortListening:function(){var $=C(regeneratorRuntime.mark(function E(){var P;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return P=z.getRecognitionManager(),M.next=3,P.abortListening();case 3:case"end":return M.stop()}},E)}));function _(){return $.apply(this,arguments)}return _}(),browserSupportsSpeechRecognition:function(){return x},browserSupportsContinuousListening:function(){return j}},N=z;e.default=N})(Lt);(function(e){function n(i){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(l){return typeof l}:n=function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},n(i)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"useSpeechRecognition",{enumerable:!0,get:function(){return t.useSpeechRecognition}}),e.default=void 0;var t=c(Lt);function h(){if(typeof WeakMap!="function")return null;var i=new WeakMap;return h=function(){return i},i}function c(i){if(i&&i.__esModule)return i;if(i===null||n(i)!=="object"&&typeof i!="function")return{default:i};var a=h();if(a&&a.has(i))return a.get(i);var l={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in i)if(Object.prototype.hasOwnProperty.call(i,C)){var d=A?Object.getOwnPropertyDescriptor(i,C):null;d&&(d.get||d.set)?Object.defineProperty(l,C,d):l[C]=i[C]}return l.default=i,a&&a.set(i,l),l}var u=t.default;e.default=u})(be);const Le=hn(be),{colors:G,shadows:yt,indents:Ne}=Q,gr=ye`
  margin-bottom: 7px;
  padding-block: ${Ne.xs};

  display: grid;
  align-items: center;
  grid-template-columns: 1fr 25fr 1fr;

  border: 1px solid transparent;
  background-color: ${({licolor:e})=>e};
  border-radius: ${Ne.xs};
  font-size: 22px;

  &:last-of-type {
    margin-bottom: ${Ne.s};
  }
`,mr=F.li`
  ${gr}

  transition: box-shadow 250ms, border-color 250ms;

  &#active-element {
    border-color: ${G.border};
    background-color: ${G.background};
    box-shadow: ${yt.back};

    &:hover {
      border-color: ${G.accent};
    }
    & div button {
      transition: color 250ms;
      color: ${G.smokeBlack};
      &:hover {
        color: ${G.hovered};
      }
    }
  }

  & div button {
    transition: color 250ms;
    &:hover {
      color: ${G.hovered};
    }
  }

  &:hover {
    border-color: ${G.accent};
    box-shadow: ${yt.back};
  }

  &:hover label,
  &:hover button {
    opacity: 1;
  }
`,Pt=ye`
  min-height: 19px;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  & input {
    ${jn}
  }
`,vr=F.label`
  ${Pt}

  & svg {
    transition: stroke 250ms;
    stroke-width: 2px;
    color: ${({$hovered:e})=>e?G.yellow:"transparent"};
    stroke: ${({$hovered:e})=>e?G.yellow:G.border};
  }
  &:hover svg {
    stroke: ${G.placeholder};
  }
`,br=F.label`
  ${Pt}
  opacity: ${({$hovered:e})=>e?1:0};
  transition: opacity 250ms;

  & svg {
    transition: border-color 250ms, color 250ms;
    padding: 1px;
    border: 2px solid ${G.border};
    border-radius: 50%;
    color: ${({$hovered:e})=>e?G.border:"transparent"};
  }
  &:hover svg {
    border-color: ${G.placeholder};
    color: ${({$hovered:e})=>e?G.placeholder:"transparent"};
  }
`,de=ye`
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: transparent;
  border-color: transparent;
  transition: opacity 250ms color 250ms;
  color: ${G.black};

  & svg {
    transition: color 250ms;
    color: ${G.border};
  }
  &:hover,
  &:hover svg {
    color: ${G.placeholder};
  }
`,yr=F.button`
  ${de}

  opacity: ${({$hovered:e})=>e?1:0};
`,wr=F.button`
  ${de}

  opacity: 0;
`,{colors:Me,indents:Mt}=Q,Ot=ye`
  padding-block: 4px;
  display: grid;
  align-items: start;
  grid-template-columns: 20fr 1fr 20fr;
`,$r=F.div`
  ${Ot}
`,Sr=F.form`
  ${Ot}

  max-height: 70vh;
  overflow-y: scroll;
  scrollbar-width: none;
  grid-template-columns: 12fr 1fr 12fr;
`,wt=F.textarea`
  height: 84px;
  outline: none;
  border: 1px solid ${Me.accent};
  border-radius: ${Mt.xs};
  resize: none;
  overflow: clip;
  transition: height 150ms;
`,Tr=F.div`
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  &::after {
    content: '';
    height: calc(100% - 8px);
    width: 1px;
    border: 1px solid ${Me.borderLight};
    transition: border-color 250ms;
  }

  &:hover::after {
    border-color: ${Me.placeholder};
  }
`,Rr=F.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,Ar=F.button`
  ${de}
`;F.button`
  ${de}
`;const qe=F.button`
  ${de}
`,Cr=F.button`
  ${de}
`,$t=F.button`
  height: 100%;
  text-align: left;
  display: flex;
  align-items: top;
  background-color: transparent;
  border-color: transparent;
  border-radius: ${Mt.xs};
  color: ${Me.black};
  transition: background-color 250ms;
`,Dt=ye`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
`,kr=F.iframe`
  ${Dt}

  height: 60px;
  border-radius: 30px;
`,Er=F.audio`
  ${Dt}
`,Ze=({el:e,setIsForm:n})=>{const t=le(),h=I.useRef(null),c=I.useRef(null),u=I.useRef(null),{user:i}=he(),{activeCluster:a}=ie(),[l,A]=I.useState(""),{_id:C,element:d,caption:S}=e,{register:p,watch:w,setValue:R,handleSubmit:f,setFocus:g}=Pn({mode:"onBlur",defaultValues:{element:d,caption:S}}),{ref:o,...v}=p("element"),{ref:b,...T}=p("caption"),x=[h.current,c.current,u.current],j=[w("caption"),w("element")];zn(x,j),I.useEffect(()=>{g("element"),l&&d.trim().startsWith("der")?R("element",l+d.replace("der","").trim()+", "):l&&d.trim().startsWith("die")?R("element",l+d.replace("die","").trim()+", "):l&&d.trim().startsWith("das")?R("element",l+d.replace("das","").trim()+", "):l?R("element",l+d+", "):R("element",l+d)},[l,d,g,R]),I.useEffect(()=>{const N=async $=>{($.code==="NumpadAdd"||$.ctrlKey&&$.key==="Escape")&&($.preventDefault(),await z(i.engine),f(D)()),$.key==="Enter"&&($.preventDefault(),f(D)()),$.key==="Escape"&&n(!1)};return addEventListener("keydown",N),()=>{removeEventListener("keydown",N)}},[]);const D=N=>{const $=i.lang;let _=N.caption.trim(),E=Ge(N.element,a.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();E=Pe(E,","),_=Pe(_,","),i.lang.includes("en")&&a.lang.includes("de")&&(E.includes("hat")||E.includes("ist"))&&E.split(`
`)[0].split(/,\s+/)[0].endsWith("n")&&(_=_.split(/,\s+/).map(M=>M.startsWith("to ")?M:`to ${M}`).join(", ")),t(C?xe({_id:C,lang:$,element:E,caption:_}):Rt({...e,caption:_})).then(t(At())),n(!1)},V=()=>{l===""&&A("der "),l==="der "&&A("die "),l==="die "&&A("das "),l==="das "&&A("")},z=async N=>{const $=w("element"),_=Ge($,a.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim(),E={from:a.lang,to:i.lang},P=await Ke(_,E,N);R("caption",P)};return y.jsxs(Sr,{onSubmit:f(D),children:[y.jsx(wt,{...v,name:"element",ref:N=>{o(N),h.current=N}}),y.jsxs(Rr,{ref:u,children:[y.jsx(Cr,{type:"button",onClick:V,children:y.jsx(Mn,{size:"18px"})}),y.jsx(qe,{type:"button",onClick:()=>z("google"),children:y.jsx(dn,{size:"16px"})}),y.jsx(qe,{type:"button",onClick:()=>z("deepl"),children:y.jsx(gn,{size:"18px"})}),y.jsx(Ar,{children:y.jsx(mn,{size:"16px"})})]}),y.jsx(wt,{...T,name:"caption",ref:N=>{b(N),c.current=N}})]})};Ze.propTypes={el:B.object,setIsForm:B.func};const{button:_r}=Q.shadows,{l:Lr}=Q.indents,xr=()=>{const[e,n]=I.useState(!1),{activeCluster:t}=ie(),[h,c]=I.useState(""),{transcript:u,listening:i,resetTranscript:a}=be.useSpeechRecognition(),{isMicrophoneAvailable:l}=be.useSpeechRecognition(),{browserSupportsSpeechRecognition:A}=be.useSpeechRecognition(),C=h.endsWith(", ")?u:u.replace(/^./,p=>p.toUpperCase()),d=`${h}${C}`;if(I.useEffect(()=>{if(!i)return;const p=(f,g)=>f.trim().endsWith(g)?`${f.trim()} `:`${f.trim()}${g} `,w=[".","?","!",","],R=f=>{if(w.includes(f.key)){f.preventDefault();const g=p(d,f.key);c(g),a()}if(f.key==="Backspace"){f.preventDefault();const g=d.substring(0,d.length-1);c(g),a()}if(f.code==="Space"){f.preventDefault();const g=d+" ";c(g),a()}};return addEventListener("keydown",R),()=>{removeEventListener("keydown",R)}},[d,i,h,a]),I.useEffect(()=>{const p=w=>{w.metaKey&&w.key==="r"&&(w.preventDefault(),i?(Le.stopListening(),a()):(c(""),n(!0),Le.startListening({language:t.lang,continuous:!0})))};return addEventListener("keydown",p),()=>{removeEventListener("keydown",p)}},[t.lang,i,a]),!A||!l)return;const S=p=>{i?(Le.stopListening(),a()):(c(""),n(!0),Le.startListening({language:t.lang,continuous:!0})),p==null||p.currentTarget.blur()};return y.jsxs(y.Fragment,{children:[y.jsx(ue,{onClick:S,$s:"m",$round:!0,$bs:_r,children:i?y.jsx(bn,{size:18}):y.jsx(vn,{size:18})}),e&&y.jsx(yn,{$x:`left: ${Lr}`,$y:"top: 50%",$bd:"none",onClick:()=>n(!1),children:y.jsx(Ze,{el:{cluster:t._id,element:d,favorite:!0,checked:d.split(/\s+/).length<20},setIsForm:()=>null})})]})},{m:jr,s:Pr}=Q.indents,It=({className:e})=>{const{pathname:n}=wn(),{elementTrash:t}=pe(),{activeCluster:h}=ie(),c=t.length>0?" 1fr":"",u=h?" 1fr":"",i=c+u+" 1fr 1fr";if(n.includes("/element"))return y.jsxs(He,{className:e,$m:`${Pr} ${jr}`,$pos:"fixed",$side:"left",$high:"bottom",$gtc:i,children:[y.jsx(Zn,{}),y.jsx(xr,{}),u&&y.jsx(qn,{}),c&&y.jsx(Kn,{})]})};It.propTypes={className:B.string};const{colors:Be}=Q,Mr=F.div`
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  &:hover svg {
    stroke: ${Be.yellow};
  }

  & svg {
    transition: stroke 250ms;
    stroke: ${Be.hovered};
    /* stroke: ${({$colored:e})=>e&&Be.yellow}; */
    @keyframes refresh-spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(-360deg);
      }
    }
    animation: refresh-spin infinite 12s linear;
  }
`,zt=({onClick:e})=>y.jsx(Mr,{onClick:e,children:y.jsx($n,{size:"35px"})});zt.propTypes={onClick:B.func};const{background:We}=Q.colors,{button:St}=Q.shadows,{m:Or,s:Dr}=Q.indents,Nt=({className:e,filtredElements:n,setLiColor:t})=>{const{user:h}=he(),{activeCluster:c}=ie(),{activeElement:u}=pe(),[i,a]=I.useState(null);if(I.useEffect(()=>{const f=window.speechSynthesis.getVoices();Array.isArray(f)&&f.length>0&&a(f),"onvoiceschanged"in window.speechSynthesis&&(window.speechSynthesis.onvoiceschanged=()=>{const g=window.speechSynthesis.getVoices();a(g)})},[]),!Array.isArray(i)||i.length===0)return;const l=f=>{if(!f.length)return;let g="",o=0;const v=f.reduce((b,T)=>(b[T.lang]||(b[T.lang]=0),b[T.lang]+=1,b),{});for(const b in v)v[b]>o&&(o=v[b],g=b);return g},A=n.length?l(n):h.lang,C=(f,g)=>f.replaceAll(", `",`;${g} `).replaceAll(" `",`${g} `).replaceAll(",`",";"),d=({text:f,playList:g,divider:o})=>{let v="";for(let b=0;b<g.length;b+=1){let T=g[b][f];const x=`@±@${g[b].lang}${o}`;T.endsWith(".")||T.endsWith("!")||T.endsWith("?")||T.endsWith('"')?(v+=C(T,o).replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",f!=="caption"?`__${o}`:`__${x}`).replaceAll(".",f!=="caption"?`.${o}`:`.${x}`).replaceAll(",",f!=="caption"?`,${o}`:`,${x}`).replaceAll("!",f!=="caption"?`!${o}`:`!${x}`).replaceAll("?",f!=="caption"?`?${o}`:`?${x}`).replaceAll(":",f!=="caption"?`:${o}`:`:${x}`),c.lang.includes("de")&&(v=v.replaceAll(`0.${o}`,"0.").replaceAll(`1.${o}`,"1.").replaceAll(`2.${o}`,"2.").replaceAll(`3.${o}`,"3.").replaceAll(`4.${o}`,"4.").replaceAll(`5.${o}`,"5.").replaceAll(`6.${o}`,"6.").replaceAll(`7.${o}`,"7.").replaceAll(`8.${o}`,"8.").replaceAll(`9.${o}`,"9."))):g[b].element.startsWith("[")||(f==="caption"&&(T.includes(" [")&&(T=T.substring(0,T.indexOf(" ["))),T=`${T}@±@${g[b].lang}`),v+=T+o)}return v},S=i,p=f=>{t(We);const g="$*@",o=n.findIndex(T=>T.element===u.element),v=n.splice(o===-1?0:o),b=je({setLiColor:t,divider:g,voices:S,text:d({text:"element",playList:v,divider:g}),lang:c.lang,rate:c.rate});f.currentTarget.blur(),b&&re.error(b)},w=f=>{const g="$*@";t(We);const o=n.findIndex(T=>T.element===u.element),v=n.splice(o===-1?0:o),b=je({setLiColor:t,divider:g,voices:S,text:d({text:"caption",playList:v,divider:g}),lang:A,rate:h.rate});f.currentTarget.blur(),b&&re.error(b)},R=f=>{t(We);let g="";const o="$*@",v=n.findIndex(x=>x.element===u.element),b=n.splice(v===-1?0:v);for(let x=0;x<b.length;x+=1){const{element:j,caption:D,lang:V}=b[x];if(!j.startsWith("[")){const z=C(j,""),N=D.includes(" [")?D.substring(0,D.indexOf(" [")):C(D,"");g+=z+`@±@${V}`+N+o}}const T=Sn({setLiColor:t,divider:o,voices:S,text:g,lang:c.lang,rate:h.rate});f.currentTarget.blur(),T&&re.error(T)};return y.jsxs(He,{className:e,$m:`${Dr} ${Or}`,$pos:"fixed",$side:"right",$high:"bottom",$gtc:"1fr 0.5fr 1fr",children:[y.jsx(ue,{onClick:p,$s:"m",$round:!0,$bs:St,children:(c==null?void 0:c.lang.at(0).toUpperCase())+(c==null?void 0:c.lang.substring(1))}),y.jsx(zt,{onClick:R}),y.jsx(ue,{onClick:w,$s:"m",$round:!0,$bs:St,children:(A==null?void 0:A.at(0).toUpperCase())+(A==null?void 0:A.substring(1))})]})};Nt.propTypes={className:B.string,filtredElements:B.array,setLiColor:B.func};const Bt=({el:e,sortByDate:n,setSortByDate:t,setLiColor:h})=>{const c=le(),{user:u}=he(),{activeCluster:i}=ie(),{element:a,caption:l}=e,A="$*@",C=(o,v)=>{let b="";return v?(o.trim().endsWith(".")||o.trim().endsWith("!")||o.trim().endsWith("?")||o.endsWith('"')?(b=o.trim().replaceAll(", `",`;${v} `).replaceAll(" `",`${v} `).replaceAll(",`",";").replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",`__${v}`).replaceAll(".",`.${v}`).replaceAll(",",`,${v}`).replaceAll("!",`!${v}`).replaceAll("?",`?${v}`).replaceAll(":",`:${v}`),i.lang.includes("de")&&(b=b.replaceAll(`0.${v}`,"0.").replaceAll(`1.${v}`,"1.").replaceAll(`2.${v}`,"2.").replaceAll(`3.${v}`,"3.").replaceAll(`4.${v}`,"4.").replaceAll(`5.${v}`,"5.").replaceAll(`6.${v}`,"6.").replaceAll(`7.${v}`,"7.").replaceAll(`8.${v}`,"8.").replaceAll(`9.${v}`,"9."))):b=o.trim()+v,b.includes("[")?b.substring(0,b.indexOf("["))+v:b):o},d=o=>{const v=je({setLiColor:h,divider:A,voices:window.speechSynthesis.getVoices(),text:C(a,A),lang:i.lang,rate:i.rate});o.currentTarget.blur(),v&&re.error(v)},S=o=>{const v=je({setLiColor:h,divider:A,voices:window.speechSynthesis.getVoices(),text:C(l,A),lang:e.lang,rate:u.rate});o.currentTarget.blur(),v&&re.error(v)},p=o=>{t(!n),n?re.success("Below is Recent"):re.success("Above is Recent"),o.stopPropagation()},w=o=>{const{_id:v}=i;c(Ct(e)),o.currentTarget.closest("li").id!=="active-element"&&c(Fe({_id:v,activeEl:e._id}))},R=l.endsWith("mp3"),f=!R&&l.startsWith("http"),g=!R&&!f;return y.jsxs($r,{onClick:w,children:[y.jsx($t,{onClick:d,children:a}),y.jsx(Tr,{onClick:p}),R&&y.jsx(Er,{controls:!0,src:mt(l)}),f&&y.jsx(kr,{src:mt(l)}),g&&y.jsx($t,{onClick:S,children:l})]})};Bt.propTypes={el:B.object,sortByDate:B.bool,setSortByDate:B.func,$active:B.bool,$hovered:B.bool,setLiColor:B.func};const Wt=({el:e,index:n,length:t,sortByDate:h,setSortByDate:c,translateAll:u,liColor:i,setLiColor:a})=>{const l=le(),{elementTrash:A,activeElement:C}=pe(),[d,S]=I.useState(!1),{_id:p,favorite:w,checked:R}=e,f=A.find(x=>x._id===p),g=()=>{l(xe({_id:p,favorite:!w}))},o=()=>{l(xe({_id:p,checked:!R}))},v=()=>l(kn(e)),b=()=>S(!d),T=p===(C==null?void 0:C._id);return y.jsxs(mr,{id:T?"active-element":null,licolor:i,children:[y.jsxs(Ve,{$h:"100%",$p:"0",$fd:"column",children:[y.jsxs(vr,{$hovered:w,children:[y.jsx("input",{type:"checkbox",name:"favorite",checked:w,onChange:g}),y.jsx(xn,{size:"20px"})]}),y.jsxs(br,{$hovered:R,children:[y.jsx("input",{type:"checkbox",name:"checked",checked:R,onChange:o}),y.jsx(Tn,{size:"15px"})]}),d&&t===n+1&&y.jsx(qe,{onClick:u,children:y.jsx(Rn,{size:"16px"})})]}),d&&y.jsx(Ze,{el:e,setIsForm:S}),!d&&y.jsx(Bt,{el:e,sortByDate:h,setSortByDate:c,setLiColor:a}),y.jsxs(Ve,{$h:"100%",$p:"0",$fd:"column",children:[y.jsx(yr,{$hovered:f,onClick:v,children:y.jsx(An,{size:"16px"})}),y.jsx(wr,{onClick:b,children:y.jsx(Cn,{size:"15px"})})]})]})};Wt.propTypes={el:B.object,index:B.number,length:B.number,sortByDate:B.bool,setSortByDate:B.func,translateAll:B.func,liColor:B.string,setLiColor:B.func};const Ir=F.ul`
  width: 100%;
  list-style: none;
`,{white:zr}=Q.colors,Nr=()=>{const e=le(),{ref:n,inView:t,entry:h}=Gn({initialInView:!0,rootMargin:"0px 0px -30px 0px"}),{user:c}=he(),{activeCluster:u}=ie(),{allElements:i,elementTrash:a,elementFilter:l,isLoading:A}=pe(),[C,d]=I.useState(zr);let{elementSelect:S}=pe();S=S||[];const[p,w]=I.useState(!1);I.useEffect(()=>{u&&e(At({cluster:u._id})).unwrap().then(({result:b})=>{if(!u.activeEl)return;const T=b.elements.find(({_id:x})=>x===u.activeEl);e(Ct(T))}).then(()=>{const b=document.getElementById("active-element");b&&En(b)})},[]);const R=i.filter(b=>b.cluster===(u==null?void 0:u._id)).sort((b,T)=>b.createdAt.localeCompare(T.createdAt)),g=(()=>{const b=a.map(T=>T._id);return S.includes("trash")?R.filter(T=>b.includes(T._id)):R})().filter(({element:b,caption:T,favorite:x,checked:j})=>{const D=b.toLowerCase().replace("·","").includes(l)||b.toLowerCase().includes(l)||T.toLowerCase().includes(l),V=S.includes("wordlist")?D&&On(b):D,z=()=>S.some($=>["favorite","unfavorite"].includes($))?S.includes("favorite")?V&&x===!0:V&&x===!1:V;return(()=>S.some($=>["checked","unchecked"].includes($))?S.includes("checked")?z()&&j===!0:z()&&j===!1:z())()}).sort(p?(b,T)=>T.createdAt.localeCompare(b.createdAt):(b,T)=>b.createdAt.localeCompare(T.createdAt)),o=async()=>{const b=c.lang;let T=0;await g.forEach(async x=>{if(T>1)return;const{_id:j,element:D}=x;if(!D.startsWith("[")||b!==x.lang){const V={from:u.lang,to:b},z=await Ke(D,V,c.engine);e(xe({_id:j,lang:b,caption:z})),T=T+1}})},v=window.innerHeight<(h==null?void 0:h.target.getBoundingClientRect().y)+(h==null?void 0:h.target.getBoundingClientRect().height)*1.5;return y.jsxs(y.Fragment,{children:[y.jsxs(Ir,{children:[g.map((b,T,x)=>y.jsx(Wt,{el:b,index:T,length:x.length,sortByDate:p,setSortByDate:w,translateAll:o,liColor:C,setLiColor:d},b._id)),y.jsxs("div",{ref:n,children:[y.jsx(_t,{}),y.jsx(It,{className:!t||!v?"shown":"hidden"}),y.jsx(Nt,{className:!t||!v?"shown":"hidden",filtredElements:g,setLiColor:d})]})]}),A&&y.jsx(_n,{})]})},{s:Tt,m:Br}=Q.indents,qr=()=>y.jsx(Ve,{$p:`0 ${Br} ${Tt} ${Tt}`,children:y.jsx(Nr,{})});export{qr as default};
