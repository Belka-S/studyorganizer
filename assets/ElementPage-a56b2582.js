import{U as Ne,r as z,t as Y,P as N,u as le,b as ue,w as ie,j as b,T as He,V as Ae,y as Ge,G as dt,H as gt,x as pe,S as cn,W as Tt,X as Rt,Q as ne,A as fe,Y as ln,Z as un,_ as pn,k as fn,n as $e,s as W,$ as hn,a0 as dn,a1 as gn,a2 as je,a3 as At,a4 as mn,a5 as vn,M as bn,a6 as yn,a7 as wn,a8 as Pe,a9 as $n,aa as Sn,ab as Tn,ac as kt,ad as Rn,ae as An,F as Ve,E as kn,af as Cn,D as En,C as _n,ag as Ln,N as xn,ah as jn}from"./index-4cc8a9b8.js";import{r as Ct,H as Pn,T as Mn}from"./index-bfa91c82.js";import{w as Et}from"./writeClipboard-8c405699.js";import{v as On,u as Dn}from"./index.esm-8613f24d.js";import{a as zn}from"./index-0402dcd4.js";const Ke=(e,n)=>{if(!n.includes("de"))return e;const t=e.trim().split(`
`);return t.length===1?e:["der","die","das"].includes(t[0].split(" ")[0])?`${t[0].trim()}, ${t[1].split("·")[1].replaceAll("⁰","").replaceAll("/"," / ").trim()}`:(e.includes("hat")||e.includes("ist"))&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e.includes("am")&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e},In=(e,n)=>{let t=e;for(const i in n)t=t.replaceAll(i,n[i]);const f=i=>i.replace(/^./,o=>o.toUpperCase()),l=[...t.split(/\s+/)];for(let i=0;i<l.length;i+=1)[".","!","?"].includes(l[i].at(-1))&&l[i+1]&&l.splice(i+1,1,f(l[i+1]));return l.join(" ")},Nn=e=>/[a-z]/.test(e.charAt(0)),{VITE_DEEPL_API_KEY:Bn}={VITE_GOOGLE_CLIENT_ID:"689266183428-lh3lmpaqnd2qd6t93voa8s6ipt3836q1.apps.googleusercontent.com",VITE_DEEPL_API_KEY:"d15bf272-fb1f-4f29-bbc3-d3bbdd686c53:fx",VITE_GOOGLE_API_KEY:"AIzaSyDqQndBxYEuOG7F6iYDqQoiNF90tptRmBQ",VITE_PROD_BACK_URL:"https://studyorganizer.onrender.com",BASE_URL:"/studyorganizer/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},Wn={google:"",deepl:Bn},we=async(e,{from:n,to:t},f)=>{var p,i;if(!e||e.length===0)return"";const l=e.replaceAll(" ·",",").replaceAll("·","");Ne.engine=f,Ne.key=Wn[f];try{let o=await Ne(`${l}`,{from:n,to:t});if(t.includes("en")&&l.toLowerCase().includes("uhr")&&(o=o.replaceAll("a.m. on","am on").replaceAll("p.m. on","pm on").replaceAll("a.m. to","am to").replaceAll("p.m. to","pm to").replaceAll("a.m.","am.").replaceAll("p.m.","pm.")),[".","!","?"].includes(l.at(-1)))return o;const k=l.split(l.includes(", ")?", ":/\s+/),$=o.split(", "),S=t.includes("de")?$[0]:$[0].at(0).toLowerCase()+$[0].substring(1);return k.length===1?o.toLocaleLowerCase()+", ":["der","die","das"].includes(k[0].split(" ")[0])?o.replace("The ","").replace("the ","").split(", ")[0].toLocaleLowerCase()+", ":t.includes("en")&&((p=k[2])!=null&&p.startsWith("am"))?$[2].startsWith("the")?o:`${S}, ${$[1]}, the ${$[2]}`:(k[0].endsWith("n")&&["hat","ist"].includes((i=k[2])==null?void 0:i.split(" ")[0])&&n.includes("de")&&(o=t.includes("en")?"to "+S+", ":S+", "),o)}catch(o){return o.message}},Me=(e,n)=>e.endsWith(n)?e.substring(0,e.length-1):e,Fn=(e,n)=>{let t=84;e[0]&&(t=Number(e[0].style.height.replace("px",""))),z.useEffect(()=>{if(!e[0])return;let f=Math.max(...e.map(l=>l.scrollHeight));t!==f&&(f=f<=90?f:f+6,e.forEach(l=>{l.style.height=f+"px"}))},[t,e,n])},ke=[{value:"de",label:"German"},{value:"en",label:"English"},{value:"uk",label:"Ukrainian"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"it",label:"Italian"}],Ce=[{value:.3,label:"Rate: 0.3"},{value:.4,label:"Rate: 0.4"},{value:.5,label:"Rate: 0.5"},{value:.6,label:"Rate: 0.6"},{value:.8,label:"Rate: 0.8"},{value:1,label:"Rate: 1"},{value:1.25,label:"Rate: 1.25"},{value:1.5,label:"Rate: 1.5"}],Gn={"..":".",". .":".","?.":"?","? .":"?","!.":"!","! .":"!",",,":",",", ,":","},Vn={" Dot":"."," dot":"."," exclamation mark":"!"," question mark":"?"," comma":","," colon":":"," semi-colon":";","Yes ":"Yes, ","No ":"No, "},Kn={" Punkt":"."," Ausrufezeichen":"!"," Fragezeichen":"?"," Komma":","," Doppelpunkt":":"," Semikolon":";","Ja ":"Ja, ","Nein ":"Nein, "," weil":", weil"," aber":", aber"," als":", als"," ob":", ob"," damit":", damit"," bevor":", bevor"," obwohl":", obwohl"," dass":", dass"," dann":", dann"," deshalb":", deshalb"," desvegen":", desvegen"," trotzdem":", trotzdem"},Un={...Vn,...Kn,...Gn};var Ue=new Map,Ee=new WeakMap,mt=0,qn=void 0;function Hn(e){return e?(Ee.has(e)||(mt+=1,Ee.set(e,mt.toString())),Ee.get(e)):"0"}function Yn(e){return Object.keys(e).sort().filter(n=>e[n]!==void 0).map(n=>`${n}_${n==="root"?Hn(e.root):e[n]}`).toString()}function Qn(e){const n=Yn(e);let t=Ue.get(n);if(!t){const f=new Map;let l;const p=new IntersectionObserver(i=>{i.forEach(o=>{var y;const k=o.isIntersecting&&l.some($=>o.intersectionRatio>=$);e.trackVisibility&&typeof o.isVisible>"u"&&(o.isVisible=k),(y=f.get(o.target))==null||y.forEach($=>{$(k,o)})})},e);l=p.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),t={id:n,observer:p,elements:f},Ue.set(n,t)}return t}function Zn(e,n,t={},f=qn){if(typeof window.IntersectionObserver>"u"&&f!==void 0){const y=e.getBoundingClientRect();return n(f,{isIntersecting:f,target:e,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:y,intersectionRect:y,rootBounds:y}),()=>{}}const{id:l,observer:p,elements:i}=Qn(t),o=i.get(e)||[];return i.has(e)||i.set(e,o),o.push(n),p.observe(e),function(){o.splice(o.indexOf(n),1),o.length===0&&(i.delete(e),p.unobserve(e)),i.size===0&&(p.disconnect(),Ue.delete(l))}}function Jn({threshold:e,delay:n,trackVisibility:t,rootMargin:f,root:l,triggerOnce:p,skip:i,initialInView:o,fallbackInView:y,onChange:k}={}){var $;const[S,w]=z.useState(null),h=z.useRef(k),[T,R]=z.useState({inView:!!o,entry:void 0});h.current=k,z.useEffect(()=>{if(i||!S)return;let c;return c=Zn(S,(u,v)=>{R({inView:u,entry:v}),h.current&&h.current(u,v),v.isIntersecting&&p&&c&&(c(),c=void 0)},{root:l,rootMargin:f,threshold:e,trackVisibility:t,delay:n},y),()=>{c&&c()}},[Array.isArray(e)?e.toString():e,S,l,f,p,i,t,y,n]);const m=($=T.entry)==null?void 0:$.target,d=z.useRef(void 0);!S&&m&&!p&&!i&&d.current!==m&&(d.current=m,R({inView:!!o,entry:void 0}));const r=[w,T.inView,T.entry];return r.ref=r[0],r.inView=r[1],r.entry=r[2],r}const{backgroundHoverd:_e,white:Le,borderLight:xe}=Y.colors,_t=()=>{const e=le(),{user:n}=ue(),{activeCluster:t}=ie(),f=({value:o})=>{e(Ge({_id:t._id,lang:o})).unwrap().then(y=>e(dt(y.result.cluster)))},l=({value:o})=>{e(Ge({_id:t._id,rate:o})).unwrap().then(y=>e(dt(y.result.cluster)))},p=({value:o})=>{const y=new FormData;y.append("lang",o),e(gt(y))},i=({value:o})=>{const y=new FormData;y.append("rate",o),e(gt(y))};return b.jsxs(He,{$m:"0",$cg:"8px",$ai:"center",$gtc:"2fr 2fr 2fr 2fr",children:[b.jsx(Ae,{options:ke,defaultValue:ke.find(o=>o.value===(t==null?void 0:t.lang)),onChange:f,placeholder:"Language...",$ol:_e,$b:Le,$bh:xe}),b.jsx(Ae,{options:Ce,defaultValue:Ce.find(o=>o.value==(t==null?void 0:t.rate)),onChange:l,placeholder:"Rate...",$ol:_e,$b:Le,$bh:xe}),b.jsx(Ae,{options:ke,defaultValue:ke.find(o=>o.value===n.lang),onChange:p,placeholder:"Language...",$ol:_e,$b:Le,$bh:xe}),b.jsx(Ae,{options:Ce,defaultValue:Ce.find(o=>o.value==n.rate),onChange:i,placeholder:"Rate...",$ol:_e,$b:Le,$bh:xe})]})};_t.propTypes={filtredElements:N.array,setLiColor:N.func};const{button:Xn}=Y.shadows,er=()=>{const e=le(),{user:n}=ue(),{activeCluster:t}=ie();z.useEffect(()=>{const l=async p=>{p.key==="e"&&p.metaKey&&!p.altKey&&!p.shiftKey&&(p.preventDefault(),await f())};return addEventListener("keydown",l),()=>{removeEventListener("keydown",l)}},[]);const f=async l=>{const p=window.getSelection().toString();p&&await Et(p);const i=await Ct();let o=Ke(i,t.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();o=Me(o,",");const y={from:t.lang,to:n.lang};let k=await we(o,y,n.engine);k=Me(k.trim(),",");const{_id:$}=t;try{const S={cluster:$,element:"[]",caption:o},w={cluster:$,element:o,caption:k,favorite:!0,checked:o.split(/\s+/).length<20},h=o.includes("https://")?S:w;e(Tt(h)).unwrap().then(()=>(l==null?void 0:l.target)&&Rt()).finally(()=>{var T;return(T=l==null?void 0:l.target)==null?void 0:T.blur()})}catch(S){l==null||l.currentTarget.blur(),ne.error(`Invalid element, ${S.message}`)}};return b.jsx(pe,{onClick:f,$s:"m",$round:!0,$bs:Xn,children:b.jsx(cn,{size:18})})},{button:tr}=Y.shadows,nr=()=>{const e=le(),{elementTrash:n}=fe(),t=()=>{confirm("Are you sure you want to delete the selected Element(s)?")&&e(ln(n.map(f=>f._id).join("&"))).unwrap().then(()=>e(un()))};return b.jsx(pe,{onClick:t,$s:"m",$round:!0,$bs:tr,children:b.jsx(Pn,{size:16})})};function rr(e){return pn({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M250.73,210.63l-56-112a12,12,0,0,0-21.46,0l-20.52,41A84.2,84.2,0,0,1,114,126.22,107.48,107.48,0,0,0,139.33,68H160a12,12,0,0,0,0-24H108V32a12,12,0,0,0-24,0V44H32a12,12,0,0,0,0,24h83.13A83.69,83.69,0,0,1,96,110.35,84,84,0,0,1,83.6,91a12,12,0,1,0-21.81,10A107.55,107.55,0,0,0,78,126.24,83.54,83.54,0,0,1,32,140a12,12,0,0,0,0,24,107.47,107.47,0,0,0,64-21.07,108.4,108.4,0,0,0,45.39,19.44l-24.13,48.26a12,12,0,1,0,21.46,10.73L151.41,196h65.17l12.68,25.36a12,12,0,1,0,21.47-10.73ZM163.41,172,184,130.83,204.58,172Z"},child:[]}]})(e)}const{button:ir}=Y.shadows,sr=()=>{const{activeCluster:e}=ie();z.useEffect(()=>{const p=async i=>{i.metaKey&&i.key==="d"&&!i.altKey&&!i.shiftKey&&(i.preventDefault(),await l())};return addEventListener("keydown",p),()=>{removeEventListener("keydown",p)}},[]);let n=[];function t(p){p.forEach(i=>{const o=window.open(i,"_blank");o?n.push(o):ne.error(`Failed to open tab: ${i}`)})}const f=()=>{n.forEach(p=>{p.close()}),n=[]},l=async()=>{const p=window.getSelection().toString();p&&await Et(p);const i=await Ct();let o=[];e.lang.includes("de")&&o.push(`https://www.verbformen.com/conjugation/?w=${i}`),e.lang.includes("en")&&o.push(`https://dictionary.cambridge.org/dictionary/english-russian/${i}`),f(),t(o)};return b.jsx(pe,{onClick:l,$s:"m",$round:!0,$bs:ir,children:b.jsx(rr,{size:18})})};var ar={exports:{}};(function(e){var n=function(t){var f=Object.prototype,l=f.hasOwnProperty,p=Object.defineProperty||function(s,a,g){s[a]=g.value},i,o=typeof Symbol=="function"?Symbol:{},y=o.iterator||"@@iterator",k=o.asyncIterator||"@@asyncIterator",$=o.toStringTag||"@@toStringTag";function S(s,a,g){return Object.defineProperty(s,a,{value:g,enumerable:!0,configurable:!0,writable:!0}),s[a]}try{S({},"")}catch{S=function(a,g,L){return a[g]=L}}function w(s,a,g,L){var _=a&&a.prototype instanceof c?a:c,O=Object.create(_.prototype),U=new D(L||[]);return p(O,"_invoke",{value:A(s,g,U)}),O}t.wrap=w;function h(s,a,g){try{return{type:"normal",arg:s.call(a,g)}}catch(L){return{type:"throw",arg:L}}}var T="suspendedStart",R="suspendedYield",m="executing",d="completed",r={};function c(){}function u(){}function v(){}var x={};S(x,y,function(){return this});var P=Object.getPrototypeOf,I=P&&P(P(M([])));I&&I!==f&&l.call(I,y)&&(x=I);var F=v.prototype=c.prototype=Object.create(x);u.prototype=v,p(F,"constructor",{value:v,configurable:!0}),p(v,"constructor",{value:u,configurable:!0}),u.displayName=S(v,$,"GeneratorFunction");function B(s){["next","throw","return"].forEach(function(a){S(s,a,function(g){return this._invoke(a,g)})})}t.isGeneratorFunction=function(s){var a=typeof s=="function"&&s.constructor;return a?a===u||(a.displayName||a.name)==="GeneratorFunction":!1},t.mark=function(s){return Object.setPrototypeOf?Object.setPrototypeOf(s,v):(s.__proto__=v,S(s,$,"GeneratorFunction")),s.prototype=Object.create(F),s},t.awrap=function(s){return{__await:s}};function X(s,a){function g(O,U,q,Q){var K=h(s[O],s,U);if(K.type==="throw")Q(K.arg);else{var ge=K.arg,ae=ge.value;return ae&&typeof ae=="object"&&l.call(ae,"__await")?a.resolve(ae.__await).then(function(re){g("next",re,q,Q)},function(re){g("throw",re,q,Q)}):a.resolve(ae).then(function(re){ge.value=re,q(ge)},function(re){return g("throw",re,q,Q)})}}var L;function _(O,U){function q(){return new a(function(Q,K){g(O,U,Q,K)})}return L=L?L.then(q,q):q()}p(this,"_invoke",{value:_})}B(X.prototype),S(X.prototype,k,function(){return this}),t.AsyncIterator=X,t.async=function(s,a,g,L,_){_===void 0&&(_=Promise);var O=new X(w(s,a,g,L),_);return t.isGeneratorFunction(a)?O:O.next().then(function(U){return U.done?U.value:O.next()})};function A(s,a,g){var L=T;return function(O,U){if(L===m)throw new Error("Generator is already running");if(L===d){if(O==="throw")throw U;return G()}for(g.method=O,g.arg=U;;){var q=g.delegate;if(q){var Q=C(q,g);if(Q){if(Q===r)continue;return Q}}if(g.method==="next")g.sent=g._sent=g.arg;else if(g.method==="throw"){if(L===T)throw L=d,g.arg;g.dispatchException(g.arg)}else g.method==="return"&&g.abrupt("return",g.arg);L=m;var K=h(s,a,g);if(K.type==="normal"){if(L=g.done?d:R,K.arg===r)continue;return{value:K.arg,done:g.done}}else K.type==="throw"&&(L=d,g.method="throw",g.arg=K.arg)}}}function C(s,a){var g=a.method,L=s.iterator[g];if(L===i)return a.delegate=null,g==="throw"&&s.iterator.return&&(a.method="return",a.arg=i,C(s,a),a.method==="throw")||g!=="return"&&(a.method="throw",a.arg=new TypeError("The iterator does not provide a '"+g+"' method")),r;var _=h(L,s.iterator,a.arg);if(_.type==="throw")return a.method="throw",a.arg=_.arg,a.delegate=null,r;var O=_.arg;if(!O)return a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,r;if(O.done)a[s.resultName]=O.value,a.next=s.nextLoc,a.method!=="return"&&(a.method="next",a.arg=i);else return O;return a.delegate=null,r}B(F),S(F,$,"Generator"),S(F,y,function(){return this}),S(F,"toString",function(){return"[object Generator]"});function E(s){var a={tryLoc:s[0]};1 in s&&(a.catchLoc=s[1]),2 in s&&(a.finallyLoc=s[2],a.afterLoc=s[3]),this.tryEntries.push(a)}function j(s){var a=s.completion||{};a.type="normal",delete a.arg,s.completion=a}function D(s){this.tryEntries=[{tryLoc:"root"}],s.forEach(E,this),this.reset(!0)}t.keys=function(s){var a=Object(s),g=[];for(var L in a)g.push(L);return g.reverse(),function _(){for(;g.length;){var O=g.pop();if(O in a)return _.value=O,_.done=!1,_}return _.done=!0,_}};function M(s){if(s!=null){var a=s[y];if(a)return a.call(s);if(typeof s.next=="function")return s;if(!isNaN(s.length)){var g=-1,L=function _(){for(;++g<s.length;)if(l.call(s,g))return _.value=s[g],_.done=!1,_;return _.value=i,_.done=!0,_};return L.next=L}}throw new TypeError(typeof s+" is not iterable")}t.values=M;function G(){return{value:i,done:!0}}return D.prototype={constructor:D,reset:function(s){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(j),!s)for(var a in this)a.charAt(0)==="t"&&l.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=i)},stop:function(){this.done=!0;var s=this.tryEntries[0],a=s.completion;if(a.type==="throw")throw a.arg;return this.rval},dispatchException:function(s){if(this.done)throw s;var a=this;function g(Q,K){return O.type="throw",O.arg=s,a.next=Q,K&&(a.method="next",a.arg=i),!!K}for(var L=this.tryEntries.length-1;L>=0;--L){var _=this.tryEntries[L],O=_.completion;if(_.tryLoc==="root")return g("end");if(_.tryLoc<=this.prev){var U=l.call(_,"catchLoc"),q=l.call(_,"finallyLoc");if(U&&q){if(this.prev<_.catchLoc)return g(_.catchLoc,!0);if(this.prev<_.finallyLoc)return g(_.finallyLoc)}else if(U){if(this.prev<_.catchLoc)return g(_.catchLoc,!0)}else if(q){if(this.prev<_.finallyLoc)return g(_.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(s,a){for(var g=this.tryEntries.length-1;g>=0;--g){var L=this.tryEntries[g];if(L.tryLoc<=this.prev&&l.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var _=L;break}}_&&(s==="break"||s==="continue")&&_.tryLoc<=a&&a<=_.finallyLoc&&(_=null);var O=_?_.completion:{};return O.type=s,O.arg=a,_?(this.method="next",this.next=_.finallyLoc,r):this.complete(O)},complete:function(s,a){if(s.type==="throw")throw s.arg;return s.type==="break"||s.type==="continue"?this.next=s.arg:s.type==="return"?(this.rval=this.arg=s.arg,this.method="return",this.next="end"):s.type==="normal"&&a&&(this.next=a),r},finish:function(s){for(var a=this.tryEntries.length-1;a>=0;--a){var g=this.tryEntries[a];if(g.finallyLoc===s)return this.complete(g.completion,g.afterLoc),j(g),r}},catch:function(s){for(var a=this.tryEntries.length-1;a>=0;--a){var g=this.tryEntries[a];if(g.tryLoc===s){var L=g.completion;if(L.type==="throw"){var _=L.arg;j(g)}return _}}throw new Error("illegal catch attempt")},delegateYield:function(s,a,g){return this.delegate={iterator:M(s),resultName:a,nextLoc:g},this.method==="next"&&(this.arg=i),r}},t}(e.exports);try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})(ar);var ye={},Lt={},Z={};Object.defineProperty(Z,"__esModule",{value:!0});Z.browserSupportsPolyfills=Z.compareTwoStringsUsingDiceCoefficient=Z.commandToRegExp=Z.concatTranscripts=Z.debounce=void 0;var or=function(n,t,f){var l;return function(){var p=this,i=arguments,o=function(){l=null,f||n.apply(p,i)},y=f&&!l;clearTimeout(l),l=setTimeout(o,t),y&&n.apply(p,i)}};Z.debounce=or;var cr=function(){for(var n=arguments.length,t=new Array(n),f=0;f<n;f++)t[f]=arguments[f];return t.map(function(l){return l.trim()}).join(" ").trim()};Z.concatTranscripts=cr;var lr=/\s*\((.*?)\)\s*/g,ur=/(\(\?:[^)]+\))\?/g,pr=/(\(\?)?:\w+/g,fr=/\*/g,hr=/[-{}[\]+?.,\\^$|#]/g,dr=function(n){return n instanceof RegExp?new RegExp(n.source,"i"):(n=n.replace(hr,"\\$&").replace(lr,"(?:$1)?").replace(pr,function(t,f){return f?t:"([^\\s]+)"}).replace(fr,"(.*?)").replace(ur,"\\s*$1?\\s*"),new RegExp("^"+n+"$","i"))};Z.commandToRegExp=dr;var gr=function(n,t){if(n=n.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!n.length&&!t.length)return 1;if(!n.length||!t.length)return 0;if(n===t)return 1;if(n.length===1&&t.length===1||n.length<2||t.length<2)return 0;for(var f=new Map,l=0;l<n.length-1;l++){var p=n.substring(l,l+2),i=f.has(p)?f.get(p)+1:1;f.set(p,i)}for(var o=0,y=0;y<t.length-1;y++){var k=t.substring(y,y+2),$=f.has(k)?f.get(k):0;$>0&&(f.set(k,$-1),o++)}return 2*o/(n.length+t.length-2)};Z.compareTwoStringsUsingDiceCoefficient=gr;var mr=function(){return typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0)};Z.browserSupportsPolyfills=mr;var he={},ce={};Object.defineProperty(ce,"__esModule",{value:!0});ce.APPEND_TRANSCRIPT=ce.CLEAR_TRANSCRIPT=void 0;var vr="CLEAR_TRANSCRIPT";ce.CLEAR_TRANSCRIPT=vr;var br="APPEND_TRANSCRIPT";ce.APPEND_TRANSCRIPT=br;Object.defineProperty(he,"__esModule",{value:!0});he.appendTranscript=he.clearTranscript=void 0;var xt=ce,yr=function(){return{type:xt.CLEAR_TRANSCRIPT}};he.clearTranscript=yr;var wr=function(n,t){return{type:xt.APPEND_TRANSCRIPT,payload:{interimTranscript:n,finalTranscript:t}}};he.appendTranscript=wr;var De={};Object.defineProperty(De,"__esModule",{value:!0});De.transcriptReducer=void 0;var vt=ce,$r=Z,Sr=function(n,t){switch(t.type){case vt.CLEAR_TRANSCRIPT:return{interimTranscript:"",finalTranscript:""};case vt.APPEND_TRANSCRIPT:return{interimTranscript:t.payload.interimTranscript,finalTranscript:(0,$r.concatTranscripts)(n.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};De.transcriptReducer=Sr;var jt={},Ye={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){return/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"")};e.default=n})(Ye);var Qe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.isNative=void 0;var n=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),t=function(p){return p===n};e.isNative=t;var f=n;e.default=f})(Qe);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=l(Ye),t=Z,f=Qe;function l(S){return S&&S.__esModule?S:{default:S}}function p(S,w,h,T,R,m,d){try{var r=S[m](d),c=r.value}catch(u){h(u);return}r.done?w(c):Promise.resolve(c).then(T,R)}function i(S){return function(){var w=this,h=arguments;return new Promise(function(T,R){var m=S.apply(w,h);function d(c){p(m,T,R,d,r,"next",c)}function r(c){p(m,T,R,d,r,"throw",c)}d(void 0)})}}function o(S,w){if(!(S instanceof w))throw new TypeError("Cannot call a class as a function")}function y(S,w){for(var h=0;h<w.length;h++){var T=w[h];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(S,T.key,T)}}function k(S,w,h){return w&&y(S.prototype,w),h&&y(S,h),S}var $=function(){function S(w){o(this,S),this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=function(){},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(w),(0,n.default)()&&(this.updateFinalTranscript=(0,t.debounce)(this.updateFinalTranscript,250,!0))}return k(S,[{key:"setSpeechRecognition",value:function(h){var T=!!h&&((0,f.isNative)(h)||(0,t.browserSupportsPolyfills)());T&&(this.disableRecognition(),this.recognition=new h,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(T)}},{key:"subscribe",value:function(h,T){this.subscribers[h]=T}},{key:"unsubscribe",value:function(h){delete this.subscribers[h]}},{key:"emitListeningChange",value:function(h){var T=this;this.listening=h,Object.keys(this.subscribers).forEach(function(R){var m=T.subscribers[R].onListeningChange;m(h)})}},{key:"emitMicrophoneAvailabilityChange",value:function(h){var T=this;this.isMicrophoneAvailable=h,Object.keys(this.subscribers).forEach(function(R){var m=T.subscribers[R].onMicrophoneAvailabilityChange;m(h)})}},{key:"emitTranscriptChange",value:function(h,T){var R=this;Object.keys(this.subscribers).forEach(function(m){var d=R.subscribers[m].onTranscriptChange;d(h,T)})}},{key:"emitClearTranscript",value:function(){var h=this;Object.keys(this.subscribers).forEach(function(T){var R=h.subscribers[T].onClearTranscript;R()})}},{key:"emitBrowserSupportsSpeechRecognitionChange",value:function(h){var T=this;Object.keys(this.subscribers).forEach(function(R){var m=T.subscribers[R],d=m.onBrowserSupportsSpeechRecognitionChange,r=m.onBrowserSupportsContinuousListeningChange;d(h),r(h)})}},{key:"disconnect",value:function(h){if(this.recognition&&this.listening)switch(h){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}},{key:"disableRecognition",value:function(){this.recognition&&(this.recognition.onresult=function(){},this.recognition.onend=function(){},this.recognition.onerror=function(){},this.listening&&this.stopListening())}},{key:"onError",value:function(h){h&&h.error&&h.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}},{key:"onRecognitionDisconnect",value:function(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}},{key:"updateTranscript",value:function(h){var T=h.results,R=h.resultIndex,m=R===void 0?T.length-1:R;this.interimTranscript="",this.finalTranscript="";for(var d=m;d<T.length;++d)T[d].isFinal&&(!(0,n.default)()||T[d][0].confidence>0)?this.updateFinalTranscript(T[d][0].transcript):this.interimTranscript=(0,t.concatTranscripts)(this.interimTranscript,T[d][0].transcript);var r=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(r=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,r||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}},{key:"updateFinalTranscript",value:function(h){this.finalTranscript=(0,t.concatTranscripts)(this.finalTranscript,h)}},{key:"resetTranscript",value:function(){this.disconnect("RESET")}},{key:"startListening",value:function(){var w=i(regeneratorRuntime.mark(function T(){var R,m,d,r,c,u,v=arguments;return regeneratorRuntime.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(R=v.length>0&&v[0]!==void 0?v[0]:{},m=R.continuous,d=m===void 0?!1:m,r=R.language,this.recognition){P.next=3;break}return P.abrupt("return");case 3:if(c=d!==this.recognition.continuous,u=r&&r!==this.recognition.lang,!(c||u)){P.next=11;break}if(!this.listening){P.next=9;break}return P.next=9,this.stopListening();case 9:this.recognition.continuous=c?d:this.recognition.continuous,this.recognition.lang=u?r:this.recognition.lang;case 11:if(this.listening){P.next=22;break}return this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript()),P.prev=13,P.next=16,this.start();case 16:this.emitListeningChange(!0),P.next=22;break;case 19:P.prev=19,P.t0=P.catch(13),P.t0 instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1);case 22:case"end":return P.stop()}},T,this,[[13,19]])}));function h(){return w.apply(this,arguments)}return h}()},{key:"abortListening",value:function(){var w=i(regeneratorRuntime.mark(function T(){var R=this;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.disconnect("ABORT"),this.emitListeningChange(!1),d.next=4,new Promise(function(r){R.onStopListening=r});case 4:case"end":return d.stop()}},T,this)}));function h(){return w.apply(this,arguments)}return h}()},{key:"stopListening",value:function(){var w=i(regeneratorRuntime.mark(function T(){var R=this;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.disconnect("STOP"),this.emitListeningChange(!1),d.next=4,new Promise(function(r){R.onStopListening=r});case 4:case"end":return d.stop()}},T,this)}));function h(){return w.apply(this,arguments)}return h}()},{key:"getRecognition",value:function(){return this.recognition}},{key:"start",value:function(){var w=i(regeneratorRuntime.mark(function T(){return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(this.recognition&&!this.listening)){m.next=4;break}return m.next=3,this.recognition.start();case 3:this.listening=!0;case 4:case"end":return m.stop()}},T,this)}));function h(){return w.apply(this,arguments)}return h}()},{key:"stop",value:function(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}},{key:"abort",value:function(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}}]),S}();e.default=$})(jt);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.useSpeechRecognition=void 0;var n=z,t=Z,f=he,l=De,p=y(jt),i=y(Ye),o=y(Qe);function y(A){return A&&A.__esModule?A:{default:A}}function k(A,C,E,j,D,M,G){try{var s=A[M](G),a=s.value}catch(g){E(g);return}s.done?C(a):Promise.resolve(a).then(j,D)}function $(A){return function(){var C=this,E=arguments;return new Promise(function(j,D){var M=A.apply(C,E);function G(a){k(M,j,D,G,s,"next",a)}function s(a){k(M,j,D,G,s,"throw",a)}G(void 0)})}}function S(A){return T(A)||h(A)||r(A)||w()}function w(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h(A){if(typeof Symbol<"u"&&Symbol.iterator in Object(A))return Array.from(A)}function T(A){if(Array.isArray(A))return c(A)}function R(A){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?R=function(E){return typeof E}:R=function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},R(A)}function m(A,C){return v(A)||u(A,C)||r(A,C)||d()}function d(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r(A,C){if(A){if(typeof A=="string")return c(A,C);var E=Object.prototype.toString.call(A).slice(8,-1);if(E==="Object"&&A.constructor&&(E=A.constructor.name),E==="Map"||E==="Set")return Array.from(A);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return c(A,C)}}function c(A,C){(C==null||C>A.length)&&(C=A.length);for(var E=0,j=new Array(C);E<C;E++)j[E]=A[E];return j}function u(A,C){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(A)))){var E=[],j=!0,D=!1,M=void 0;try{for(var G=A[Symbol.iterator](),s;!(j=(s=G.next()).done)&&(E.push(s.value),!(C&&E.length===C));j=!0);}catch(a){D=!0,M=a}finally{try{!j&&G.return!=null&&G.return()}finally{if(D)throw M}}return E}}function v(A){if(Array.isArray(A))return A}var x=!!o.default,P=x&&!(0,i.default)(),I,F=function(){var C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},E=C.transcribing,j=E===void 0?!0:E,D=C.clearTranscriptOnListen,M=D===void 0?!0:D,G=C.commands,s=G===void 0?[]:G,a=(0,n.useState)(B.getRecognitionManager()),g=m(a,1),L=g[0],_=(0,n.useState)(x),O=m(_,2),U=O[0],q=O[1],Q=(0,n.useState)(P),K=m(Q,2),ge=K[0],ae=K[1],re=(0,n.useReducer)(l.transcriptReducer,{interimTranscript:L.interimTranscript,finalTranscript:""}),Je=m(re,2),Xe=Je[0],et=Xe.interimTranscript,tt=Xe.finalTranscript,nt=Je[1],Ft=(0,n.useState)(L.listening),rt=m(Ft,2),Gt=rt[0],Vt=rt[1],Kt=(0,n.useState)(L.isMicrophoneAvailable),it=m(Kt,2),Ut=it[0],qt=it[1],st=(0,n.useRef)(s);st.current=s;var at=function(){nt((0,f.clearTranscript)())},me=(0,n.useCallback)(function(){L.resetTranscript(),at()},[L]),Ht=function(H,te,oe){var se=R(H)==="object"?H.toString():H,ve=se.replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),Se=(0,t.compareTwoStringsUsingDiceCoefficient)(ve,te);return Se>=oe?{command:H,commandWithoutSpecials:ve,howSimilar:Se,isFuzzyMatch:!0}:null},Yt=function(H,te){var oe=(0,t.commandToRegExp)(H),se=oe.exec(te);return se?{command:H,parameters:se.slice(1)}:null},ot=(0,n.useCallback)(function(ee,H){st.current.forEach(function(te){var oe=te.command,se=te.callback,ve=te.matchInterim,Se=ve===void 0?!1:ve,ut=te.isFuzzyMatch,pt=ut===void 0?!1:ut,ft=te.fuzzyMatchingThreshold,Zt=ft===void 0?.8:ft,ht=te.bestMatchOnly,Jt=ht===void 0?!1:ht,Te=!H&&Se?ee.trim():H.trim(),Xt=Array.isArray(oe)?oe:[oe],Re=Xt.map(function(J){return pt?Ht(J,Te,Zt):Yt(J,Te)}).filter(function(J){return J});if(pt&&Jt&&Re.length>=2){Re.sort(function(J,Ie){return Ie.howSimilar-J.howSimilar});var ze=Re[0],en=ze.command,tn=ze.commandWithoutSpecials,nn=ze.howSimilar;se(tn,Te,nn,{command:en,resetTranscript:me})}else Re.forEach(function(J){if(J.isFuzzyMatch){var Ie=J.command,rn=J.commandWithoutSpecials,sn=J.howSimilar;se(rn,Te,sn,{command:Ie,resetTranscript:me})}else{var an=J.command,on=J.parameters;se.apply(void 0,S(on).concat([{command:an,resetTranscript:me}]))}})})},[me]),ct=(0,n.useCallback)(function(ee,H){j&&nt((0,f.appendTranscript)(ee,H)),ot(ee,H)},[ot,j]),lt=(0,n.useCallback)(function(){M&&at()},[M]);(0,n.useEffect)(function(){var ee=B.counter;B.counter+=1;var H={onListeningChange:Vt,onMicrophoneAvailabilityChange:qt,onTranscriptChange:ct,onClearTranscript:lt,onBrowserSupportsSpeechRecognitionChange:q,onBrowserSupportsContinuousListeningChange:ae};return L.subscribe(ee,H),function(){L.unsubscribe(ee)}},[j,M,L,ct,lt]);var Qt=(0,t.concatTranscripts)(tt,et);return{transcript:Qt,interimTranscript:et,finalTranscript:tt,listening:Gt,isMicrophoneAvailable:Ut,resetTranscript:me,browserSupportsSpeechRecognition:U,browserSupportsContinuousListening:ge}};e.useSpeechRecognition=F;var B={counter:0,applyPolyfill:function(C){I?I.setSpeechRecognition(C):I=new p.default(C);var E=!!C&&(0,t.browserSupportsPolyfills)();x=E,P=E},removePolyfill:function(){I?I.setSpeechRecognition(o.default):I=new p.default(o.default),x=!!o.default,P=x&&!(0,i.default)()},getRecognitionManager:function(){return I||(I=new p.default(o.default)),I},getRecognition:function(){var C=B.getRecognitionManager();return C.getRecognition()},startListening:function(){var A=$(regeneratorRuntime.mark(function E(){var j,D,M,G,s=arguments;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return j=s.length>0&&s[0]!==void 0?s[0]:{},D=j.continuous,M=j.language,G=B.getRecognitionManager(),g.next=4,G.startListening({continuous:D,language:M});case 4:case"end":return g.stop()}},E)}));function C(){return A.apply(this,arguments)}return C}(),stopListening:function(){var A=$(regeneratorRuntime.mark(function E(){var j;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return j=B.getRecognitionManager(),M.next=3,j.stopListening();case 3:case"end":return M.stop()}},E)}));function C(){return A.apply(this,arguments)}return C}(),abortListening:function(){var A=$(regeneratorRuntime.mark(function E(){var j;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return j=B.getRecognitionManager(),M.next=3,j.abortListening();case 3:case"end":return M.stop()}},E)}));function C(){return A.apply(this,arguments)}return C}(),browserSupportsSpeechRecognition:function(){return x},browserSupportsContinuousListening:function(){return P}},X=B;e.default=X})(Lt);(function(e){function n(i){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(y){return typeof y}:n=function(y){return y&&typeof Symbol=="function"&&y.constructor===Symbol&&y!==Symbol.prototype?"symbol":typeof y},n(i)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"useSpeechRecognition",{enumerable:!0,get:function(){return t.useSpeechRecognition}}),e.default=void 0;var t=l(Lt);function f(){if(typeof WeakMap!="function")return null;var i=new WeakMap;return f=function(){return i},i}function l(i){if(i&&i.__esModule)return i;if(i===null||n(i)!=="object"&&typeof i!="function")return{default:i};var o=f();if(o&&o.has(i))return o.get(i);var y={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in i)if(Object.prototype.hasOwnProperty.call(i,$)){var S=k?Object.getOwnPropertyDescriptor(i,$):null;S&&(S.get||S.set)?Object.defineProperty(y,$,S):y[$]=i[$]}return y.default=i,o&&o.set(i,y),y}var p=t.default;e.default=p})(ye);const be=fn(ye),{colors:V,shadows:bt,indents:Be}=Y,Tr=$e`
  margin-bottom: 7px;
  padding-block: ${Be.xs};

  display: grid;
  align-items: center;
  grid-template-columns: 1fr 25fr 1fr;

  border: 1px solid transparent;
  background-color: ${({licolor:e})=>e};
  border-radius: ${Be.xs};
  font-size: 22px;

  &:last-of-type {
    margin-bottom: ${Be.s};
  }
`,Rr=W.li`
  ${Tr}

  transition: box-shadow 250ms, border-color 250ms;

  &#active-element {
    border-color: ${V.border};
    background-color: ${V.background};
    box-shadow: ${bt.back};

    &:hover {
      border-color: ${V.accent};
    }
    & div button {
      transition: color 250ms;
      color: ${V.smokeBlack};
      &:hover {
        color: ${V.hovered};
      }
    }
  }

  & div button {
    transition: color 250ms;
    &:hover {
      color: ${V.hovered};
    }
  }

  &:hover {
    border-color: ${V.accent};
    box-shadow: ${bt.back};
  }

  &:hover label,
  &:hover button {
    opacity: 1;
  }
`,Pt=$e`
  min-height: 19px;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  & input {
    ${On}
  }
`,Ar=W.label`
  ${Pt}

  & svg {
    transition: stroke 250ms;
    stroke-width: 2px;
    color: ${({$hovered:e})=>e?V.yellow:"transparent"};
    stroke: ${({$hovered:e})=>e?V.yellow:V.border};
  }
  &:hover svg {
    stroke: ${V.placeholder};
  }
`,kr=W.label`
  ${Pt}
  opacity: ${({$hovered:e})=>e?1:0};
  transition: opacity 250ms;

  & svg {
    transition: border-color 250ms, color 250ms;
    padding: 1px;
    border: 2px solid ${V.border};
    border-radius: 50%;
    color: ${({$hovered:e})=>e?V.border:"transparent"};
  }
  &:hover svg {
    border-color: ${V.placeholder};
    color: ${({$hovered:e})=>e?V.placeholder:"transparent"};
  }
`,de=$e`
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: transparent;
  border-color: transparent;
  transition: opacity 250ms color 250ms;
  color: ${V.black};

  & svg {
    transition: color 250ms;
    color: ${V.border};
  }
  &:hover,
  &:hover svg {
    color: ${V.placeholder};
  }
`,Cr=W.button`
  ${de}

  opacity: ${({$hovered:e})=>e?1:0};
`,Er=W.button`
  ${de}

  opacity: 0;
`,{colors:Oe,indents:Mt}=Y,Ot=$e`
  padding-block: 4px;
  display: grid;
  align-items: start;
  grid-template-columns: 20fr 1fr 20fr;
`,_r=W.div`
  ${Ot}
`,Lr=W.form`
  ${Ot}

  max-height: 70vh;
  overflow-y: scroll;
  scrollbar-width: none;
  grid-template-columns: 12fr 1fr 12fr;
`,yt=W.textarea`
  height: 84px;
  outline: none;
  border: 1px solid ${Oe.accent};
  border-radius: ${Mt.xs};
  resize: none;
  overflow: clip;
  transition: height 150ms;
`,xr=W.div`
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  &::after {
    content: '';
    height: calc(100% - 8px);
    width: 1px;
    border: 1px solid ${Oe.borderLight};
    transition: border-color 250ms;
  }

  &:hover::after {
    border-color: ${Oe.placeholder};
  }
`,jr=W.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,Pr=W.button`
  ${de}
`;W.button`
  ${de}
`;const qe=W.button`
  ${de}
`,Mr=W.button`
  ${de}
`,wt=W.button`
  height: 100%;
  text-align: left;
  display: flex;
  align-items: top;
  background-color: transparent;
  border-color: transparent;
  border-radius: ${Mt.xs};
  color: ${Oe.black};
  transition: background-color 250ms;
`,Dt=$e`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  height: 60px;
  border-radius: 30px;
`,Or=W.iframe`
  ${Dt}
`,Dr=W.audio`
  ${Dt}
`,Ze=({el:e,setIsForm:n,setRecording:t,setTranslation:f})=>{const l=z.useRef(null),p=z.useRef(null),i=z.useRef(null),o=le(),{user:y}=ue(),{activeCluster:k}=ie(),[$,S]=z.useState(""),{_id:w,element:h,caption:T}=e,{register:R,watch:m,setValue:d,handleSubmit:r,setFocus:c}=Dn({mode:"onBlur",defaultValues:{element:h,caption:T}});z.useEffect(()=>{d("caption",T)},[T,d]);const{ref:u,...v}=R("element"),{ref:x,...P}=R("caption"),I=[l.current,p.current,i.current],F=[m("caption"),m("element")];Fn(I,F),z.useEffect(()=>{c("element"),$&&h.trim().startsWith("der")?d("element",$+h.replace("der","").trim()+", "):$&&h.trim().startsWith("die")?d("element",$+h.replace("die","").trim()+", "):$&&h.trim().startsWith("das")?d("element",$+h.replace("das","").trim()+", "):$?d("element",$+h+", "):d("element",$+h)},[$,h,c,d]),z.useEffect(()=>{const C=async E=>{E.code==="NumpadAdd"&&(E.preventDefault(),await A(y.engine),r(B)()),E.key==="Enter"&&(E.preventDefault(),r(B)()),E.key==="Escape"&&(E.preventDefault(),n(!1)),E.code==="AltRight"&&l.current.focus()};return addEventListener("keydown",C),()=>{removeEventListener("keydown",C)}},[]);const B=C=>{const E=y.lang;let j=C.caption.trim(),D=Ke(C.element,k.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();D=Me(D,","),j=Me(j,","),y.lang.includes("en")&&k.lang.includes("de")&&(D.includes("hat")||D.includes("ist"))&&D.split(`
`)[0].split(/,\s+/)[0].endsWith("n")&&(j=j.split(/,\s+/).map(s=>s.startsWith("to ")?s:`to ${s}`).join(", ")),o(w?je({_id:w,lang:E,element:D,caption:j}):Tt({...e,element:D,caption:j})).then(o(At())),w||(Rt(),t(""),f("")),n(!1)},X=()=>{$===""&&S("der "),$==="der "&&S("die "),$==="die "&&S("das "),$==="das "&&S("")},A=async C=>{const E=m("element"),j=Ke(E,k.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim(),D={from:k.lang,to:y.lang},M=await we(j,D,C);d("caption",M)};return b.jsxs(Lr,{onSubmit:r(B),children:[b.jsx(yt,{...v,name:"element",ref:C=>{u(C),l.current=C}}),b.jsxs(jr,{ref:i,children:[b.jsx(Mr,{type:"button",onClick:X,children:b.jsx(zn,{size:"18px"})}),b.jsx(qe,{type:"button",onClick:()=>A("google"),children:b.jsx(hn,{size:"16px"})}),b.jsx(qe,{type:"button",onClick:()=>A("deepl"),children:b.jsx(dn,{size:"18px"})}),b.jsx(Pr,{children:b.jsx(gn,{size:"16px"})})]}),b.jsx(yt,{...P,name:"caption",ref:C=>{x(C),p.current=C}})]})};Ze.propTypes={el:N.object,setIsForm:N.func,setRecording:N.func,setTranslation:N.func};const{button:zr}=Y.shadows,{m:Ir,xl:Nr}=Y.indents,Br=()=>{const{user:e}=ue(),[n,t]=z.useState(!1),{activeCluster:f}=ie(),[l,p]=z.useState(""),[i,o]=z.useState(""),{transcript:y,listening:k,resetTranscript:$}=ye.useSpeechRecognition(),{isMicrophoneAvailable:S}=ye.useSpeechRecognition(),{browserSupportsSpeechRecognition:w}=ye.useSpeechRecognition(),h=l.endsWith(", ")||l.replace(/[a-z]$/,"*#").endsWith("*#")?y.replace(/^./,r=>` ${r}`):y.replace(/^./,r=>r.toUpperCase()),T=`${l}${h}`,R=In(T,Un),m=(r,c)=>r.trim().endsWith(c)?`${r.trim()} `:`${r.trim()}${c} `;if(z.useEffect(()=>{if(!k||!n)return;const r=[".","?","!",","],c=u=>{if(r.includes(u.key)){u.preventDefault();const v=m(R,u.key);p(v),$()}if(u.key==="Backspace"){u.preventDefault();const v=R.length-1,x=R.substring(0,v);p(x),$()}if(u.key==="Space"){u.preventDefault();const v=R+" ";p(v),$()}};return addEventListener("keydown",c),()=>{removeEventListener("keydown",c)}},[n,k,R,$]),z.useEffect(()=>{const r=async c=>{if(c.ctrlKey&&c.key==="Escape"){c.preventDefault(),be.stopListening(),t(!1),p(""),o(""),$();return}if(k||c.metaKey&&c.key==="r"&&!c.altKey&&!c.shiftKey&&(c.preventDefault(),t(!0),be.startListening({language:f.lang,continuous:!0})),k&&c.metaKey&&c.key==="r"&&!c.altKey&&!c.shiftKey){c.preventDefault(),be.stopListening();const u=R.at(-1),v=!u||["!"].includes(u)?R:m(R,"."),x=await we(v,{from:f.lang,to:e.lang},e.engine);p(v),o(x),$()}};return addEventListener("keydown",r),()=>{removeEventListener("keydown",r)}},[f.lang,n,k,R,$,e.engine,e.lang]),!w||!S)return;const d=async r=>{if(r==null||r.currentTarget.blur(),!k)t(!0),be.startListening({language:f.lang,continuous:!0});else{be.stopListening();const c=R.at(-1),u=!c||["!"].includes(c)?R:m(R,"."),v={from:f.lang,to:e.lang},x=await we(u,v,e.engine);p(u),o(x),$()}};return b.jsxs(b.Fragment,{children:[b.jsx(pe,{onClick:d,$s:"m",$round:!0,$bs:zr,children:k?b.jsx(vn,{size:18}):b.jsx(mn,{size:18})}),n&&b.jsx(bn,{$x:`left: ${Ir}`,$y:`top: ${Nr}`,$bd:"none",children:b.jsx(Ze,{el:{cluster:f._id,element:R.trim(),caption:i.trim(),favorite:!0,checked:R.split(/\s+/).length<20},setIsForm:t,setRecording:p,setTranslation:o})})]})},{m:Wr,s:Fr}=Y.indents,zt=({className:e})=>{const{pathname:n}=yn(),{elementTrash:t}=fe(),{activeCluster:f}=ie(),l=t.length>0?" 1fr":"",p=f?" 1fr":"",i=l+p+" 1fr 1fr";if(n.includes("/element"))return b.jsxs(He,{className:e,$m:`${Fr} ${Wr}`,$pos:"fixed",$side:"left",$high:"bottom",$gtc:i,children:[b.jsx(sr,{}),b.jsx(Br,{}),p&&b.jsx(er,{}),l&&b.jsx(nr,{})]})};zt.propTypes={className:N.string};const{colors:We}=Y,Gr=W.div`
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  &:hover svg {
    stroke: ${We.yellow};
  }

  & svg {
    transition: stroke 250ms;
    stroke: ${We.hovered};
    /* stroke: ${({$colored:e})=>e&&We.yellow}; */
    @keyframes refresh-spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(-360deg);
      }
    }
    animation: refresh-spin infinite 12s linear;
  }
`,It=({onClick:e})=>b.jsx(Gr,{onClick:e,children:b.jsx(wn,{size:"35px"})});It.propTypes={onClick:N.func};const{background:Fe}=Y.colors,{button:$t}=Y.shadows,{m:Vr,s:Kr}=Y.indents,Nt=({className:e,filtredElements:n,setLiColor:t})=>{const{user:f}=ue(),{activeCluster:l}=ie(),{activeElement:p}=fe(),[i,o]=z.useState(null);if(z.useEffect(()=>{const m=window.speechSynthesis.getVoices();Array.isArray(m)&&m.length>0&&o(m),"onvoiceschanged"in window.speechSynthesis&&(window.speechSynthesis.onvoiceschanged=()=>{const d=window.speechSynthesis.getVoices();o(d)})},[]),!Array.isArray(i)||i.length===0)return;const y=m=>{if(!m.length)return;let d="",r=0;const c=m.reduce((u,v)=>(u[v.lang]||(u[v.lang]=0),u[v.lang]+=1,u),{});for(const u in c)c[u]>r&&(r=c[u],d=u);return d},k=n.length?y(n):f.lang,$=(m,d)=>m.replaceAll(", `",`;${d} `).replaceAll(" `",`${d} `).replaceAll(",`",";"),S=({text:m,playList:d,divider:r})=>{let c="";for(let u=0;u<d.length;u+=1){let v=d[u][m];const x=`@±@${d[u].lang}${r}`;v.endsWith(".")||v.endsWith("!")||v.endsWith("?")||v.endsWith('"')?(c+=$(v,r).replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",m!=="caption"?`__${r}`:`__${x}`).replaceAll(".",m!=="caption"?`.${r}`:`.${x}`).replaceAll(",",m!=="caption"?`,${r}`:`,${x}`).replaceAll("!",m!=="caption"?`!${r}`:`!${x}`).replaceAll("?",m!=="caption"?`?${r}`:`?${x}`).replaceAll(":",m!=="caption"?`:${r}`:`:${x}`),l.lang.includes("de")&&(c=c.replaceAll(`0.${r}`,"0.").replaceAll(`1.${r}`,"1.").replaceAll(`2.${r}`,"2.").replaceAll(`3.${r}`,"3.").replaceAll(`4.${r}`,"4.").replaceAll(`5.${r}`,"5.").replaceAll(`6.${r}`,"6.").replaceAll(`7.${r}`,"7.").replaceAll(`8.${r}`,"8.").replaceAll(`9.${r}`,"9."))):d[u].element.startsWith("[")||(m==="caption"&&(v.includes(" [")&&(v=v.substring(0,v.indexOf(" ["))),v=`${v}@±@${d[u].lang}`),c+=v+r)}return c},w=i,h=m=>{m.currentTarget.blur(),t(Fe);const d="$*@",r=n.findIndex(v=>v.element===p.element),c=n.splice(r===-1?0:r),u=Pe({setLiColor:t,divider:d,voices:w,text:S({text:"element",playList:c,divider:d}),lang:l.lang,rate:l.rate});u&&ne.error(u)},T=m=>{m.currentTarget.blur();const d="$*@";t(Fe);const r=n.findIndex(v=>v.element===p.element),c=n.splice(r===-1?0:r),u=Pe({setLiColor:t,divider:d,voices:w,text:S({text:"caption",playList:c,divider:d}),lang:k,rate:f.rate});u&&ne.error(u)},R=m=>{m.currentTarget.blur(),t(Fe);let d="";const r="$*@",c=n.findIndex(x=>x.element===p.element),u=n.splice(c===-1?0:c);for(let x=0;x<u.length;x+=1){const{element:P,caption:I,lang:F}=u[x];if(!P.startsWith("[")){const B=$(P,""),X=I.includes(" [")?I.substring(0,I.indexOf(" [")):$(I,"");d+=B+`@±@${F}`+X+r}}const v=$n({setLiColor:t,divider:r,voices:w,text:d,lang:l.lang,rate:f.rate});v&&ne.error(v)};return b.jsxs(He,{className:e,$m:`${Kr} ${Vr}`,$pos:"fixed",$side:"right",$high:"bottom",$gtc:"1fr 0.5fr 1fr",children:[b.jsx(pe,{onClick:h,$s:"m",$round:!0,$bs:$t,children:(l==null?void 0:l.lang.at(0).toUpperCase())+(l==null?void 0:l.lang.substring(1))}),b.jsx(It,{onClick:R}),b.jsx(pe,{onClick:T,$s:"m",$round:!0,$bs:$t,children:(k==null?void 0:k.at(0).toUpperCase())+(k==null?void 0:k.substring(1))})]})};Nt.propTypes={className:N.string,filtredElements:N.array,setLiColor:N.func};const Bt=({el:e,sortByDate:n,setSortByDate:t,setLiColor:f})=>{const l=le(),{user:p}=ue(),{activeCluster:i}=ie(),[o,y]=z.useState(),k="$*@",$=(r,c)=>{let u="";return c?(r.trim().endsWith(".")||r.trim().endsWith("!")||r.trim().endsWith("?")||r.endsWith('"')?(u=r.trim().replaceAll(", `",`;${c} `).replaceAll(" `",`${c} `).replaceAll(",`",";").replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",`__${c}`).replaceAll(".",`.${c}`).replaceAll(",",`,${c}`).replaceAll("!",`!${c}`).replaceAll("?",`?${c}`).replaceAll(":",`:${c}`),i.lang.includes("de")&&(u=u.replaceAll(`0.${c}`,"0.").replaceAll(`1.${c}`,"1.").replaceAll(`2.${c}`,"2.").replaceAll(`3.${c}`,"3.").replaceAll(`4.${c}`,"4.").replaceAll(`5.${c}`,"5.").replaceAll(`6.${c}`,"6.").replaceAll(`7.${c}`,"7.").replaceAll(`8.${c}`,"8.").replaceAll(`9.${c}`,"9."))):u=r.trim()+c,u.includes("[")?u.substring(0,u.indexOf("["))+c:u):r},S=r=>{r.currentTarget.blur();const c=Pe({setLiColor:f,divider:k,voices:window.speechSynthesis.getVoices(),text:$(e.element,k),lang:i.lang,rate:i.rate});c&&ne.error(c)},w=r=>{r.currentTarget.blur();const c=Pe({setLiColor:f,divider:k,voices:window.speechSynthesis.getVoices(),text:$(e.caption,k),lang:e.lang,rate:p.rate});c&&ne.error(c)},h=r=>{t(!n),n?ne.success("Below is Recent"):ne.success("Above is Recent"),r.stopPropagation()},T=r=>{const{_id:c}=i;l(kt(e)),r.currentTarget.closest("li").id!=="active-element"&&l(Ge({_id:c,activeEl:e._id}))},R=Sn(e.caption),m=Tn({onSuccess:r=>{l(Rn(r.access_token))},onError:r=>ne(r.message)}),d=async r=>{const c=await An.get(R.file,{responseType:"blob",headers:{Authorization:`Bearer ${r}`}}).then(v=>v.data),u=URL.createObjectURL(c);y(u)};return b.jsx(b.Fragment,{children:b.jsxs(_r,{onClick:T,children:[b.jsx(wt,{onClick:S,children:e.element}),b.jsx(xr,{onClick:e.element.startsWith("[")?p.googleToken?()=>d(p.googleToken):()=>m():h}),R.text&&b.jsx(wt,{onClick:w,children:R.text}),o&&b.jsx(Dr,{src:o,controls:!0}),!o&&R.link&&b.jsx(Or,{src:R.link})]})})};Bt.propTypes={el:N.object,sortByDate:N.bool,setSortByDate:N.func,$active:N.bool,$hovered:N.bool,setLiColor:N.func};const Wt=({el:e,index:n,length:t,sortByDate:f,setSortByDate:l,translateAll:p,liColor:i,setLiColor:o})=>{const y=le(),{elementTrash:k,activeElement:$}=fe(),[S,w]=z.useState(!1),{_id:h,favorite:T,checked:R}=e,m=k.find(x=>x._id===h),d=()=>{y(je({_id:h,favorite:!T}))},r=()=>{y(je({_id:h,checked:!R}))},c=()=>y(Ln(e)),u=()=>w(!S),v=h===($==null?void 0:$._id);return b.jsxs(Rr,{id:v?"active-element":null,licolor:i,children:[b.jsxs(Ve,{$h:"100%",$p:"0",$fd:"column",children:[b.jsxs(Ar,{$hovered:T,children:[b.jsx("input",{type:"checkbox",name:"favorite",checked:T,onChange:d}),b.jsx(Mn,{size:"20px"})]}),b.jsxs(kr,{$hovered:R,children:[b.jsx("input",{type:"checkbox",name:"checked",checked:R,onChange:r}),b.jsx(kn,{size:"15px"})]}),S&&t===n+1&&b.jsx(qe,{onClick:p,children:b.jsx(Cn,{size:"16px"})})]}),S&&b.jsx(Ze,{el:e,setIsForm:w}),!S&&b.jsx(Bt,{el:e,sortByDate:f,setSortByDate:l,setLiColor:o}),b.jsxs(Ve,{$h:"100%",$p:"0",$fd:"column",children:[b.jsx(Cr,{$hovered:m,onClick:c,children:b.jsx(En,{size:"16px"})}),b.jsx(Er,{onClick:u,children:b.jsx(_n,{size:"15px"})})]})]})};Wt.propTypes={el:N.object,index:N.number,length:N.number,sortByDate:N.bool,setSortByDate:N.func,translateAll:N.func,liColor:N.string,setLiColor:N.func};const Ur=W.ul`
  width: 100%;
  list-style: none;
`,{white:qr}=Y.colors,Hr=()=>{const e=le(),{ref:n,inView:t,entry:f}=Jn({initialInView:!0,rootMargin:"0px 0px -30px 0px"}),{user:l}=ue(),{activeCluster:p}=ie(),{allElements:i,elementTrash:o,elementFilter:y,isLoading:k}=fe(),[$,S]=z.useState(qr);let{elementSelect:w}=fe();w=w||[];const[h,T]=z.useState(!1);z.useEffect(()=>{p&&e(At({cluster:p._id})).unwrap().then(({result:u})=>{if(!p.activeEl)return;const v=u.elements.find(({_id:x})=>x===p.activeEl);e(kt(v))}).then(()=>{const u=document.getElementById("active-element");u&&xn(u)})},[]);const R=i.filter(u=>u.cluster===(p==null?void 0:p._id)).sort((u,v)=>u.createdAt.localeCompare(v.createdAt)),d=(()=>{const u=o.map(v=>v._id);return w.includes("trash")?R.filter(v=>u.includes(v._id)):R})().filter(({element:u,caption:v,favorite:x,checked:P})=>{const I=u.toLowerCase().replace("·","").includes(y)||u.toLowerCase().includes(y)||v.toLowerCase().includes(y),F=w.includes("wordlist")?I&&Nn(u):I,B=()=>w.some(A=>["favorite","unfavorite"].includes(A))?w.includes("favorite")?F&&x===!0:F&&x===!1:F;return(()=>w.some(A=>["checked","unchecked"].includes(A))?w.includes("checked")?B()&&P===!0:B()&&P===!1:B())()}).sort(h?(u,v)=>v.createdAt.localeCompare(u.createdAt):(u,v)=>u.createdAt.localeCompare(v.createdAt)),r=async()=>{const u=l.lang;let v=0;await d.forEach(async x=>{if(v>1)return;const{_id:P,element:I}=x;if(!I.startsWith("[")||u!==x.lang){const F={from:p.lang,to:u},B=await we(I,F,l.engine);e(je({_id:P,lang:u,caption:B})),v=v+1}})},c=window.innerHeight<(f==null?void 0:f.target.getBoundingClientRect().y)+(f==null?void 0:f.target.getBoundingClientRect().height)*1.5;return b.jsxs(b.Fragment,{children:[b.jsxs(Ur,{children:[d.map((u,v,x)=>b.jsx(Wt,{el:u,index:v,length:x.length,sortByDate:h,setSortByDate:T,translateAll:r,liColor:$,setLiColor:S},u._id)),b.jsxs("div",{ref:n,children:[b.jsx(_t,{}),b.jsx(zt,{className:!t||!c?"shown":"hidden"}),b.jsx(Nt,{className:!t||!c?"shown":"hidden",filtredElements:d,setLiColor:S})]})]}),k&&b.jsx(jn,{})]})},{s:St,m:Yr}=Y.indents,ti=()=>b.jsx(Ve,{$p:`0 ${Yr} ${St} ${St}`,children:b.jsx(Hr,{})});export{ti as default};
