import{U as Ie,r as N,t as q,P as I,u as le,b as ue,w as ie,j as w,T as qe,V as Ae,y as Ge,G as dt,H as gt,x as pe,S as dn,W as At,X as Ct,Q as ne,A as fe,Y as gn,Z as mn,_ as vn,$ as bn,k as Et,n as $e,s as W,a0 as yn,a1 as wn,a2 as $n,a3 as Pe,a4 as xt,a5 as Sn,a6 as Tn,M as Rn,a7 as kn,a8 as Me,a9 as An,aa as Cn,ab as En,ac as _t,ad as xn,ae as _n,F as Ve,E as Ln,af as jn,D as Pn,C as Mn,ag as On,N as Dn,ah as zn}from"./index-de65cd32.js";import{r as Lt,H as Nn,T as In}from"./index-0c849f1e.js";import{w as jt}from"./writeClipboard-0dbcbbfe.js";import{v as Bn,u as Wn}from"./index.esm-d69b4af9.js";import{a as Fn}from"./index-be6a5d50.js";const Ue=(e,n)=>{if(!n.includes("de"))return e;const t=e.trim().split(`
`);return t.length===1?e:["der","die","das"].includes(t[0].split(" ")[0])?`${t[0].trim()}, ${t[1].split("·")[1].replaceAll("⁰","").replaceAll("/"," / ").trim()}`:(e.includes("hat")||e.includes("ist"))&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e.includes("am")&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e},Gn=(e,n)=>{let t=e;for(const r in n)t=t.replaceAll(r,n[r]);const p=r=>r.replace(/^./,c=>c.toUpperCase()),s=[...t.split(/\s+/)];for(let r=0;r<s.length;r+=1)[".","!","?"].includes(s[r].at(-1))&&s[r+1]&&s.splice(r+1,1,p(s[r+1]));return s.join(" ")},Vn=e=>/[a-z]/.test(e.charAt(0)),{VITE_DEEPL_API_KEY:Un}={VITE_GOOGLE_CLIENT_ID:"689266183428-lh3lmpaqnd2qd6t93voa8s6ipt3836q1.apps.googleusercontent.com",VITE_DEEPL_API_KEY:"d15bf272-fb1f-4f29-bbc3-d3bbdd686c53:fx",VITE_GOOGLE_API_KEY:"AIzaSyDqQndBxYEuOG7F6iYDqQoiNF90tptRmBQ",VITE_PROD_BACK_URL:"https://studyorganizer.onrender.com",BASE_URL:"/studyorganizer/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},Kn={google:"",deepl:Un},we=async(e,{from:n,to:t},p)=>{var l,r;if(!e||e.length===0)return"";const s=e.replaceAll(" ·",",").replaceAll("·","");Ie.engine=p,Ie.key=Kn[p];try{let c=await Ie(`${s}`,{from:n,to:t});if(t.includes("en")&&s.toLowerCase().includes("uhr")&&(c=c.replaceAll("a.m. on","am on").replaceAll("p.m. on","pm on").replaceAll("a.m. to","am to").replaceAll("p.m. to","pm to").replaceAll("a.m.","am.").replaceAll("p.m.","pm.")),[".","!","?"].includes(s.at(-1)))return c;const E=s.split(s.includes(", ")?", ":/\s+/),T=c.split(", "),y=t.includes("de")?T[0]:T[0].at(0).toLowerCase()+T[0].substring(1);return E.length===1?c.toLocaleLowerCase()+", ":["der","die","das"].includes(E[0].split(" ")[0])?c.replace("The ","").replace("the ","").split(", ")[0].toLocaleLowerCase()+", ":t.includes("en")&&((l=E[2])!=null&&l.startsWith("am"))?T[2].startsWith("the")?c:`${y}, ${T[1]}, the ${T[2]}`:(E[0].endsWith("n")&&["hat","ist"].includes((r=E[2])==null?void 0:r.split(" ")[0])&&n.includes("de")&&(c=t.includes("en")?"to "+y+", ":y+", "),c)}catch(c){return c.message}},Oe=(e,n)=>e.endsWith(n)?e.substring(0,e.length-1):e,Hn=(e,n)=>{let t=84;e[0]&&(t=Number(e[0].style.height.replace("px",""))),N.useEffect(()=>{if(!e[0])return;let p=Math.max(...e.map(s=>s.scrollHeight));t!==p&&(p=p<=90?p:p+6,e.forEach(s=>{s.style.height=p+"px"}))},[t,e,n])},Ce=[{value:"de",label:"German"},{value:"en",label:"English"},{value:"uk",label:"Ukrainian"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"it",label:"Italian"}],Ee=[{value:.3,label:"Rate: 0.3"},{value:.4,label:"Rate: 0.4"},{value:.5,label:"Rate: 0.5"},{value:.6,label:"Rate: 0.6"},{value:.8,label:"Rate: 0.8"},{value:1,label:"Rate: 1"},{value:1.25,label:"Rate: 1.25"},{value:1.5,label:"Rate: 1.5"}],qn={"..":".",". .":".","?.":"?","? .":"?","!.":"!","! .":"!",",,":",",", ,":","},Yn={" Dot":"."," dot":"."," exclamation mark":"!"," question mark":"?"," comma":","," colon":":"," semi-colon":";","Yes ":"Yes, ","No ":"No, "},Qn={" Punkt":"."," Ausrufezeichen":"!"," Fragezeichen":"?"," Komma":","," Doppelpunkt":":"," Semikolon":";","Ja ":"Ja, ","Nein ":"Nein, "," weil":", weil"," aber":", aber"," als":", als"," ob":", ob"," damit":", damit"," bevor":", bevor"," obwohl":", obwohl"," dass":", dass"," dann":", dann"," deshalb":", deshalb"," desvegen":", desvegen"," trotzdem":", trotzdem"},Xn={...Yn,...Qn,...qn};var Ke=new Map,xe=new WeakMap,mt=0,Zn=void 0;function Jn(e){return e?(xe.has(e)||(mt+=1,xe.set(e,mt.toString())),xe.get(e)):"0"}function er(e){return Object.keys(e).sort().filter(n=>e[n]!==void 0).map(n=>`${n}_${n==="root"?Jn(e.root):e[n]}`).toString()}function tr(e){const n=er(e);let t=Ke.get(n);if(!t){const p=new Map;let s;const l=new IntersectionObserver(r=>{r.forEach(c=>{var b;const E=c.isIntersecting&&s.some(T=>c.intersectionRatio>=T);e.trackVisibility&&typeof c.isVisible>"u"&&(c.isVisible=E),(b=p.get(c.target))==null||b.forEach(T=>{T(E,c)})})},e);s=l.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),t={id:n,observer:l,elements:p},Ke.set(n,t)}return t}function nr(e,n,t={},p=Zn){if(typeof window.IntersectionObserver>"u"&&p!==void 0){const b=e.getBoundingClientRect();return n(p,{isIntersecting:p,target:e,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:b,intersectionRect:b,rootBounds:b}),()=>{}}const{id:s,observer:l,elements:r}=tr(t),c=r.get(e)||[];return r.has(e)||r.set(e,c),c.push(n),l.observe(e),function(){c.splice(c.indexOf(n),1),c.length===0&&(r.delete(e),l.unobserve(e)),r.size===0&&(l.disconnect(),Ke.delete(s))}}function rr({threshold:e,delay:n,trackVisibility:t,rootMargin:p,root:s,triggerOnce:l,skip:r,initialInView:c,fallbackInView:b,onChange:E}={}){var T;const[y,$]=N.useState(null),d=N.useRef(E),[R,A]=N.useState({inView:!!c,entry:void 0});d.current=E,N.useEffect(()=>{if(r||!y)return;let S;return S=nr(y,(u,i)=>{A({inView:u,entry:i}),d.current&&d.current(u,i),i.isIntersecting&&l&&S&&(S(),S=void 0)},{root:s,rootMargin:p,threshold:e,trackVisibility:t,delay:n},b),()=>{S&&S()}},[Array.isArray(e)?e.toString():e,y,s,p,l,r,t,b,n]);const f=(T=R.entry)==null?void 0:T.target,g=N.useRef(void 0);!y&&f&&!l&&!r&&g.current!==f&&(g.current=f,A({inView:!!c,entry:void 0}));const h=[$,R.inView,R.entry];return h.ref=h[0],h.inView=h[1],h.entry=h[2],h}const{backgroundHoverd:_e,white:Le,borderLight:je}=q.colors,Pt=()=>{const e=le(),{user:n}=ue(),{activeCluster:t}=ie(),p=({value:c})=>{e(Ge({_id:t._id,lang:c})).unwrap().then(b=>e(dt(b.result.cluster)))},s=({value:c})=>{e(Ge({_id:t._id,rate:c})).unwrap().then(b=>e(dt(b.result.cluster)))},l=({value:c})=>{const b=new FormData;b.append("lang",c),e(gt(b))},r=({value:c})=>{const b=new FormData;b.append("rate",c),e(gt(b))};return w.jsxs(qe,{$m:"0",$cg:"8px",$ai:"center",$gtc:"2fr 2fr 2fr 2fr",children:[w.jsx(Ae,{options:Ce,defaultValue:Ce.find(c=>c.value===(t==null?void 0:t.lang)),onChange:p,placeholder:"Language...",$ol:_e,$b:Le,$bh:je}),w.jsx(Ae,{options:Ee,defaultValue:Ee.find(c=>c.value==(t==null?void 0:t.rate)),onChange:s,placeholder:"Rate...",$ol:_e,$b:Le,$bh:je}),w.jsx(Ae,{options:Ce,defaultValue:Ce.find(c=>c.value===n.lang),onChange:l,placeholder:"Language...",$ol:_e,$b:Le,$bh:je}),w.jsx(Ae,{options:Ee,defaultValue:Ee.find(c=>c.value==n.rate),onChange:r,placeholder:"Rate...",$ol:_e,$b:Le,$bh:je})]})};Pt.propTypes={filtredElements:I.array,setLiColor:I.func};const{button:ir}=q.shadows,sr=()=>{const e=le(),{user:n}=ue(),{activeCluster:t}=ie();N.useEffect(()=>{const s=async l=>{l.key==="e"&&l.metaKey&&!l.altKey&&!l.shiftKey&&(l.preventDefault(),await p())};return addEventListener("keydown",s),()=>{removeEventListener("keydown",s)}},[]);const p=async s=>{const l=window.getSelection().toString();l&&await jt(l);const r=await Lt();let c=Ue(r,t.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();c=Oe(c,",");const b={from:t.lang,to:n.lang};let E=await we(c,b,n.engine);E=Oe(E.trim(),",");const{_id:T}=t;try{const y={cluster:T,element:"[]",caption:c},$={cluster:T,element:c,caption:E,favorite:!0,checked:c.split(/\s+/).length<20},d=c.includes("https://")?y:$;e(At(d)).unwrap().then(()=>(s==null?void 0:s.target)&&Ct()).finally(()=>{var R;return(R=s==null?void 0:s.target)==null?void 0:R.blur()})}catch(y){s==null||s.currentTarget.blur(),ne.error(`Invalid element, ${y.message}`)}};return w.jsx(pe,{onClick:p,$s:"m",$round:!0,$bs:ir,children:w.jsx(dn,{size:18})})},{button:ar}=q.shadows,or=()=>{const e=le(),{elementTrash:n}=fe(),t=()=>{confirm("Are you sure you want to delete the selected Element(s)?")&&e(gn(n.map(p=>p._id).join("&"))).unwrap().then(()=>e(mn()))};return w.jsx(pe,{onClick:t,$s:"m",$round:!0,$bs:ar,children:w.jsx(Nn,{size:16})})};function cr(e){return vn({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M250.73,210.63l-56-112a12,12,0,0,0-21.46,0l-20.52,41A84.2,84.2,0,0,1,114,126.22,107.48,107.48,0,0,0,139.33,68H160a12,12,0,0,0,0-24H108V32a12,12,0,0,0-24,0V44H32a12,12,0,0,0,0,24h83.13A83.69,83.69,0,0,1,96,110.35,84,84,0,0,1,83.6,91a12,12,0,1,0-21.81,10A107.55,107.55,0,0,0,78,126.24,83.54,83.54,0,0,1,32,140a12,12,0,0,0,0,24,107.47,107.47,0,0,0,64-21.07,108.4,108.4,0,0,0,45.39,19.44l-24.13,48.26a12,12,0,1,0,21.46,10.73L151.41,196h65.17l12.68,25.36a12,12,0,1,0,21.47-10.73ZM163.41,172,184,130.83,204.58,172Z"},child:[]}]})(e)}const{button:lr}=q.shadows,ur=()=>{const{activeCluster:e}=ie();N.useEffect(()=>{const l=async r=>{r.metaKey&&r.key==="d"&&!r.altKey&&!r.shiftKey&&(r.preventDefault(),await s())};return addEventListener("keydown",l),()=>{removeEventListener("keydown",l)}},[]);let n=[];function t(l){l.forEach(r=>{const c=window.open(r,"_blank");c?n.push(c):ne.error(`Failed to open tab: ${r}`)})}const p=()=>{n.forEach(l=>{l.close()}),n=[]},s=async()=>{const l=window.getSelection().toString();l&&await jt(l);const r=await Lt();let c=[];e.lang.includes("de")&&c.push(`https://www.verbformen.com/conjugation/?w=${r}`),e.lang.includes("en")&&c.push(`https://dictionary.cambridge.org/dictionary/english-russian/${r}`),p(),t(c)};return w.jsx(pe,{onClick:s,$s:"m",$round:!0,$bs:lr,children:w.jsx(cr,{size:18})})},{s:vt,m:pr}=q.indents,Mt=({className:e})=>{const{pathname:n}=bn(),{elementTrash:t}=fe(),{activeCluster:p}=ie(),s=t.length>0?" 1fr":"",l=p?" 1fr":"",r=s+l+" 1fr";if(n.includes("/element"))return w.jsxs(qe,{className:e,$m:`${vt} ${pr}`,$pos:"fixed",$side:"left",$high:"bottom",$gtc:r,$cg:vt,children:[w.jsx(ur,{}),l&&w.jsx(sr,{}),s&&w.jsx(or,{})]})};Mt.propTypes={className:I.string};var fr={exports:{}};(function(e){var n=function(t){var p=Object.prototype,s=p.hasOwnProperty,l=Object.defineProperty||function(a,o,v){a[o]=v.value},r,c=typeof Symbol=="function"?Symbol:{},b=c.iterator||"@@iterator",E=c.asyncIterator||"@@asyncIterator",T=c.toStringTag||"@@toStringTag";function y(a,o,v){return Object.defineProperty(a,o,{value:v,enumerable:!0,configurable:!0,writable:!0}),a[o]}try{y({},"")}catch{y=function(o,v,j){return o[v]=j}}function $(a,o,v,j){var L=o&&o.prototype instanceof S?o:S,D=Object.create(L.prototype),K=new z(j||[]);return l(D,"_invoke",{value:k(a,v,K)}),D}t.wrap=$;function d(a,o,v){try{return{type:"normal",arg:a.call(o,v)}}catch(j){return{type:"throw",arg:j}}}var R="suspendedStart",A="suspendedYield",f="executing",g="completed",h={};function S(){}function u(){}function i(){}var m={};y(m,b,function(){return this});var C=Object.getPrototypeOf,M=C&&C(C(O([])));M&&M!==p&&s.call(M,b)&&(m=M);var F=i.prototype=S.prototype=Object.create(m);u.prototype=i,l(F,"constructor",{value:i,configurable:!0}),l(i,"constructor",{value:u,configurable:!0}),u.displayName=y(i,T,"GeneratorFunction");function B(a){["next","throw","return"].forEach(function(o){y(a,o,function(v){return this._invoke(o,v)})})}t.isGeneratorFunction=function(a){var o=typeof a=="function"&&a.constructor;return o?o===u||(o.displayName||o.name)==="GeneratorFunction":!1},t.mark=function(a){return Object.setPrototypeOf?Object.setPrototypeOf(a,i):(a.__proto__=i,y(a,T,"GeneratorFunction")),a.prototype=Object.create(F),a},t.awrap=function(a){return{__await:a}};function J(a,o){function v(D,K,H,Q){var U=d(a[D],a,K);if(U.type==="throw")Q(U.arg);else{var ge=U.arg,ae=ge.value;return ae&&typeof ae=="object"&&s.call(ae,"__await")?o.resolve(ae.__await).then(function(re){v("next",re,H,Q)},function(re){v("throw",re,H,Q)}):o.resolve(ae).then(function(re){ge.value=re,H(ge)},function(re){return v("throw",re,H,Q)})}}var j;function L(D,K){function H(){return new o(function(Q,U){v(D,K,Q,U)})}return j=j?j.then(H,H):H()}l(this,"_invoke",{value:L})}B(J.prototype),y(J.prototype,E,function(){return this}),t.AsyncIterator=J,t.async=function(a,o,v,j,L){L===void 0&&(L=Promise);var D=new J($(a,o,v,j),L);return t.isGeneratorFunction(o)?D:D.next().then(function(K){return K.done?K.value:D.next()})};function k(a,o,v){var j=R;return function(D,K){if(j===f)throw new Error("Generator is already running");if(j===g){if(D==="throw")throw K;return G()}for(v.method=D,v.arg=K;;){var H=v.delegate;if(H){var Q=x(H,v);if(Q){if(Q===h)continue;return Q}}if(v.method==="next")v.sent=v._sent=v.arg;else if(v.method==="throw"){if(j===R)throw j=g,v.arg;v.dispatchException(v.arg)}else v.method==="return"&&v.abrupt("return",v.arg);j=f;var U=d(a,o,v);if(U.type==="normal"){if(j=v.done?g:A,U.arg===h)continue;return{value:U.arg,done:v.done}}else U.type==="throw"&&(j=g,v.method="throw",v.arg=U.arg)}}}function x(a,o){var v=o.method,j=a.iterator[v];if(j===r)return o.delegate=null,v==="throw"&&a.iterator.return&&(o.method="return",o.arg=r,x(a,o),o.method==="throw")||v!=="return"&&(o.method="throw",o.arg=new TypeError("The iterator does not provide a '"+v+"' method")),h;var L=d(j,a.iterator,o.arg);if(L.type==="throw")return o.method="throw",o.arg=L.arg,o.delegate=null,h;var D=L.arg;if(!D)return o.method="throw",o.arg=new TypeError("iterator result is not an object"),o.delegate=null,h;if(D.done)o[a.resultName]=D.value,o.next=a.nextLoc,o.method!=="return"&&(o.method="next",o.arg=r);else return D;return o.delegate=null,h}B(F),y(F,T,"Generator"),y(F,b,function(){return this}),y(F,"toString",function(){return"[object Generator]"});function _(a){var o={tryLoc:a[0]};1 in a&&(o.catchLoc=a[1]),2 in a&&(o.finallyLoc=a[2],o.afterLoc=a[3]),this.tryEntries.push(o)}function P(a){var o=a.completion||{};o.type="normal",delete o.arg,a.completion=o}function z(a){this.tryEntries=[{tryLoc:"root"}],a.forEach(_,this),this.reset(!0)}t.keys=function(a){var o=Object(a),v=[];for(var j in o)v.push(j);return v.reverse(),function L(){for(;v.length;){var D=v.pop();if(D in o)return L.value=D,L.done=!1,L}return L.done=!0,L}};function O(a){if(a!=null){var o=a[b];if(o)return o.call(a);if(typeof a.next=="function")return a;if(!isNaN(a.length)){var v=-1,j=function L(){for(;++v<a.length;)if(s.call(a,v))return L.value=a[v],L.done=!1,L;return L.value=r,L.done=!0,L};return j.next=j}}throw new TypeError(typeof a+" is not iterable")}t.values=O;function G(){return{value:r,done:!0}}return z.prototype={constructor:z,reset:function(a){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(P),!a)for(var o in this)o.charAt(0)==="t"&&s.call(this,o)&&!isNaN(+o.slice(1))&&(this[o]=r)},stop:function(){this.done=!0;var a=this.tryEntries[0],o=a.completion;if(o.type==="throw")throw o.arg;return this.rval},dispatchException:function(a){if(this.done)throw a;var o=this;function v(Q,U){return D.type="throw",D.arg=a,o.next=Q,U&&(o.method="next",o.arg=r),!!U}for(var j=this.tryEntries.length-1;j>=0;--j){var L=this.tryEntries[j],D=L.completion;if(L.tryLoc==="root")return v("end");if(L.tryLoc<=this.prev){var K=s.call(L,"catchLoc"),H=s.call(L,"finallyLoc");if(K&&H){if(this.prev<L.catchLoc)return v(L.catchLoc,!0);if(this.prev<L.finallyLoc)return v(L.finallyLoc)}else if(K){if(this.prev<L.catchLoc)return v(L.catchLoc,!0)}else if(H){if(this.prev<L.finallyLoc)return v(L.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(a,o){for(var v=this.tryEntries.length-1;v>=0;--v){var j=this.tryEntries[v];if(j.tryLoc<=this.prev&&s.call(j,"finallyLoc")&&this.prev<j.finallyLoc){var L=j;break}}L&&(a==="break"||a==="continue")&&L.tryLoc<=o&&o<=L.finallyLoc&&(L=null);var D=L?L.completion:{};return D.type=a,D.arg=o,L?(this.method="next",this.next=L.finallyLoc,h):this.complete(D)},complete:function(a,o){if(a.type==="throw")throw a.arg;return a.type==="break"||a.type==="continue"?this.next=a.arg:a.type==="return"?(this.rval=this.arg=a.arg,this.method="return",this.next="end"):a.type==="normal"&&o&&(this.next=o),h},finish:function(a){for(var o=this.tryEntries.length-1;o>=0;--o){var v=this.tryEntries[o];if(v.finallyLoc===a)return this.complete(v.completion,v.afterLoc),P(v),h}},catch:function(a){for(var o=this.tryEntries.length-1;o>=0;--o){var v=this.tryEntries[o];if(v.tryLoc===a){var j=v.completion;if(j.type==="throw"){var L=j.arg;P(v)}return L}}throw new Error("illegal catch attempt")},delegateYield:function(a,o,v){return this.delegate={iterator:O(a),resultName:o,nextLoc:v},this.method==="next"&&(this.arg=r),h}},t}(e.exports);try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})(fr);var ye={},Ot={},X={};Object.defineProperty(X,"__esModule",{value:!0});X.browserSupportsPolyfills=X.compareTwoStringsUsingDiceCoefficient=X.commandToRegExp=X.concatTranscripts=X.debounce=void 0;var hr=function(n,t,p){var s;return function(){var l=this,r=arguments,c=function(){s=null,p||n.apply(l,r)},b=p&&!s;clearTimeout(s),s=setTimeout(c,t),b&&n.apply(l,r)}};X.debounce=hr;var dr=function(){for(var n=arguments.length,t=new Array(n),p=0;p<n;p++)t[p]=arguments[p];return t.map(function(s){return s.trim()}).join(" ").trim()};X.concatTranscripts=dr;var gr=/\s*\((.*?)\)\s*/g,mr=/(\(\?:[^)]+\))\?/g,vr=/(\(\?)?:\w+/g,br=/\*/g,yr=/[-{}[\]+?.,\\^$|#]/g,wr=function(n){return n instanceof RegExp?new RegExp(n.source,"i"):(n=n.replace(yr,"\\$&").replace(gr,"(?:$1)?").replace(vr,function(t,p){return p?t:"([^\\s]+)"}).replace(br,"(.*?)").replace(mr,"\\s*$1?\\s*"),new RegExp("^"+n+"$","i"))};X.commandToRegExp=wr;var $r=function(n,t){if(n=n.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!n.length&&!t.length)return 1;if(!n.length||!t.length)return 0;if(n===t)return 1;if(n.length===1&&t.length===1||n.length<2||t.length<2)return 0;for(var p=new Map,s=0;s<n.length-1;s++){var l=n.substring(s,s+2),r=p.has(l)?p.get(l)+1:1;p.set(l,r)}for(var c=0,b=0;b<t.length-1;b++){var E=t.substring(b,b+2),T=p.has(E)?p.get(E):0;T>0&&(p.set(E,T-1),c++)}return 2*c/(n.length+t.length-2)};X.compareTwoStringsUsingDiceCoefficient=$r;var Sr=function(){return typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0)};X.browserSupportsPolyfills=Sr;var he={},ce={};Object.defineProperty(ce,"__esModule",{value:!0});ce.APPEND_TRANSCRIPT=ce.CLEAR_TRANSCRIPT=void 0;var Tr="CLEAR_TRANSCRIPT";ce.CLEAR_TRANSCRIPT=Tr;var Rr="APPEND_TRANSCRIPT";ce.APPEND_TRANSCRIPT=Rr;Object.defineProperty(he,"__esModule",{value:!0});he.appendTranscript=he.clearTranscript=void 0;var Dt=ce,kr=function(){return{type:Dt.CLEAR_TRANSCRIPT}};he.clearTranscript=kr;var Ar=function(n,t){return{type:Dt.APPEND_TRANSCRIPT,payload:{interimTranscript:n,finalTranscript:t}}};he.appendTranscript=Ar;var De={};Object.defineProperty(De,"__esModule",{value:!0});De.transcriptReducer=void 0;var bt=ce,Cr=X,Er=function(n,t){switch(t.type){case bt.CLEAR_TRANSCRIPT:return{interimTranscript:"",finalTranscript:""};case bt.APPEND_TRANSCRIPT:return{interimTranscript:t.payload.interimTranscript,finalTranscript:(0,Cr.concatTranscripts)(n.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};De.transcriptReducer=Er;var zt={},Ye={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){return/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"")};e.default=n})(Ye);var Qe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.isNative=void 0;var n=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),t=function(l){return l===n};e.isNative=t;var p=n;e.default=p})(Qe);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(Ye),t=X,p=Qe;function s(y){return y&&y.__esModule?y:{default:y}}function l(y,$,d,R,A,f,g){try{var h=y[f](g),S=h.value}catch(u){d(u);return}h.done?$(S):Promise.resolve(S).then(R,A)}function r(y){return function(){var $=this,d=arguments;return new Promise(function(R,A){var f=y.apply($,d);function g(S){l(f,R,A,g,h,"next",S)}function h(S){l(f,R,A,g,h,"throw",S)}g(void 0)})}}function c(y,$){if(!(y instanceof $))throw new TypeError("Cannot call a class as a function")}function b(y,$){for(var d=0;d<$.length;d++){var R=$[d];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(y,R.key,R)}}function E(y,$,d){return $&&b(y.prototype,$),d&&b(y,d),y}var T=function(){function y($){c(this,y),this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=function(){},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition($),(0,n.default)()&&(this.updateFinalTranscript=(0,t.debounce)(this.updateFinalTranscript,250,!0))}return E(y,[{key:"setSpeechRecognition",value:function(d){var R=!!d&&((0,p.isNative)(d)||(0,t.browserSupportsPolyfills)());R&&(this.disableRecognition(),this.recognition=new d,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(R)}},{key:"subscribe",value:function(d,R){this.subscribers[d]=R}},{key:"unsubscribe",value:function(d){delete this.subscribers[d]}},{key:"emitListeningChange",value:function(d){var R=this;this.listening=d,Object.keys(this.subscribers).forEach(function(A){var f=R.subscribers[A].onListeningChange;f(d)})}},{key:"emitMicrophoneAvailabilityChange",value:function(d){var R=this;this.isMicrophoneAvailable=d,Object.keys(this.subscribers).forEach(function(A){var f=R.subscribers[A].onMicrophoneAvailabilityChange;f(d)})}},{key:"emitTranscriptChange",value:function(d,R){var A=this;Object.keys(this.subscribers).forEach(function(f){var g=A.subscribers[f].onTranscriptChange;g(d,R)})}},{key:"emitClearTranscript",value:function(){var d=this;Object.keys(this.subscribers).forEach(function(R){var A=d.subscribers[R].onClearTranscript;A()})}},{key:"emitBrowserSupportsSpeechRecognitionChange",value:function(d){var R=this;Object.keys(this.subscribers).forEach(function(A){var f=R.subscribers[A],g=f.onBrowserSupportsSpeechRecognitionChange,h=f.onBrowserSupportsContinuousListeningChange;g(d),h(d)})}},{key:"disconnect",value:function(d){if(this.recognition&&this.listening)switch(d){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}},{key:"disableRecognition",value:function(){this.recognition&&(this.recognition.onresult=function(){},this.recognition.onend=function(){},this.recognition.onerror=function(){},this.listening&&this.stopListening())}},{key:"onError",value:function(d){d&&d.error&&d.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}},{key:"onRecognitionDisconnect",value:function(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}},{key:"updateTranscript",value:function(d){var R=d.results,A=d.resultIndex,f=A===void 0?R.length-1:A;this.interimTranscript="",this.finalTranscript="";for(var g=f;g<R.length;++g)R[g].isFinal&&(!(0,n.default)()||R[g][0].confidence>0)?this.updateFinalTranscript(R[g][0].transcript):this.interimTranscript=(0,t.concatTranscripts)(this.interimTranscript,R[g][0].transcript);var h=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(h=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,h||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}},{key:"updateFinalTranscript",value:function(d){this.finalTranscript=(0,t.concatTranscripts)(this.finalTranscript,d)}},{key:"resetTranscript",value:function(){this.disconnect("RESET")}},{key:"startListening",value:function(){var $=r(regeneratorRuntime.mark(function R(){var A,f,g,h,S,u,i=arguments;return regeneratorRuntime.wrap(function(C){for(;;)switch(C.prev=C.next){case 0:if(A=i.length>0&&i[0]!==void 0?i[0]:{},f=A.continuous,g=f===void 0?!1:f,h=A.language,this.recognition){C.next=3;break}return C.abrupt("return");case 3:if(S=g!==this.recognition.continuous,u=h&&h!==this.recognition.lang,!(S||u)){C.next=11;break}if(!this.listening){C.next=9;break}return C.next=9,this.stopListening();case 9:this.recognition.continuous=S?g:this.recognition.continuous,this.recognition.lang=u?h:this.recognition.lang;case 11:if(this.listening){C.next=22;break}return this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript()),C.prev=13,C.next=16,this.start();case 16:this.emitListeningChange(!0),C.next=22;break;case 19:C.prev=19,C.t0=C.catch(13),C.t0 instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1);case 22:case"end":return C.stop()}},R,this,[[13,19]])}));function d(){return $.apply(this,arguments)}return d}()},{key:"abortListening",value:function(){var $=r(regeneratorRuntime.mark(function R(){var A=this;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.disconnect("ABORT"),this.emitListeningChange(!1),g.next=4,new Promise(function(h){A.onStopListening=h});case 4:case"end":return g.stop()}},R,this)}));function d(){return $.apply(this,arguments)}return d}()},{key:"stopListening",value:function(){var $=r(regeneratorRuntime.mark(function R(){var A=this;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return this.disconnect("STOP"),this.emitListeningChange(!1),g.next=4,new Promise(function(h){A.onStopListening=h});case 4:case"end":return g.stop()}},R,this)}));function d(){return $.apply(this,arguments)}return d}()},{key:"getRecognition",value:function(){return this.recognition}},{key:"start",value:function(){var $=r(regeneratorRuntime.mark(function R(){return regeneratorRuntime.wrap(function(f){for(;;)switch(f.prev=f.next){case 0:if(!(this.recognition&&!this.listening)){f.next=4;break}return f.next=3,this.recognition.start();case 3:this.listening=!0;case 4:case"end":return f.stop()}},R,this)}));function d(){return $.apply(this,arguments)}return d}()},{key:"stop",value:function(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}},{key:"abort",value:function(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}}]),y}();e.default=T})(zt);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.useSpeechRecognition=void 0;var n=N,t=X,p=he,s=De,l=b(zt),r=b(Ye),c=b(Qe);function b(k){return k&&k.__esModule?k:{default:k}}function E(k,x,_,P,z,O,G){try{var a=k[O](G),o=a.value}catch(v){_(v);return}a.done?x(o):Promise.resolve(o).then(P,z)}function T(k){return function(){var x=this,_=arguments;return new Promise(function(P,z){var O=k.apply(x,_);function G(o){E(O,P,z,G,a,"next",o)}function a(o){E(O,P,z,G,a,"throw",o)}G(void 0)})}}function y(k){return R(k)||d(k)||h(k)||$()}function $(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d(k){if(typeof Symbol<"u"&&Symbol.iterator in Object(k))return Array.from(k)}function R(k){if(Array.isArray(k))return S(k)}function A(k){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?A=function(_){return typeof _}:A=function(_){return _&&typeof Symbol=="function"&&_.constructor===Symbol&&_!==Symbol.prototype?"symbol":typeof _},A(k)}function f(k,x){return i(k)||u(k,x)||h(k,x)||g()}function g(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h(k,x){if(k){if(typeof k=="string")return S(k,x);var _=Object.prototype.toString.call(k).slice(8,-1);if(_==="Object"&&k.constructor&&(_=k.constructor.name),_==="Map"||_==="Set")return Array.from(k);if(_==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(_))return S(k,x)}}function S(k,x){(x==null||x>k.length)&&(x=k.length);for(var _=0,P=new Array(x);_<x;_++)P[_]=k[_];return P}function u(k,x){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(k)))){var _=[],P=!0,z=!1,O=void 0;try{for(var G=k[Symbol.iterator](),a;!(P=(a=G.next()).done)&&(_.push(a.value),!(x&&_.length===x));P=!0);}catch(o){z=!0,O=o}finally{try{!P&&G.return!=null&&G.return()}finally{if(z)throw O}}return _}}function i(k){if(Array.isArray(k))return k}var m=!!c.default,C=m&&!(0,r.default)(),M,F=function(){var x=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},_=x.transcribing,P=_===void 0?!0:_,z=x.clearTranscriptOnListen,O=z===void 0?!0:z,G=x.commands,a=G===void 0?[]:G,o=(0,n.useState)(B.getRecognitionManager()),v=f(o,1),j=v[0],L=(0,n.useState)(m),D=f(L,2),K=D[0],H=D[1],Q=(0,n.useState)(C),U=f(Q,2),ge=U[0],ae=U[1],re=(0,n.useReducer)(s.transcriptReducer,{interimTranscript:j.interimTranscript,finalTranscript:""}),Ze=f(re,2),Je=Ze[0],et=Je.interimTranscript,tt=Je.finalTranscript,nt=Ze[1],qt=(0,n.useState)(j.listening),rt=f(qt,2),Yt=rt[0],Qt=rt[1],Xt=(0,n.useState)(j.isMicrophoneAvailable),it=f(Xt,2),Zt=it[0],Jt=it[1],st=(0,n.useRef)(a);st.current=a;var at=function(){nt((0,p.clearTranscript)())},me=(0,n.useCallback)(function(){j.resetTranscript(),at()},[j]),en=function(Y,te,oe){var se=A(Y)==="object"?Y.toString():Y,ve=se.replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),Te=(0,t.compareTwoStringsUsingDiceCoefficient)(ve,te);return Te>=oe?{command:Y,commandWithoutSpecials:ve,howSimilar:Te,isFuzzyMatch:!0}:null},tn=function(Y,te){var oe=(0,t.commandToRegExp)(Y),se=oe.exec(te);return se?{command:Y,parameters:se.slice(1)}:null},ot=(0,n.useCallback)(function(ee,Y){st.current.forEach(function(te){var oe=te.command,se=te.callback,ve=te.matchInterim,Te=ve===void 0?!1:ve,ut=te.isFuzzyMatch,pt=ut===void 0?!1:ut,ft=te.fuzzyMatchingThreshold,rn=ft===void 0?.8:ft,ht=te.bestMatchOnly,sn=ht===void 0?!1:ht,Re=!Y&&Te?ee.trim():Y.trim(),an=Array.isArray(oe)?oe:[oe],ke=an.map(function(Z){return pt?en(Z,Re,rn):tn(Z,Re)}).filter(function(Z){return Z});if(pt&&sn&&ke.length>=2){ke.sort(function(Z,Ne){return Ne.howSimilar-Z.howSimilar});var ze=ke[0],on=ze.command,cn=ze.commandWithoutSpecials,ln=ze.howSimilar;se(cn,Re,ln,{command:on,resetTranscript:me})}else ke.forEach(function(Z){if(Z.isFuzzyMatch){var Ne=Z.command,un=Z.commandWithoutSpecials,pn=Z.howSimilar;se(un,Re,pn,{command:Ne,resetTranscript:me})}else{var fn=Z.command,hn=Z.parameters;se.apply(void 0,y(hn).concat([{command:fn,resetTranscript:me}]))}})})},[me]),ct=(0,n.useCallback)(function(ee,Y){P&&nt((0,p.appendTranscript)(ee,Y)),ot(ee,Y)},[ot,P]),lt=(0,n.useCallback)(function(){O&&at()},[O]);(0,n.useEffect)(function(){var ee=B.counter;B.counter+=1;var Y={onListeningChange:Qt,onMicrophoneAvailabilityChange:Jt,onTranscriptChange:ct,onClearTranscript:lt,onBrowserSupportsSpeechRecognitionChange:H,onBrowserSupportsContinuousListeningChange:ae};return j.subscribe(ee,Y),function(){j.unsubscribe(ee)}},[P,O,j,ct,lt]);var nn=(0,t.concatTranscripts)(tt,et);return{transcript:nn,interimTranscript:et,finalTranscript:tt,listening:Yt,isMicrophoneAvailable:Zt,resetTranscript:me,browserSupportsSpeechRecognition:K,browserSupportsContinuousListening:ge}};e.useSpeechRecognition=F;var B={counter:0,applyPolyfill:function(x){M?M.setSpeechRecognition(x):M=new l.default(x);var _=!!x&&(0,t.browserSupportsPolyfills)();m=_,C=_},removePolyfill:function(){M?M.setSpeechRecognition(c.default):M=new l.default(c.default),m=!!c.default,C=m&&!(0,r.default)()},getRecognitionManager:function(){return M||(M=new l.default(c.default)),M},getRecognition:function(){var x=B.getRecognitionManager();return x.getRecognition()},startListening:function(){var k=T(regeneratorRuntime.mark(function _(){var P,z,O,G,a=arguments;return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return P=a.length>0&&a[0]!==void 0?a[0]:{},z=P.continuous,O=P.language,G=B.getRecognitionManager(),v.next=4,G.startListening({continuous:z,language:O});case 4:case"end":return v.stop()}},_)}));function x(){return k.apply(this,arguments)}return x}(),stopListening:function(){var k=T(regeneratorRuntime.mark(function _(){var P;return regeneratorRuntime.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return P=B.getRecognitionManager(),O.next=3,P.stopListening();case 3:case"end":return O.stop()}},_)}));function x(){return k.apply(this,arguments)}return x}(),abortListening:function(){var k=T(regeneratorRuntime.mark(function _(){var P;return regeneratorRuntime.wrap(function(O){for(;;)switch(O.prev=O.next){case 0:return P=B.getRecognitionManager(),O.next=3,P.abortListening();case 3:case"end":return O.stop()}},_)}));function x(){return k.apply(this,arguments)}return x}(),browserSupportsSpeechRecognition:function(){return m},browserSupportsContinuousListening:function(){return C}},J=B;e.default=J})(Ot);(function(e){function n(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(b){return typeof b}:n=function(b){return b&&typeof Symbol=="function"&&b.constructor===Symbol&&b!==Symbol.prototype?"symbol":typeof b},n(r)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"useSpeechRecognition",{enumerable:!0,get:function(){return t.useSpeechRecognition}}),e.default=void 0;var t=s(Ot);function p(){if(typeof WeakMap!="function")return null;var r=new WeakMap;return p=function(){return r},r}function s(r){if(r&&r.__esModule)return r;if(r===null||n(r)!=="object"&&typeof r!="function")return{default:r};var c=p();if(c&&c.has(r))return c.get(r);var b={},E=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var T in r)if(Object.prototype.hasOwnProperty.call(r,T)){var y=E?Object.getOwnPropertyDescriptor(r,T):null;y&&(y.get||y.set)?Object.defineProperty(b,T,y):b[T]=r[T]}return b.default=r,c&&c.set(r,b),b}var l=t.default;e.default=l})(ye);const be=Et(ye);var Nt={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var n={}.hasOwnProperty;function t(){for(var p=[],s=0;s<arguments.length;s++){var l=arguments[s];if(l){var r=typeof l;if(r==="string"||r==="number")p.push(l);else if(Array.isArray(l)){if(l.length){var c=t.apply(null,l);c&&p.push(c)}}else if(r==="object"){if(l.toString!==Object.prototype.toString&&!l.toString.toString().includes("[native code]")){p.push(l.toString());continue}for(var b in l)n.call(l,b)&&l[b]&&p.push(b)}}}return p.join(" ")}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(Nt);var xr=Nt.exports;const _r=Et(xr),{colors:V,shadows:yt,indents:Be}=q,Lr=$e`
  margin-bottom: 7px;
  padding-block: ${Be.xs};

  display: grid;
  align-items: center;
  grid-template-columns: 1fr 25fr 1fr;
  column-gap: 2px;

  border: 1px solid transparent;
  background-color: ${({licolor:e})=>e};
  border-radius: ${Be.xs};
  font-size: 22px;

  &:last-of-type {
    margin-bottom: ${Be.s};
  }
`,jr=W.li`
  ${Lr}

  transition: box-shadow 250ms, border-color 250ms;

  &#active-element {
    border-color: ${V.border};
    background-color: ${V.background};
    box-shadow: ${yt.back};

    &:hover {
      border-color: ${V.accent};
    }
    & div button {
      transition: color 250ms;
      color: ${V.smokeBlack};
      &:hover {
        color: ${V.hovered};
      }
    }
  }

  & div button {
    transition: color 250ms;
    &:hover {
      color: ${V.hovered};
    }
  }

  &:hover {
    border-color: ${V.accent};
    box-shadow: ${yt.back};
  }

  &:hover label,
  &:hover button {
    opacity: 1;
  }
`,It=$e`
  min-height: 19px;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  & input {
    ${Bn}
  }
`,Pr=W.label`
  ${It}

  & svg {
    transition: stroke 250ms;
    stroke-width: 2px;
    color: ${({$hovered:e})=>e?V.yellow:"transparent"};
    stroke: ${({$hovered:e})=>e?V.yellow:V.border};
  }
  &:hover svg {
    stroke: ${V.placeholder};
  }
`,Mr=W.label`
  ${It}
  opacity: ${({$hovered:e})=>e?1:0};
  transition: opacity 250ms;

  & svg {
    transition: border-color 250ms, color 250ms;
    padding: 1px;
    border: 2px solid ${V.border};
    border-radius: 50%;
    color: ${({$hovered:e})=>e?V.border:"transparent"};
  }
  &:hover svg {
    border-color: ${V.placeholder};
    color: ${({$hovered:e})=>e?V.placeholder:"transparent"};
  }
`,Se=$e`
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: transparent;
  border-color: transparent;
  transition: opacity 250ms color 250ms;
  color: ${V.black};

  & svg {
    transition: color 250ms;
    color: ${V.border};
  }
  &:hover,
  &:hover svg {
    color: ${V.placeholder};
  }
`,Or=W.button`
  ${Se}

  opacity: ${({$hovered:e})=>e?1:0};
`,Dr=W.button`
  ${Se}

  opacity: 0;
`,{colors:de,indents:Bt}=q,Wt=$e`
  padding-block: 4px;
  display: grid;
  align-items: start;
  grid-template-columns: 20fr 1fr 20fr;
`,zr=W.div`
  ${Wt}
`,Nr=W.form`
  ${Wt}

  max-height: 70vh;
  overflow-y: scroll;
  scrollbar-width: none;
  grid-template-columns: 12fr 1fr 12fr;
`,wt=W.textarea`
  height: 84px;
  outline: none;
  border: 1px solid ${de.accent};
  border-radius: ${Bt.xs};
  resize: none;
  overflow: clip;
  transition: height 150ms;
`,Ir=W.div`
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  &::after {
    content: '';
    height: calc(100% - 8px);
    width: 1px;
    border: 1px solid ${de.borderLight};
    transition: border-color 250ms;
  }

  &:hover::after {
    border-color: ${de.placeholder};
  }
`,Br=W.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,Wr=W.button`
  ${Se}
`,He=W.button`
  ${Se}
`,Fr=W.button`
  ${Se}
`,$t=W.button`
  height: 100%;
  text-align: left;
  display: flex;
  align-items: top;
  background-color: transparent;
  border-color: transparent;
  border-radius: ${Bt.xs};
  color: ${de.black};
  transition: background-color 250ms;
`,Ft=$e`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  height: 54px;
  border-radius: 30px;
`,Gr=W.iframe`
  ${Ft}
`,St=W.audio`
  ${Ft}

  &::-webkit-media-controls {
    display: flex;
    justify-content: center;
    background-color: ${de.background};
  }
  &::-webkit-media-controls-panel {
    background-color: ${de.backgroundHoverd};
  }
`,Xe=({el:e,setIsForm:n,setRecording:t,setTranslation:p})=>{const s=N.useRef(null),l=N.useRef(null),r=N.useRef(null),c=le(),{user:b}=ue(),{activeCluster:E}=ie(),[T,y]=N.useState(""),{_id:$,element:d,caption:R}=e,{register:A,watch:f,setValue:g,handleSubmit:h,setFocus:S}=Wn({mode:"onBlur",defaultValues:{element:d,caption:R}});N.useEffect(()=>{g("caption",R)},[R,g]);const{ref:u,...i}=A("element"),{ref:m,...C}=A("caption"),M=[s.current,l.current,r.current],F=[f("caption"),f("element")];Hn(M,F),N.useEffect(()=>{S("element"),T&&d.trim().startsWith("der")?g("element",T+d.replace("der","").trim()+", "):T&&d.trim().startsWith("die")?g("element",T+d.replace("die","").trim()+", "):T&&d.trim().startsWith("das")?g("element",T+d.replace("das","").trim()+", "):T?g("element",T+d+", "):g("element",T+d)},[T,d,S,g]),N.useEffect(()=>{const x=async _=>{_.code==="NumpadAdd"&&(_.preventDefault(),await k(b.engine),h(B)()),(_.key==="Enter"||_.key==="F1")&&(_.preventDefault(),h(B)()),_.key==="Escape"&&(_.preventDefault(),n(!1)),_.code==="AltRight"&&s.current.focus()};return addEventListener("keydown",x),()=>{removeEventListener("keydown",x)}},[]);const B=x=>{const _=b.lang;let P=x.caption.trim(),z=Ue(x.element,E.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();z=Oe(z,","),P=Oe(P,","),b.lang.includes("en")&&E.lang.includes("de")&&(z.includes("hat")||z.includes("ist"))&&z.split(`
`)[0].split(/,\s+/)[0].endsWith("n")&&(P=P.split(/,\s+/).map(a=>a.startsWith("to ")?a:`to ${a}`).join(", ")),c($?Pe({_id:$,lang:_,element:z,caption:P}):At({...e,element:z,caption:P})).then(c(xt())),$||(Ct(),t(""),p("")),n(!1)},J=()=>{T===""&&y("der "),T==="der "&&y("die "),T==="die "&&y("das "),T==="das "&&y("")},k=async x=>{const _=f("element"),P=Ue(_,E.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim(),z={from:E.lang,to:b.lang},O=await we(P,z,x);g("caption",O)};return w.jsxs(Nr,{onSubmit:h(B),children:[w.jsx(wt,{...i,name:"element",ref:x=>{u(x),s.current=x}}),w.jsxs(Br,{ref:r,children:[w.jsx(Fr,{type:"button",onClick:J,children:w.jsx(Fn,{size:"18px"})}),w.jsx(He,{type:"button",onClick:()=>k("google"),children:w.jsx(yn,{size:"16px"})}),w.jsx(He,{type:"button",onClick:()=>k("deepl"),children:w.jsx(wn,{size:"18px"})}),w.jsx(Wr,{children:w.jsx($n,{size:"16px"})})]}),w.jsx(wt,{...C,name:"caption",ref:x=>{m(x),l.current=x}})]})};Xe.propTypes={el:I.object,setIsForm:I.func,setRecording:I.func,setTranslation:I.func};const{button:Vr}=q.shadows,{m:Ur,xl:Kr}=q.indents,Gt=({className:e})=>{const{user:n}=ue(),[t,p]=N.useState(!1),{activeCluster:s}=ie(),[l,r]=N.useState(""),[c,b]=N.useState(""),{transcript:E,listening:T,resetTranscript:y}=ye.useSpeechRecognition(),{isMicrophoneAvailable:$}=ye.useSpeechRecognition(),{browserSupportsSpeechRecognition:d}=ye.useSpeechRecognition(),R=l.endsWith(", ")||l.replace(/[a-z]$/,"*#").endsWith("*#")?E.replace(/^./,S=>` ${S}`):E.replace(/^./,S=>S.toUpperCase()),A=`${l}${R}`,f=Gn(A,Xn),g=(S,u)=>S.trim().endsWith(u)?`${S.trim()} `:`${S.trim()}${u} `;if(N.useEffect(()=>{if(!T||!t)return;const S=[".","?","!",","],u=i=>{if(S.includes(i.key)){i.preventDefault();const m=g(f,i.key);r(m),y()}if(i.key==="Backspace"){i.preventDefault();const m=f.length-1,C=f.substring(0,m);r(C),y()}if(i.key==="Space"){i.preventDefault();const m=f+" ";r(m),y()}};return addEventListener("keydown",u),()=>{removeEventListener("keydown",u)}},[t,T,f,y]),N.useEffect(()=>{const S=async u=>{const i=u.key==="F2"||u.key==="r"&&u.metaKey&&!u.altKey&&!u.shiftKey;if(T||i&&(u.preventDefault(),p(!0),be.startListening({language:s.lang,continuous:!0})),T&&i){u.preventDefault(),be.stopListening();const m=f.at(-1),C=!m||["!"].includes(m)?f:g(f,"."),M=await we(C,{from:s.lang,to:n.lang},n.engine);r(C),b(M),y()}};return addEventListener("keydown",S),()=>{removeEventListener("keydown",S)}},[s.lang,t,T,f,y,n.engine,n.lang]),N.useEffect(()=>{const S=async u=>{if(u.key==="Escape"||u.key==="Enter"||u.key==="F1"){u.preventDefault(),be.stopListening(),p(!1),r(""),b(""),y();return}};return addEventListener("keyup",S),()=>{removeEventListener("keyup",S)}},[y]),!d||!$)return;const h=async S=>{if(S==null||S.currentTarget.blur(),!T)p(!0),be.startListening({language:s.lang,continuous:!0});else{be.stopListening();const u=f.at(-1),i=!u||["!"].includes(u)?f:g(f,"."),m={from:s.lang,to:n.lang},C=await we(i,m,n.engine);r(i),b(C),y()}};return w.jsxs("div",{className:_r(e,"speak-btn",!t&&"hidden"),children:[w.jsx(pe,{onClick:h,$s:"m",$round:!0,$bs:Vr,children:T?w.jsx(Tn,{size:18}):w.jsx(Sn,{size:18})}),t&&w.jsx(Rn,{$x:`left: ${Ur}`,$y:`top: ${Kr}`,$bd:"none",children:w.jsx(Xe,{el:{cluster:s._id,element:f.trim(),caption:c.trim(),favorite:!0,checked:f.split(/\s+/).length<20},setIsForm:p,setRecording:r,setTranslation:b})})]})};Gt.propTypes={className:I.string};const{colors:We}=q,Hr=W.div`
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  &:hover svg {
    stroke: ${We.yellow};
  }

  & svg {
    transition: stroke 250ms;
    stroke: ${We.hovered};
    /* stroke: ${({$colored:e})=>e&&We.yellow}; */
    @keyframes refresh-spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(-360deg);
      }
    }
    animation: refresh-spin infinite 12s linear;
  }
`,Vt=({onClick:e})=>w.jsx(Hr,{onClick:e,children:w.jsx(kn,{size:"35px"})});Vt.propTypes={onClick:I.func};const{background:Fe}=q.colors,{button:Tt}=q.shadows,{s:Rt,m:qr}=q.indents,Ut=({className:e,filtredElements:n,setLiColor:t})=>{const{user:p}=ue(),{activeCluster:s}=ie(),{activeElement:l}=fe(),[r,c]=N.useState(null);if(N.useEffect(()=>{const f=window.speechSynthesis.getVoices();Array.isArray(f)&&f.length>0&&c(f),"onvoiceschanged"in window.speechSynthesis&&(window.speechSynthesis.onvoiceschanged=()=>{const g=window.speechSynthesis.getVoices();c(g)})},[]),!Array.isArray(r)||r.length===0)return;const b=f=>{if(!f.length)return;let g="",h=0;const S=f.reduce((u,i)=>(u[i.lang]||(u[i.lang]=0),u[i.lang]+=1,u),{});for(const u in S)S[u]>h&&(h=S[u],g=u);return g},E=n.length?b(n):p.lang,T=(f,g)=>f.replaceAll(", `",`;${g} `).replaceAll(" `",`${g} `).replaceAll(",`",";"),y=({text:f,playList:g,divider:h})=>{let S="";for(let u=0;u<g.length;u+=1){let i=g[u][f];const m=`@±@${g[u].lang}${h}`;i.endsWith(".")||i.endsWith("!")||i.endsWith("?")||i.endsWith('"')?(S+=T(i,h).replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",f!=="caption"?`__${h}`:`__${m}`).replaceAll(".",f!=="caption"?`.${h}`:`.${m}`).replaceAll(",",f!=="caption"?`,${h}`:`,${m}`).replaceAll("!",f!=="caption"?`!${h}`:`!${m}`).replaceAll("?",f!=="caption"?`?${h}`:`?${m}`).replaceAll(":",f!=="caption"?`:${h}`:`:${m}`),s.lang.includes("de")&&(S=S.replaceAll(`0.${h}`,"0.").replaceAll(`1.${h}`,"1.").replaceAll(`2.${h}`,"2.").replaceAll(`3.${h}`,"3.").replaceAll(`4.${h}`,"4.").replaceAll(`5.${h}`,"5.").replaceAll(`6.${h}`,"6.").replaceAll(`7.${h}`,"7.").replaceAll(`8.${h}`,"8.").replaceAll(`9.${h}`,"9."))):g[u].element.startsWith("[")||(f==="caption"&&(i.includes(" [")&&(i=i.substring(0,i.indexOf(" ["))),i=`${i}@±@${g[u].lang}`),S+=i+h)}return S},$=r,d=f=>{f.currentTarget.blur(),t(Fe);const g="$*@",h=n.findIndex(i=>i.element===l.element),S=n.splice(h===-1?0:h),u=Me({setLiColor:t,divider:g,voices:$,text:y({text:"element",playList:S,divider:g}),lang:s.lang,rate:s.rate});u&&ne.error(u)},R=f=>{f.currentTarget.blur();const g="$*@";t(Fe);const h=n.findIndex(i=>i.element===l.element),S=n.splice(h===-1?0:h),u=Me({setLiColor:t,divider:g,voices:$,text:y({text:"caption",playList:S,divider:g}),lang:E,rate:p.rate});u&&ne.error(u)},A=f=>{f.currentTarget.blur(),t(Fe);let g="";const h="$*@",S=n.findIndex(m=>m.element===l.element),u=n.splice(S===-1?0:S);for(let m=0;m<u.length;m+=1){const{element:C,caption:M,lang:F}=u[m];if(!C.startsWith("[")){const B=T(C,""),J=M.includes(" [")?M.substring(0,M.indexOf(" [")):T(M,"");g+=B+`@±@${F}`+J+h}}const i=An({setLiColor:t,divider:h,voices:$,text:g,lang:s.lang,rate:p.rate});i&&ne.error(i)};return w.jsxs(qe,{className:e,$m:`${Rt} ${qr}`,$pos:"fixed",$side:"right",$high:"bottom",$gtc:"1fr 0.5fr 1fr",$cg:Rt,children:[w.jsx(pe,{onClick:d,$s:"m",$round:!0,$bs:Tt,children:(s==null?void 0:s.lang.at(0).toUpperCase())+(s==null?void 0:s.lang.substring(1))}),w.jsx(Vt,{onClick:A}),w.jsx(pe,{onClick:R,$s:"m",$round:!0,$bs:Tt,children:(E==null?void 0:E.at(0).toUpperCase())+(E==null?void 0:E.substring(1))})]})};Ut.propTypes={className:I.string,filtredElements:I.array,setLiColor:I.func};const Kt=({el:e,sortByDate:n,setSortByDate:t,setLiColor:p})=>{var S,u;const s=le(),{user:l}=ue(),{activeCluster:r}=ie(),[c,b]=N.useState(),E="$*@",T=(i,m)=>{let C="";return m?(i.trim().endsWith(".")||i.trim().endsWith("!")||i.trim().endsWith("?")||i.endsWith('"')?(C=i.trim().replaceAll(", `",`;${m} `).replaceAll(" `",`${m} `).replaceAll(",`",";").replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",`__${m}`).replaceAll(".",`.${m}`).replaceAll(",",`,${m}`).replaceAll("!",`!${m}`).replaceAll("?",`?${m}`).replaceAll(":",`:${m}`),r.lang.includes("de")&&(C=C.replaceAll(`0.${m}`,"0.").replaceAll(`1.${m}`,"1.").replaceAll(`2.${m}`,"2.").replaceAll(`3.${m}`,"3.").replaceAll(`4.${m}`,"4.").replaceAll(`5.${m}`,"5.").replaceAll(`6.${m}`,"6.").replaceAll(`7.${m}`,"7.").replaceAll(`8.${m}`,"8.").replaceAll(`9.${m}`,"9."))):C=i.trim()+m,C.includes("[")?C.substring(0,C.indexOf("["))+m:C):i},y=i=>{i.currentTarget.blur();const m=Me({setLiColor:p,divider:E,voices:window.speechSynthesis.getVoices(),text:T(e.element,E),lang:r.lang,rate:r.rate});m&&ne.error(m)},$=i=>{i.currentTarget.blur();const m=Me({setLiColor:p,divider:E,voices:window.speechSynthesis.getVoices(),text:T(e.caption,E),lang:e.lang,rate:l.rate});m&&ne.error(m)},d=i=>{t(!n),n?ne.success("Below is Recent"):ne.success("Above is Recent"),i.stopPropagation()},R=i=>{const{_id:m}=r;s(_t(e)),i.currentTarget.closest("li").id!=="active-element"&&s(Ge({_id:m,activeEl:e._id}))},A=Cn(e.caption),f=En({onSuccess:i=>{const{access_token:m,expires_in:C}=i,M={accessToken:m,expiresIn:C*1e3+Date.now()};s(xn(M))},onError:i=>ne(i.message)}),g=async i=>{const m=await _n.get(A.file,{responseType:"blob",headers:{Authorization:`Bearer ${i}`}}).then(M=>M.data),C=URL.createObjectURL(m);b(C)},h=Date.now()<((S=l==null?void 0:l.googleToken)==null?void 0:S.expiresIn);return w.jsx(w.Fragment,{children:w.jsxs(zr,{onClick:R,children:[w.jsx($t,{onClick:y,children:e.element}),w.jsx(Ir,{onClick:e.element.startsWith("[")?h?()=>g(l.googleToken.accessToken):()=>f():d}),A.text&&w.jsx($t,{onClick:$,children:A.text}),(!c||!h)&&A.link&&w.jsx(Gr,{src:A.link}),((u=A==null?void 0:A.link)==null?void 0:u.endsWith(".mp3"))&&w.jsx(St,{onPause:i=>i.target.blur(),onEnded:i=>i.target.blur(),src:A.link,controls:!0}),c&&h&&w.jsx(St,{onPause:i=>i.target.blur(),onEnded:i=>i.target.blur(),src:c,controls:!0})]})})};Kt.propTypes={el:I.object,sortByDate:I.bool,setSortByDate:I.func,$active:I.bool,$hovered:I.bool,setLiColor:I.func};const Ht=({el:e,index:n,length:t,sortByDate:p,setSortByDate:s,translateAll:l,liColor:r,setLiColor:c})=>{const b=le(),{elementTrash:E,activeElement:T}=fe(),[y,$]=N.useState(!1),{_id:d,favorite:R,checked:A}=e,f=E.find(m=>m._id===d),g=()=>{b(Pe({_id:d,favorite:!R}))},h=()=>{b(Pe({_id:d,checked:!A}))},S=()=>b(On(e)),u=()=>$(!y),i=d===(T==null?void 0:T._id);return w.jsxs(jr,{id:i?"active-element":null,licolor:r,children:[w.jsxs(Ve,{$h:"100%",$p:"0",$fd:"column",children:[w.jsxs(Pr,{$hovered:R,children:[w.jsx("input",{type:"checkbox",name:"favorite",checked:R,onChange:g}),w.jsx(In,{size:"20px"})]}),w.jsxs(Mr,{$hovered:A,children:[w.jsx("input",{type:"checkbox",name:"checked",checked:A,onChange:h}),w.jsx(Ln,{size:"15px"})]}),y&&t===n+1&&w.jsx(He,{onClick:l,children:w.jsx(jn,{size:"16px"})})]}),y&&w.jsx(Xe,{el:e,setIsForm:$}),!y&&w.jsx(Kt,{el:e,sortByDate:p,setSortByDate:s,setLiColor:c}),w.jsxs(Ve,{$h:"100%",$p:"0",$fd:"column",children:[w.jsx(Or,{$hovered:f,onClick:S,children:w.jsx(Pn,{size:"16px"})}),w.jsx(Dr,{onClick:u,children:w.jsx(Mn,{size:"15px"})})]})]})};Ht.propTypes={el:I.object,index:I.number,length:I.number,sortByDate:I.bool,setSortByDate:I.func,translateAll:I.func,liColor:I.string,setLiColor:I.func};const Yr=W.ul`
  width: 100%;
  list-style: none;
`,Qr=W.div`
  & .speak-btn {
    position: fixed;
    bottom: ${q.indents.s};
    left: calc(45% + 10px);
    /* transform: translateX(calc(-50%)); */
  }

  & .hidden {
    opacity: 0;
    transition: opacity 150ms;
    &:hover {
      opacity: 1;
    }
    & button {
      transition: color 750ms, border-color 750ms, background-color 750ms;
    }
  }
`,{white:Xr}=q.colors,Zr=()=>{const e=le(),{ref:n,inView:t,entry:p}=rr({initialInView:!0,rootMargin:"0px 0px -30px 0px"}),{user:s}=ue(),{activeCluster:l}=ie(),{allElements:r,elementTrash:c,elementFilter:b,isLoading:E}=fe(),[T,y]=N.useState(Xr);let{elementSelect:$}=fe();$=$||[];const[d,R]=N.useState(!1);N.useEffect(()=>{l&&e(xt({cluster:l._id})).unwrap().then(({result:u})=>{if(!l.activeEl)return;const i=u.elements.find(({_id:m})=>m===l.activeEl);e(_t(i))}).then(()=>{const u=document.getElementById("active-element");u&&Dn(u)})},[]);const A=r.filter(u=>u.cluster===(l==null?void 0:l._id)).sort((u,i)=>u.createdAt.localeCompare(i.createdAt)),g=(()=>{const u=c.map(i=>i._id);return $.includes("trash")?A.filter(i=>u.includes(i._id)):A})().filter(({element:u,caption:i,favorite:m,checked:C})=>{const M=u.toLowerCase().replace("·","").includes(b)||u.toLowerCase().includes(b)||i.toLowerCase().includes(b),F=$.includes("wordlist")?M&&Vn(u):M,B=()=>$.some(k=>["favorite","unfavorite"].includes(k))?$.includes("favorite")?F&&m===!0:F&&m===!1:F;return(()=>$.some(k=>["checked","unchecked"].includes(k))?$.includes("checked")?B()&&C===!0:B()&&C===!1:B())()}).sort(d?(u,i)=>i.createdAt.localeCompare(u.createdAt):(u,i)=>u.createdAt.localeCompare(i.createdAt)),h=async()=>{const u=s.lang;let i=0;await g.forEach(async m=>{if(i>1)return;const{_id:C,element:M}=m;if(!M.startsWith("[")||u!==m.lang){const F={from:l.lang,to:u},B=await we(M,F,s.engine);e(Pe({_id:C,lang:u,caption:B})),i=i+1}})},S=window.innerHeight<(p==null?void 0:p.target.getBoundingClientRect().y)+(p==null?void 0:p.target.getBoundingClientRect().height)*1.5;return w.jsxs(w.Fragment,{children:[w.jsxs(Yr,{children:[g.map((u,i,m)=>w.jsx(Ht,{el:u,index:i,length:m.length,sortByDate:d,setSortByDate:R,translateAll:h,liColor:T,setLiColor:y},u._id)),w.jsxs(Qr,{ref:n,children:[w.jsx(Pt,{}),w.jsx(Gt,{className:!t||!S?"shown":"hidden"}),w.jsx(Mt,{className:!t||!S?"shown":"hidden"}),w.jsx(Ut,{className:!t||!S?"shown":"hidden",filtredElements:g,setLiColor:y})]})]}),E&&w.jsx(zn,{})]})},{s:kt,m:Jr}=q.indents,si=()=>w.jsx(Ve,{$p:`0 ${Jr} ${kt} ${kt}`,children:w.jsx(Zr,{})});export{si as default};
