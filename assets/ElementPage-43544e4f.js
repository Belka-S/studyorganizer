import{U as Ne,r as I,t as Y,P as N,u as le,b as ue,q as ie,j as w,T as He,V as Ae,x as Ve,E as dt,H as gt,w as pe,S as ln,W as Rt,X as At,Q as re,z as fe,Y as un,Z as pn,G as fn,i as hn,n as $e,s as W,_ as dn,$ as gn,a0 as mn,a1 as je,a2 as Ct,a3 as vn,a4 as bn,M as yn,a5 as wn,a6 as $n,a7 as Pe,a8 as Sn,a9 as mt,aa as kt,F as Ge,D as Tn,ab as Rn,C as An,A as Cn,ac as kn,N as En,ad as _n}from"./index-6bb02b7d.js";import{r as Et,H as Ln,T as xn}from"./index-99446b39.js";import{w as _t}from"./writeClipboard-05f867b9.js";import{v as jn,u as Pn}from"./index.esm-b84bef9a.js";import{a as Mn}from"./index-65da7604.js";const Ke=(e,n)=>{if(!n.includes("de"))return e;const t=e.trim().split(`
`);return t.length===1?e:["der","die","das"].includes(t[0].split(" ")[0])?`${t[0].trim()}, ${t[1].split("·")[1].replaceAll("⁰","").replaceAll("/"," / ").trim()}`:(e.includes("hat")||e.includes("ist"))&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e.includes("am")&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e},On=(e,n)=>{let t=e;for(const i in n)t=t.replaceAll(i,n[i]);const f=i=>i.replace(/^./,o=>o.toUpperCase()),l=[...t.split(/\s+/)];for(let i=0;i<l.length;i+=1)[".","!","?"].includes(l[i].at(-1))&&l[i+1]&&l.splice(i+1,1,f(l[i+1]));return l.join(" ")},Dn=e=>/[a-z]/.test(e.charAt(0)),{VITE_DEEPL_API_KEY:zn}={VITE_GOOGLE_CLIENT_ID:"689266183428-lh3lmpaqnd2qd6t93voa8s6ipt3836q1.apps.googleusercontent.com",VITE_DEEPL_API_KEY:"d15bf272-fb1f-4f29-bbc3-d3bbdd686c53:fx",VITE_GOOGLE_API_KEY:"AIzaSyDqQndBxYEuOG7F6iYDqQoiNF90tptRmBQ",VITE_PROD_BACK_URL:"https://studyorganizer.onrender.com",BASE_URL:"/studyorganizer/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},In={google:"",deepl:zn},we=async(e,{from:n,to:t},f)=>{var p,i;if(!e||e.length===0)return"";const l=e.replaceAll(" ·",",").replaceAll("·","");Ne.engine=f,Ne.key=In[f];try{let o=await Ne(`${l}`,{from:n,to:t});if(t.includes("en")&&l.toLowerCase().includes("uhr")&&(o=o.replaceAll("a.m. on","am on").replaceAll("p.m. on","pm on").replaceAll("a.m. to","am to").replaceAll("p.m. to","pm to").replaceAll("a.m.","am.").replaceAll("p.m.","pm.")),[".","!","?"].includes(l.at(-1)))return o;const C=l.split(l.includes(", ")?", ":/\s+/),$=o.split(", "),S=t.includes("de")?$[0]:$[0].at(0).toLowerCase()+$[0].substring(1);return C.length===1?o.toLocaleLowerCase()+", ":["der","die","das"].includes(C[0].split(" ")[0])?o.replace("The ","").replace("the ","").split(", ")[0].toLocaleLowerCase()+", ":t.includes("en")&&((p=C[2])!=null&&p.startsWith("am"))?$[2].startsWith("the")?o:`${S}, ${$[1]}, the ${$[2]}`:(C[0].endsWith("n")&&["hat","ist"].includes((i=C[2])==null?void 0:i.split(" ")[0])&&n.includes("de")&&(o=t.includes("en")?"to "+S+", ":S+", "),o)}catch(o){return o.message}},Me=(e,n)=>e.endsWith(n)?e.substring(0,e.length-1):e,Nn=(e,n)=>{let t=84;e[0]&&(t=Number(e[0].style.height.replace("px",""))),I.useEffect(()=>{if(!e[0])return;let f=Math.max(...e.map(l=>l.scrollHeight));t!==f&&(f=f<=90?f:f+6,e.forEach(l=>{l.style.height=f+"px"}))},[t,e,n])},Ce=[{value:"de",label:"German"},{value:"en",label:"English"},{value:"uk",label:"Ukrainian"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"it",label:"Italian"}],ke=[{value:.3,label:"Rate: 0.3"},{value:.4,label:"Rate: 0.4"},{value:.5,label:"Rate: 0.5"},{value:.6,label:"Rate: 0.6"},{value:.8,label:"Rate: 0.8"},{value:1,label:"Rate: 1"},{value:1.25,label:"Rate: 1.25"},{value:1.5,label:"Rate: 1.5"}],Bn={"..":".",". .":".","?.":"?","? .":"?","!.":"!","! .":"!",",,":",",", ,":","},Wn={" Dot":"."," dot":"."," exclamation mark":"!"," question mark":"?"," comma":","," colon":":"," semi-colon":";","Yes ":"Yes, ","No ":"No, "},Fn={" Punkt":"."," Ausrufezeichen":"!"," Fragezeichen":"?"," Komma":","," Doppelpunkt":":"," Semikolon":";","Ja ":"Ja, ","Nein ":"Nein, "," weil":", weil"," aber":", aber"," als":", als"," ob":", ob"," damit":", damit"," bevor":", bevor"," obwohl":", obwohl"," dass":", dass"," dann":", dann"," deshalb":", deshalb"," desvegen":", desvegen"," trotzdem":", trotzdem"},Vn={...Wn,...Fn,...Bn};var Ue=new Map,Ee=new WeakMap,vt=0,Gn=void 0;function Kn(e){return e?(Ee.has(e)||(vt+=1,Ee.set(e,vt.toString())),Ee.get(e)):"0"}function Un(e){return Object.keys(e).sort().filter(n=>e[n]!==void 0).map(n=>`${n}_${n==="root"?Kn(e.root):e[n]}`).toString()}function qn(e){const n=Un(e);let t=Ue.get(n);if(!t){const f=new Map;let l;const p=new IntersectionObserver(i=>{i.forEach(o=>{var m;const C=o.isIntersecting&&l.some($=>o.intersectionRatio>=$);e.trackVisibility&&typeof o.isVisible>"u"&&(o.isVisible=C),(m=f.get(o.target))==null||m.forEach($=>{$(C,o)})})},e);l=p.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),t={id:n,observer:p,elements:f},Ue.set(n,t)}return t}function Hn(e,n,t={},f=Gn){if(typeof window.IntersectionObserver>"u"&&f!==void 0){const m=e.getBoundingClientRect();return n(f,{isIntersecting:f,target:e,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:m,intersectionRect:m,rootBounds:m}),()=>{}}const{id:l,observer:p,elements:i}=qn(t),o=i.get(e)||[];return i.has(e)||i.set(e,o),o.push(n),p.observe(e),function(){o.splice(o.indexOf(n),1),o.length===0&&(i.delete(e),p.unobserve(e)),i.size===0&&(p.disconnect(),Ue.delete(l))}}function Yn({threshold:e,delay:n,trackVisibility:t,rootMargin:f,root:l,triggerOnce:p,skip:i,initialInView:o,fallbackInView:m,onChange:C}={}){var $;const[S,y]=I.useState(null),h=I.useRef(C),[T,R]=I.useState({inView:!!o,entry:void 0});h.current=C,I.useEffect(()=>{if(i||!S)return;let c;return c=Hn(S,(u,b)=>{R({inView:u,entry:b}),h.current&&h.current(u,b),b.isIntersecting&&p&&c&&(c(),c=void 0)},{root:l,rootMargin:f,threshold:e,trackVisibility:t,delay:n},m),()=>{c&&c()}},[Array.isArray(e)?e.toString():e,S,l,f,p,i,t,m,n]);const v=($=T.entry)==null?void 0:$.target,d=I.useRef(void 0);!S&&v&&!p&&!i&&d.current!==v&&(d.current=v,R({inView:!!o,entry:void 0}));const r=[y,T.inView,T.entry];return r.ref=r[0],r.inView=r[1],r.entry=r[2],r}const{backgroundHoverd:_e,white:Le,borderLight:xe}=Y.colors,Lt=()=>{const e=le(),{user:n}=ue(),{activeCluster:t}=ie(),f=({value:o})=>{e(Ve({_id:t._id,lang:o})).unwrap().then(m=>e(dt(m.result.cluster)))},l=({value:o})=>{e(Ve({_id:t._id,rate:o})).unwrap().then(m=>e(dt(m.result.cluster)))},p=({value:o})=>{const m=new FormData;m.append("lang",o),e(gt(m))},i=({value:o})=>{const m=new FormData;m.append("rate",o),e(gt(m))};return w.jsxs(He,{$m:"0",$cg:"8px",$ai:"center",$gtc:"2fr 2fr 2fr 2fr",children:[w.jsx(Ae,{options:Ce,defaultValue:Ce.find(o=>o.value===(t==null?void 0:t.lang)),onChange:f,placeholder:"Language...",$ol:_e,$b:Le,$bh:xe}),w.jsx(Ae,{options:ke,defaultValue:ke.find(o=>o.value==(t==null?void 0:t.rate)),onChange:l,placeholder:"Rate...",$ol:_e,$b:Le,$bh:xe}),w.jsx(Ae,{options:Ce,defaultValue:Ce.find(o=>o.value===n.lang),onChange:p,placeholder:"Language...",$ol:_e,$b:Le,$bh:xe}),w.jsx(Ae,{options:ke,defaultValue:ke.find(o=>o.value==n.rate),onChange:i,placeholder:"Rate...",$ol:_e,$b:Le,$bh:xe})]})};Lt.propTypes={filtredElements:N.array,setLiColor:N.func};const{button:Qn}=Y.shadows,Zn=()=>{const e=le(),{user:n}=ue(),{activeCluster:t}=ie();I.useEffect(()=>{const l=async p=>{p.key==="e"&&p.metaKey&&!p.altKey&&!p.shiftKey&&(p.preventDefault(),await f())};return addEventListener("keydown",l),()=>{removeEventListener("keydown",l)}},[]);const f=async l=>{const p=window.getSelection().toString();p&&await _t(p);const i=await Et();let o=Ke(i,t.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();o=Me(o,",");const m={from:t.lang,to:n.lang};let C=await we(o,m,n.engine);C=Me(C.trim(),",");const{_id:$}=t;try{const S={cluster:$,element:"[]",caption:o},y={cluster:$,element:o,caption:C,favorite:!0,checked:o.split(/\s+/).length<20},h=o.includes("https://")?S:y;e(Rt(h)).unwrap().then(()=>(l==null?void 0:l.target)&&At()).finally(()=>{var T;return(T=l==null?void 0:l.target)==null?void 0:T.blur()})}catch(S){l==null||l.currentTarget.blur(),re.error(`Invalid element, ${S.message}`)}};return w.jsx(pe,{onClick:f,$s:"m",$round:!0,$bs:Qn,children:w.jsx(ln,{size:18})})},{button:Jn}=Y.shadows,Xn=()=>{const e=le(),{elementTrash:n}=fe(),t=()=>{confirm("Are you sure you want to delete the selected Element(s)?")&&e(un(n.map(f=>f._id).join("&"))).unwrap().then(()=>e(pn()))};return w.jsx(pe,{onClick:t,$s:"m",$round:!0,$bs:Jn,children:w.jsx(Ln,{size:16})})};function er(e){return fn({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M250.73,210.63l-56-112a12,12,0,0,0-21.46,0l-20.52,41A84.2,84.2,0,0,1,114,126.22,107.48,107.48,0,0,0,139.33,68H160a12,12,0,0,0,0-24H108V32a12,12,0,0,0-24,0V44H32a12,12,0,0,0,0,24h83.13A83.69,83.69,0,0,1,96,110.35,84,84,0,0,1,83.6,91a12,12,0,1,0-21.81,10A107.55,107.55,0,0,0,78,126.24,83.54,83.54,0,0,1,32,140a12,12,0,0,0,0,24,107.47,107.47,0,0,0,64-21.07,108.4,108.4,0,0,0,45.39,19.44l-24.13,48.26a12,12,0,1,0,21.46,10.73L151.41,196h65.17l12.68,25.36a12,12,0,1,0,21.47-10.73ZM163.41,172,184,130.83,204.58,172Z"},child:[]}]})(e)}const{button:tr}=Y.shadows,nr=()=>{const{activeCluster:e}=ie();I.useEffect(()=>{const p=async i=>{i.metaKey&&i.key==="d"&&!i.altKey&&!i.shiftKey&&(i.preventDefault(),await l())};return addEventListener("keydown",p),()=>{removeEventListener("keydown",p)}},[]);let n=[];function t(p){p.forEach(i=>{const o=window.open(i,"_blank");o?n.push(o):re.error(`Failed to open tab: ${i}`)})}const f=()=>{n.forEach(p=>{p.close()}),n=[]},l=async()=>{const p=window.getSelection().toString();p&&await _t(p);const i=await Et();let o=[];e.lang.includes("de")&&o.push(`https://www.verbformen.com/conjugation/?w=${i}`),e.lang.includes("en")&&o.push(`https://dictionary.cambridge.org/dictionary/english-russian/${i}`),f(),t(o)};return w.jsx(pe,{onClick:l,$s:"m",$round:!0,$bs:tr,children:w.jsx(er,{size:18})})};var rr={exports:{}};(function(e){var n=function(t){var f=Object.prototype,l=f.hasOwnProperty,p=Object.defineProperty||function(s,a,g){s[a]=g.value},i,o=typeof Symbol=="function"?Symbol:{},m=o.iterator||"@@iterator",C=o.asyncIterator||"@@asyncIterator",$=o.toStringTag||"@@toStringTag";function S(s,a,g){return Object.defineProperty(s,a,{value:g,enumerable:!0,configurable:!0,writable:!0}),s[a]}try{S({},"")}catch{S=function(a,g,L){return a[g]=L}}function y(s,a,g,L){var _=a&&a.prototype instanceof c?a:c,O=Object.create(_.prototype),U=new D(L||[]);return p(O,"_invoke",{value:A(s,g,U)}),O}t.wrap=y;function h(s,a,g){try{return{type:"normal",arg:s.call(a,g)}}catch(L){return{type:"throw",arg:L}}}var T="suspendedStart",R="suspendedYield",v="executing",d="completed",r={};function c(){}function u(){}function b(){}var x={};S(x,m,function(){return this});var P=Object.getPrototypeOf,z=P&&P(P(M([])));z&&z!==f&&l.call(z,m)&&(x=z);var F=b.prototype=c.prototype=Object.create(x);u.prototype=b,p(F,"constructor",{value:b,configurable:!0}),p(b,"constructor",{value:u,configurable:!0}),u.displayName=S(b,$,"GeneratorFunction");function B(s){["next","throw","return"].forEach(function(a){S(s,a,function(g){return this._invoke(a,g)})})}t.isGeneratorFunction=function(s){var a=typeof s=="function"&&s.constructor;return a?a===u||(a.displayName||a.name)==="GeneratorFunction":!1},t.mark=function(s){return Object.setPrototypeOf?Object.setPrototypeOf(s,b):(s.__proto__=b,S(s,$,"GeneratorFunction")),s.prototype=Object.create(F),s},t.awrap=function(s){return{__await:s}};function X(s,a){function g(O,U,q,Q){var K=h(s[O],s,U);if(K.type==="throw")Q(K.arg);else{var ge=K.arg,ae=ge.value;return ae&&typeof ae=="object"&&l.call(ae,"__await")?a.resolve(ae.__await).then(function(ne){g("next",ne,q,Q)},function(ne){g("throw",ne,q,Q)}):a.resolve(ae).then(function(ne){ge.value=ne,q(ge)},function(ne){return g("throw",ne,q,Q)})}}var L;function _(O,U){function q(){return new a(function(Q,K){g(O,U,Q,K)})}return L=L?L.then(q,q):q()}p(this,"_invoke",{value:_})}B(X.prototype),S(X.prototype,C,function(){return this}),t.AsyncIterator=X,t.async=function(s,a,g,L,_){_===void 0&&(_=Promise);var O=new X(y(s,a,g,L),_);return t.isGeneratorFunction(a)?O:O.next().then(function(U){return U.done?U.value:O.next()})};function A(s,a,g){var L=T;return function(O,U){if(L===v)throw new Error("Generator is already running");if(L===d){if(O==="throw")throw U;return V()}for(g.method=O,g.arg=U;;){var q=g.delegate;if(q){var Q=k(q,g);if(Q){if(Q===r)continue;return Q}}if(g.method==="next")g.sent=g._sent=g.arg;else if(g.method==="throw"){if(L===T)throw L=d,g.arg;g.dispatchException(g.arg)}else g.method==="return"&&g.abrupt("return",g.arg);L=v;var K=h(s,a,g);if(K.type==="normal"){if(L=g.done?d:R,K.arg===r)continue;return{value:K.arg,done:g.done}}else K.type==="throw"&&(L=d,g.method="throw",g.arg=K.arg)}}}function k(s,a){var g=a.method,L=s.iterator[g];if(L===i)return a.delegate=null,g==="throw"&&s.iterator.return&&(a.method="return",a.arg=i,k(s,a),a.method==="throw")||g!=="return"&&(a.method="throw",a.arg=new TypeError("The iterator does not provide a '"+g+"' method")),r;var _=h(L,s.iterator,a.arg);if(_.type==="throw")return a.method="throw",a.arg=_.arg,a.delegate=null,r;var O=_.arg;if(!O)return a.method="throw",a.arg=new TypeError("iterator result is not an object"),a.delegate=null,r;if(O.done)a[s.resultName]=O.value,a.next=s.nextLoc,a.method!=="return"&&(a.method="next",a.arg=i);else return O;return a.delegate=null,r}B(F),S(F,$,"Generator"),S(F,m,function(){return this}),S(F,"toString",function(){return"[object Generator]"});function E(s){var a={tryLoc:s[0]};1 in s&&(a.catchLoc=s[1]),2 in s&&(a.finallyLoc=s[2],a.afterLoc=s[3]),this.tryEntries.push(a)}function j(s){var a=s.completion||{};a.type="normal",delete a.arg,s.completion=a}function D(s){this.tryEntries=[{tryLoc:"root"}],s.forEach(E,this),this.reset(!0)}t.keys=function(s){var a=Object(s),g=[];for(var L in a)g.push(L);return g.reverse(),function _(){for(;g.length;){var O=g.pop();if(O in a)return _.value=O,_.done=!1,_}return _.done=!0,_}};function M(s){if(s!=null){var a=s[m];if(a)return a.call(s);if(typeof s.next=="function")return s;if(!isNaN(s.length)){var g=-1,L=function _(){for(;++g<s.length;)if(l.call(s,g))return _.value=s[g],_.done=!1,_;return _.value=i,_.done=!0,_};return L.next=L}}throw new TypeError(typeof s+" is not iterable")}t.values=M;function V(){return{value:i,done:!0}}return D.prototype={constructor:D,reset:function(s){if(this.prev=0,this.next=0,this.sent=this._sent=i,this.done=!1,this.delegate=null,this.method="next",this.arg=i,this.tryEntries.forEach(j),!s)for(var a in this)a.charAt(0)==="t"&&l.call(this,a)&&!isNaN(+a.slice(1))&&(this[a]=i)},stop:function(){this.done=!0;var s=this.tryEntries[0],a=s.completion;if(a.type==="throw")throw a.arg;return this.rval},dispatchException:function(s){if(this.done)throw s;var a=this;function g(Q,K){return O.type="throw",O.arg=s,a.next=Q,K&&(a.method="next",a.arg=i),!!K}for(var L=this.tryEntries.length-1;L>=0;--L){var _=this.tryEntries[L],O=_.completion;if(_.tryLoc==="root")return g("end");if(_.tryLoc<=this.prev){var U=l.call(_,"catchLoc"),q=l.call(_,"finallyLoc");if(U&&q){if(this.prev<_.catchLoc)return g(_.catchLoc,!0);if(this.prev<_.finallyLoc)return g(_.finallyLoc)}else if(U){if(this.prev<_.catchLoc)return g(_.catchLoc,!0)}else if(q){if(this.prev<_.finallyLoc)return g(_.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(s,a){for(var g=this.tryEntries.length-1;g>=0;--g){var L=this.tryEntries[g];if(L.tryLoc<=this.prev&&l.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var _=L;break}}_&&(s==="break"||s==="continue")&&_.tryLoc<=a&&a<=_.finallyLoc&&(_=null);var O=_?_.completion:{};return O.type=s,O.arg=a,_?(this.method="next",this.next=_.finallyLoc,r):this.complete(O)},complete:function(s,a){if(s.type==="throw")throw s.arg;return s.type==="break"||s.type==="continue"?this.next=s.arg:s.type==="return"?(this.rval=this.arg=s.arg,this.method="return",this.next="end"):s.type==="normal"&&a&&(this.next=a),r},finish:function(s){for(var a=this.tryEntries.length-1;a>=0;--a){var g=this.tryEntries[a];if(g.finallyLoc===s)return this.complete(g.completion,g.afterLoc),j(g),r}},catch:function(s){for(var a=this.tryEntries.length-1;a>=0;--a){var g=this.tryEntries[a];if(g.tryLoc===s){var L=g.completion;if(L.type==="throw"){var _=L.arg;j(g)}return _}}throw new Error("illegal catch attempt")},delegateYield:function(s,a,g){return this.delegate={iterator:M(s),resultName:a,nextLoc:g},this.method==="next"&&(this.arg=i),r}},t}(e.exports);try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})(rr);var ye={},xt={},Z={};Object.defineProperty(Z,"__esModule",{value:!0});Z.browserSupportsPolyfills=Z.compareTwoStringsUsingDiceCoefficient=Z.commandToRegExp=Z.concatTranscripts=Z.debounce=void 0;var ir=function(n,t,f){var l;return function(){var p=this,i=arguments,o=function(){l=null,f||n.apply(p,i)},m=f&&!l;clearTimeout(l),l=setTimeout(o,t),m&&n.apply(p,i)}};Z.debounce=ir;var sr=function(){for(var n=arguments.length,t=new Array(n),f=0;f<n;f++)t[f]=arguments[f];return t.map(function(l){return l.trim()}).join(" ").trim()};Z.concatTranscripts=sr;var ar=/\s*\((.*?)\)\s*/g,or=/(\(\?:[^)]+\))\?/g,cr=/(\(\?)?:\w+/g,lr=/\*/g,ur=/[-{}[\]+?.,\\^$|#]/g,pr=function(n){return n instanceof RegExp?new RegExp(n.source,"i"):(n=n.replace(ur,"\\$&").replace(ar,"(?:$1)?").replace(cr,function(t,f){return f?t:"([^\\s]+)"}).replace(lr,"(.*?)").replace(or,"\\s*$1?\\s*"),new RegExp("^"+n+"$","i"))};Z.commandToRegExp=pr;var fr=function(n,t){if(n=n.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!n.length&&!t.length)return 1;if(!n.length||!t.length)return 0;if(n===t)return 1;if(n.length===1&&t.length===1||n.length<2||t.length<2)return 0;for(var f=new Map,l=0;l<n.length-1;l++){var p=n.substring(l,l+2),i=f.has(p)?f.get(p)+1:1;f.set(p,i)}for(var o=0,m=0;m<t.length-1;m++){var C=t.substring(m,m+2),$=f.has(C)?f.get(C):0;$>0&&(f.set(C,$-1),o++)}return 2*o/(n.length+t.length-2)};Z.compareTwoStringsUsingDiceCoefficient=fr;var hr=function(){return typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0)};Z.browserSupportsPolyfills=hr;var he={},ce={};Object.defineProperty(ce,"__esModule",{value:!0});ce.APPEND_TRANSCRIPT=ce.CLEAR_TRANSCRIPT=void 0;var dr="CLEAR_TRANSCRIPT";ce.CLEAR_TRANSCRIPT=dr;var gr="APPEND_TRANSCRIPT";ce.APPEND_TRANSCRIPT=gr;Object.defineProperty(he,"__esModule",{value:!0});he.appendTranscript=he.clearTranscript=void 0;var jt=ce,mr=function(){return{type:jt.CLEAR_TRANSCRIPT}};he.clearTranscript=mr;var vr=function(n,t){return{type:jt.APPEND_TRANSCRIPT,payload:{interimTranscript:n,finalTranscript:t}}};he.appendTranscript=vr;var De={};Object.defineProperty(De,"__esModule",{value:!0});De.transcriptReducer=void 0;var bt=ce,br=Z,yr=function(n,t){switch(t.type){case bt.CLEAR_TRANSCRIPT:return{interimTranscript:"",finalTranscript:""};case bt.APPEND_TRANSCRIPT:return{interimTranscript:t.payload.interimTranscript,finalTranscript:(0,br.concatTranscripts)(n.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};De.transcriptReducer=yr;var Pt={},Ye={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){return/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"")};e.default=n})(Ye);var Qe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.isNative=void 0;var n=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),t=function(p){return p===n};e.isNative=t;var f=n;e.default=f})(Qe);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=l(Ye),t=Z,f=Qe;function l(S){return S&&S.__esModule?S:{default:S}}function p(S,y,h,T,R,v,d){try{var r=S[v](d),c=r.value}catch(u){h(u);return}r.done?y(c):Promise.resolve(c).then(T,R)}function i(S){return function(){var y=this,h=arguments;return new Promise(function(T,R){var v=S.apply(y,h);function d(c){p(v,T,R,d,r,"next",c)}function r(c){p(v,T,R,d,r,"throw",c)}d(void 0)})}}function o(S,y){if(!(S instanceof y))throw new TypeError("Cannot call a class as a function")}function m(S,y){for(var h=0;h<y.length;h++){var T=y[h];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(S,T.key,T)}}function C(S,y,h){return y&&m(S.prototype,y),h&&m(S,h),S}var $=function(){function S(y){o(this,S),this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=function(){},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(y),(0,n.default)()&&(this.updateFinalTranscript=(0,t.debounce)(this.updateFinalTranscript,250,!0))}return C(S,[{key:"setSpeechRecognition",value:function(h){var T=!!h&&((0,f.isNative)(h)||(0,t.browserSupportsPolyfills)());T&&(this.disableRecognition(),this.recognition=new h,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(T)}},{key:"subscribe",value:function(h,T){this.subscribers[h]=T}},{key:"unsubscribe",value:function(h){delete this.subscribers[h]}},{key:"emitListeningChange",value:function(h){var T=this;this.listening=h,Object.keys(this.subscribers).forEach(function(R){var v=T.subscribers[R].onListeningChange;v(h)})}},{key:"emitMicrophoneAvailabilityChange",value:function(h){var T=this;this.isMicrophoneAvailable=h,Object.keys(this.subscribers).forEach(function(R){var v=T.subscribers[R].onMicrophoneAvailabilityChange;v(h)})}},{key:"emitTranscriptChange",value:function(h,T){var R=this;Object.keys(this.subscribers).forEach(function(v){var d=R.subscribers[v].onTranscriptChange;d(h,T)})}},{key:"emitClearTranscript",value:function(){var h=this;Object.keys(this.subscribers).forEach(function(T){var R=h.subscribers[T].onClearTranscript;R()})}},{key:"emitBrowserSupportsSpeechRecognitionChange",value:function(h){var T=this;Object.keys(this.subscribers).forEach(function(R){var v=T.subscribers[R],d=v.onBrowserSupportsSpeechRecognitionChange,r=v.onBrowserSupportsContinuousListeningChange;d(h),r(h)})}},{key:"disconnect",value:function(h){if(this.recognition&&this.listening)switch(h){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}},{key:"disableRecognition",value:function(){this.recognition&&(this.recognition.onresult=function(){},this.recognition.onend=function(){},this.recognition.onerror=function(){},this.listening&&this.stopListening())}},{key:"onError",value:function(h){h&&h.error&&h.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}},{key:"onRecognitionDisconnect",value:function(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}},{key:"updateTranscript",value:function(h){var T=h.results,R=h.resultIndex,v=R===void 0?T.length-1:R;this.interimTranscript="",this.finalTranscript="";for(var d=v;d<T.length;++d)T[d].isFinal&&(!(0,n.default)()||T[d][0].confidence>0)?this.updateFinalTranscript(T[d][0].transcript):this.interimTranscript=(0,t.concatTranscripts)(this.interimTranscript,T[d][0].transcript);var r=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(r=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,r||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}},{key:"updateFinalTranscript",value:function(h){this.finalTranscript=(0,t.concatTranscripts)(this.finalTranscript,h)}},{key:"resetTranscript",value:function(){this.disconnect("RESET")}},{key:"startListening",value:function(){var y=i(regeneratorRuntime.mark(function T(){var R,v,d,r,c,u,b=arguments;return regeneratorRuntime.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:if(R=b.length>0&&b[0]!==void 0?b[0]:{},v=R.continuous,d=v===void 0?!1:v,r=R.language,this.recognition){P.next=3;break}return P.abrupt("return");case 3:if(c=d!==this.recognition.continuous,u=r&&r!==this.recognition.lang,!(c||u)){P.next=11;break}if(!this.listening){P.next=9;break}return P.next=9,this.stopListening();case 9:this.recognition.continuous=c?d:this.recognition.continuous,this.recognition.lang=u?r:this.recognition.lang;case 11:if(this.listening){P.next=22;break}return this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript()),P.prev=13,P.next=16,this.start();case 16:this.emitListeningChange(!0),P.next=22;break;case 19:P.prev=19,P.t0=P.catch(13),P.t0 instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1);case 22:case"end":return P.stop()}},T,this,[[13,19]])}));function h(){return y.apply(this,arguments)}return h}()},{key:"abortListening",value:function(){var y=i(regeneratorRuntime.mark(function T(){var R=this;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.disconnect("ABORT"),this.emitListeningChange(!1),d.next=4,new Promise(function(r){R.onStopListening=r});case 4:case"end":return d.stop()}},T,this)}));function h(){return y.apply(this,arguments)}return h}()},{key:"stopListening",value:function(){var y=i(regeneratorRuntime.mark(function T(){var R=this;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.disconnect("STOP"),this.emitListeningChange(!1),d.next=4,new Promise(function(r){R.onStopListening=r});case 4:case"end":return d.stop()}},T,this)}));function h(){return y.apply(this,arguments)}return h}()},{key:"getRecognition",value:function(){return this.recognition}},{key:"start",value:function(){var y=i(regeneratorRuntime.mark(function T(){return regeneratorRuntime.wrap(function(v){for(;;)switch(v.prev=v.next){case 0:if(!(this.recognition&&!this.listening)){v.next=4;break}return v.next=3,this.recognition.start();case 3:this.listening=!0;case 4:case"end":return v.stop()}},T,this)}));function h(){return y.apply(this,arguments)}return h}()},{key:"stop",value:function(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}},{key:"abort",value:function(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}}]),S}();e.default=$})(Pt);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.useSpeechRecognition=void 0;var n=I,t=Z,f=he,l=De,p=m(Pt),i=m(Ye),o=m(Qe);function m(A){return A&&A.__esModule?A:{default:A}}function C(A,k,E,j,D,M,V){try{var s=A[M](V),a=s.value}catch(g){E(g);return}s.done?k(a):Promise.resolve(a).then(j,D)}function $(A){return function(){var k=this,E=arguments;return new Promise(function(j,D){var M=A.apply(k,E);function V(a){C(M,j,D,V,s,"next",a)}function s(a){C(M,j,D,V,s,"throw",a)}V(void 0)})}}function S(A){return T(A)||h(A)||r(A)||y()}function y(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h(A){if(typeof Symbol<"u"&&Symbol.iterator in Object(A))return Array.from(A)}function T(A){if(Array.isArray(A))return c(A)}function R(A){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?R=function(E){return typeof E}:R=function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},R(A)}function v(A,k){return b(A)||u(A,k)||r(A,k)||d()}function d(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function r(A,k){if(A){if(typeof A=="string")return c(A,k);var E=Object.prototype.toString.call(A).slice(8,-1);if(E==="Object"&&A.constructor&&(E=A.constructor.name),E==="Map"||E==="Set")return Array.from(A);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return c(A,k)}}function c(A,k){(k==null||k>A.length)&&(k=A.length);for(var E=0,j=new Array(k);E<k;E++)j[E]=A[E];return j}function u(A,k){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(A)))){var E=[],j=!0,D=!1,M=void 0;try{for(var V=A[Symbol.iterator](),s;!(j=(s=V.next()).done)&&(E.push(s.value),!(k&&E.length===k));j=!0);}catch(a){D=!0,M=a}finally{try{!j&&V.return!=null&&V.return()}finally{if(D)throw M}}return E}}function b(A){if(Array.isArray(A))return A}var x=!!o.default,P=x&&!(0,i.default)(),z,F=function(){var k=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},E=k.transcribing,j=E===void 0?!0:E,D=k.clearTranscriptOnListen,M=D===void 0?!0:D,V=k.commands,s=V===void 0?[]:V,a=(0,n.useState)(B.getRecognitionManager()),g=v(a,1),L=g[0],_=(0,n.useState)(x),O=v(_,2),U=O[0],q=O[1],Q=(0,n.useState)(P),K=v(Q,2),ge=K[0],ae=K[1],ne=(0,n.useReducer)(l.transcriptReducer,{interimTranscript:L.interimTranscript,finalTranscript:""}),Je=v(ne,2),Xe=Je[0],et=Xe.interimTranscript,tt=Xe.finalTranscript,nt=Je[1],Vt=(0,n.useState)(L.listening),rt=v(Vt,2),Gt=rt[0],Kt=rt[1],Ut=(0,n.useState)(L.isMicrophoneAvailable),it=v(Ut,2),qt=it[0],Ht=it[1],st=(0,n.useRef)(s);st.current=s;var at=function(){nt((0,f.clearTranscript)())},me=(0,n.useCallback)(function(){L.resetTranscript(),at()},[L]),Yt=function(H,te,oe){var se=R(H)==="object"?H.toString():H,ve=se.replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),Se=(0,t.compareTwoStringsUsingDiceCoefficient)(ve,te);return Se>=oe?{command:H,commandWithoutSpecials:ve,howSimilar:Se,isFuzzyMatch:!0}:null},Qt=function(H,te){var oe=(0,t.commandToRegExp)(H),se=oe.exec(te);return se?{command:H,parameters:se.slice(1)}:null},ot=(0,n.useCallback)(function(ee,H){st.current.forEach(function(te){var oe=te.command,se=te.callback,ve=te.matchInterim,Se=ve===void 0?!1:ve,ut=te.isFuzzyMatch,pt=ut===void 0?!1:ut,ft=te.fuzzyMatchingThreshold,Jt=ft===void 0?.8:ft,ht=te.bestMatchOnly,Xt=ht===void 0?!1:ht,Te=!H&&Se?ee.trim():H.trim(),en=Array.isArray(oe)?oe:[oe],Re=en.map(function(J){return pt?Yt(J,Te,Jt):Qt(J,Te)}).filter(function(J){return J});if(pt&&Xt&&Re.length>=2){Re.sort(function(J,Ie){return Ie.howSimilar-J.howSimilar});var ze=Re[0],tn=ze.command,nn=ze.commandWithoutSpecials,rn=ze.howSimilar;se(nn,Te,rn,{command:tn,resetTranscript:me})}else Re.forEach(function(J){if(J.isFuzzyMatch){var Ie=J.command,sn=J.commandWithoutSpecials,an=J.howSimilar;se(sn,Te,an,{command:Ie,resetTranscript:me})}else{var on=J.command,cn=J.parameters;se.apply(void 0,S(cn).concat([{command:on,resetTranscript:me}]))}})})},[me]),ct=(0,n.useCallback)(function(ee,H){j&&nt((0,f.appendTranscript)(ee,H)),ot(ee,H)},[ot,j]),lt=(0,n.useCallback)(function(){M&&at()},[M]);(0,n.useEffect)(function(){var ee=B.counter;B.counter+=1;var H={onListeningChange:Kt,onMicrophoneAvailabilityChange:Ht,onTranscriptChange:ct,onClearTranscript:lt,onBrowserSupportsSpeechRecognitionChange:q,onBrowserSupportsContinuousListeningChange:ae};return L.subscribe(ee,H),function(){L.unsubscribe(ee)}},[j,M,L,ct,lt]);var Zt=(0,t.concatTranscripts)(tt,et);return{transcript:Zt,interimTranscript:et,finalTranscript:tt,listening:Gt,isMicrophoneAvailable:qt,resetTranscript:me,browserSupportsSpeechRecognition:U,browserSupportsContinuousListening:ge}};e.useSpeechRecognition=F;var B={counter:0,applyPolyfill:function(k){z?z.setSpeechRecognition(k):z=new p.default(k);var E=!!k&&(0,t.browserSupportsPolyfills)();x=E,P=E},removePolyfill:function(){z?z.setSpeechRecognition(o.default):z=new p.default(o.default),x=!!o.default,P=x&&!(0,i.default)()},getRecognitionManager:function(){return z||(z=new p.default(o.default)),z},getRecognition:function(){var k=B.getRecognitionManager();return k.getRecognition()},startListening:function(){var A=$(regeneratorRuntime.mark(function E(){var j,D,M,V,s=arguments;return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:return j=s.length>0&&s[0]!==void 0?s[0]:{},D=j.continuous,M=j.language,V=B.getRecognitionManager(),g.next=4,V.startListening({continuous:D,language:M});case 4:case"end":return g.stop()}},E)}));function k(){return A.apply(this,arguments)}return k}(),stopListening:function(){var A=$(regeneratorRuntime.mark(function E(){var j;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return j=B.getRecognitionManager(),M.next=3,j.stopListening();case 3:case"end":return M.stop()}},E)}));function k(){return A.apply(this,arguments)}return k}(),abortListening:function(){var A=$(regeneratorRuntime.mark(function E(){var j;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return j=B.getRecognitionManager(),M.next=3,j.abortListening();case 3:case"end":return M.stop()}},E)}));function k(){return A.apply(this,arguments)}return k}(),browserSupportsSpeechRecognition:function(){return x},browserSupportsContinuousListening:function(){return P}},X=B;e.default=X})(xt);(function(e){function n(i){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(m){return typeof m}:n=function(m){return m&&typeof Symbol=="function"&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},n(i)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"useSpeechRecognition",{enumerable:!0,get:function(){return t.useSpeechRecognition}}),e.default=void 0;var t=l(xt);function f(){if(typeof WeakMap!="function")return null;var i=new WeakMap;return f=function(){return i},i}function l(i){if(i&&i.__esModule)return i;if(i===null||n(i)!=="object"&&typeof i!="function")return{default:i};var o=f();if(o&&o.has(i))return o.get(i);var m={},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var $ in i)if(Object.prototype.hasOwnProperty.call(i,$)){var S=C?Object.getOwnPropertyDescriptor(i,$):null;S&&(S.get||S.set)?Object.defineProperty(m,$,S):m[$]=i[$]}return m.default=i,o&&o.set(i,m),m}var p=t.default;e.default=p})(ye);const be=hn(ye),{colors:G,shadows:yt,indents:Be}=Y,wr=$e`
  margin-bottom: 7px;
  padding-block: ${Be.xs};

  display: grid;
  align-items: center;
  grid-template-columns: 1fr 25fr 1fr;

  border: 1px solid transparent;
  background-color: ${({licolor:e})=>e};
  border-radius: ${Be.xs};
  font-size: 22px;

  &:last-of-type {
    margin-bottom: ${Be.s};
  }
`,$r=W.li`
  ${wr}

  transition: box-shadow 250ms, border-color 250ms;

  &#active-element {
    border-color: ${G.border};
    background-color: ${G.background};
    box-shadow: ${yt.back};

    &:hover {
      border-color: ${G.accent};
    }
    & div button {
      transition: color 250ms;
      color: ${G.smokeBlack};
      &:hover {
        color: ${G.hovered};
      }
    }
  }

  & div button {
    transition: color 250ms;
    &:hover {
      color: ${G.hovered};
    }
  }

  &:hover {
    border-color: ${G.accent};
    box-shadow: ${yt.back};
  }

  &:hover label,
  &:hover button {
    opacity: 1;
  }
`,Mt=$e`
  min-height: 19px;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  & input {
    ${jn}
  }
`,Sr=W.label`
  ${Mt}

  & svg {
    transition: stroke 250ms;
    stroke-width: 2px;
    color: ${({$hovered:e})=>e?G.yellow:"transparent"};
    stroke: ${({$hovered:e})=>e?G.yellow:G.border};
  }
  &:hover svg {
    stroke: ${G.placeholder};
  }
`,Tr=W.label`
  ${Mt}
  opacity: ${({$hovered:e})=>e?1:0};
  transition: opacity 250ms;

  & svg {
    transition: border-color 250ms, color 250ms;
    padding: 1px;
    border: 2px solid ${G.border};
    border-radius: 50%;
    color: ${({$hovered:e})=>e?G.border:"transparent"};
  }
  &:hover svg {
    border-color: ${G.placeholder};
    color: ${({$hovered:e})=>e?G.placeholder:"transparent"};
  }
`,de=$e`
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: transparent;
  border-color: transparent;
  transition: opacity 250ms color 250ms;
  color: ${G.black};

  & svg {
    transition: color 250ms;
    color: ${G.border};
  }
  &:hover,
  &:hover svg {
    color: ${G.placeholder};
  }
`,Rr=W.button`
  ${de}

  opacity: ${({$hovered:e})=>e?1:0};
`,Ar=W.button`
  ${de}

  opacity: 0;
`,{colors:Oe,indents:Ot}=Y,Dt=$e`
  padding-block: 4px;
  display: grid;
  align-items: start;
  grid-template-columns: 20fr 1fr 20fr;
`,Cr=W.div`
  ${Dt}
`,kr=W.form`
  ${Dt}

  max-height: 70vh;
  overflow-y: scroll;
  scrollbar-width: none;
  grid-template-columns: 12fr 1fr 12fr;
`,wt=W.textarea`
  height: 84px;
  outline: none;
  border: 1px solid ${Oe.accent};
  border-radius: ${Ot.xs};
  resize: none;
  overflow: clip;
  transition: height 150ms;
`,Er=W.div`
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  &::after {
    content: '';
    height: calc(100% - 8px);
    width: 1px;
    border: 1px solid ${Oe.borderLight};
    transition: border-color 250ms;
  }

  &:hover::after {
    border-color: ${Oe.placeholder};
  }
`,_r=W.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,Lr=W.button`
  ${de}
`;W.button`
  ${de}
`;const qe=W.button`
  ${de}
`,xr=W.button`
  ${de}
`,$t=W.button`
  height: 100%;
  text-align: left;
  display: flex;
  align-items: top;
  background-color: transparent;
  border-color: transparent;
  border-radius: ${Ot.xs};
  color: ${Oe.black};
  transition: background-color 250ms;
`,zt=$e`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
`,jr=W.iframe`
  ${zt}

  height: 60px;
  border-radius: 30px;
`,Pr=W.audio`
  ${zt}
`,Ze=({el:e,setIsForm:n,setRecording:t,setTranslation:f})=>{const l=I.useRef(null),p=I.useRef(null),i=I.useRef(null),o=le(),{user:m}=ue(),{activeCluster:C}=ie(),[$,S]=I.useState(""),{_id:y,element:h,caption:T}=e,{register:R,watch:v,setValue:d,handleSubmit:r,setFocus:c}=Pn({mode:"onBlur",defaultValues:{element:h,caption:T}});I.useEffect(()=>{d("caption",T)},[T,d]);const{ref:u,...b}=R("element"),{ref:x,...P}=R("caption"),z=[l.current,p.current,i.current],F=[v("caption"),v("element")];Nn(z,F),I.useEffect(()=>{c("element"),$&&h.trim().startsWith("der")?d("element",$+h.replace("der","").trim()+", "):$&&h.trim().startsWith("die")?d("element",$+h.replace("die","").trim()+", "):$&&h.trim().startsWith("das")?d("element",$+h.replace("das","").trim()+", "):$?d("element",$+h+", "):d("element",$+h)},[$,h,c,d]),I.useEffect(()=>{const k=async E=>{(E.code==="NumpadAdd"||E.ctrlKey&&E.key==="Escape")&&(E.preventDefault(),await A(m.engine),r(B)()),E.key==="Enter"&&(E.preventDefault(),r(B)()),E.code==="AltRight"&&l.current.focus()};return addEventListener("keydown",k),()=>{removeEventListener("keydown",k)}},[]);const B=k=>{const E=m.lang;let j=k.caption.trim(),D=Ke(k.element,C.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();D=Me(D,","),j=Me(j,","),m.lang.includes("en")&&C.lang.includes("de")&&(D.includes("hat")||D.includes("ist"))&&D.split(`
`)[0].split(/,\s+/)[0].endsWith("n")&&(j=j.split(/,\s+/).map(s=>s.startsWith("to ")?s:`to ${s}`).join(", ")),o(y?je({_id:y,lang:E,element:D,caption:j}):Rt({...e,element:D,caption:j})).then(o(Ct())),y||(At(),t(""),f("")),n(!1)},X=()=>{$===""&&S("der "),$==="der "&&S("die "),$==="die "&&S("das "),$==="das "&&S("")},A=async k=>{const E=v("element"),j=Ke(E,C.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim(),D={from:C.lang,to:m.lang},M=await we(j,D,k);d("caption",M)};return w.jsxs(kr,{onSubmit:r(B),children:[w.jsx(wt,{...b,name:"element",ref:k=>{u(k),l.current=k}}),w.jsxs(_r,{ref:i,children:[w.jsx(xr,{type:"button",onClick:X,children:w.jsx(Mn,{size:"18px"})}),w.jsx(qe,{type:"button",onClick:()=>A("google"),children:w.jsx(dn,{size:"16px"})}),w.jsx(qe,{type:"button",onClick:()=>A("deepl"),children:w.jsx(gn,{size:"18px"})}),w.jsx(Lr,{children:w.jsx(mn,{size:"16px"})})]}),w.jsx(wt,{...P,name:"caption",ref:k=>{x(k),p.current=k}})]})};Ze.propTypes={el:N.object,setIsForm:N.func,setRecording:N.func,setTranslation:N.func};const{button:Mr}=Y.shadows,{m:Or,xl:Dr}=Y.indents,zr=()=>{const{user:e}=ue(),[n,t]=I.useState(!1),{activeCluster:f}=ie(),[l,p]=I.useState(""),[i,o]=I.useState(""),{transcript:m,listening:C,resetTranscript:$}=ye.useSpeechRecognition(),{isMicrophoneAvailable:S}=ye.useSpeechRecognition(),{browserSupportsSpeechRecognition:y}=ye.useSpeechRecognition(),h=l.endsWith(", ")||l.replace(/[a-z]$/,"*#").endsWith("*#")?m.replace(/^./,r=>` ${r}`):m.replace(/^./,r=>r.toUpperCase()),T=`${l}${h}`,R=On(T,Vn),v=(r,c)=>r.trim().endsWith(c)?`${r.trim()} `:`${r.trim()}${c} `;if(I.useEffect(()=>{if(!C||!n)return;const r=[".","?","!",","],c=u=>{if(r.includes(u.key)){u.preventDefault();const b=v(R,u.key);p(b),$()}if(u.key==="Backspace"){u.preventDefault();const b=R.length-1,x=R.substring(0,b);p(x),$()}if(u.key==="Space"){u.preventDefault();const b=R+" ";p(b),$()}};return addEventListener("keydown",c),()=>{removeEventListener("keydown",c)}},[n,C,R,$]),I.useEffect(()=>{const r=async c=>{if(c.key==="Escape"){c.preventDefault(),be.stopListening(),t(!1),p(""),o(""),$();return}if(C||c.metaKey&&c.key==="r"&&!c.altKey&&!c.shiftKey&&(c.preventDefault(),t(!0),be.startListening({language:f.lang,continuous:!0})),C&&c.metaKey&&c.key==="r"&&!c.altKey&&!c.shiftKey){c.preventDefault(),be.stopListening();const u=R.at(-1),b=!u||["!"].includes(u)?R:v(R,"."),x=await we(b,{from:f.lang,to:e.lang},e.engine);p(b),o(x),$()}};return addEventListener("keydown",r),()=>{removeEventListener("keydown",r)}},[f.lang,n,C,R,$,e.engine,e.lang]),!y||!S)return;const d=async r=>{if(r==null||r.currentTarget.blur(),!C)t(!0),be.startListening({language:f.lang,continuous:!0});else{be.stopListening();const c=R.at(-1),u=!c||["!"].includes(c)?R:v(R,"."),b={from:f.lang,to:e.lang},x=await we(u,b,e.engine);p(u),o(x),$()}};return w.jsxs(w.Fragment,{children:[w.jsx(pe,{onClick:d,$s:"m",$round:!0,$bs:Mr,children:C?w.jsx(bn,{size:18}):w.jsx(vn,{size:18})}),n&&w.jsx(yn,{$x:`left: ${Or}`,$y:`top: ${Dr}`,$bd:"none",children:w.jsx(Ze,{el:{cluster:f._id,element:R.trim(),caption:i.trim(),favorite:!0,checked:R.split(/\s+/).length<20},setIsForm:t,setRecording:p,setTranslation:o})})]})},{m:Ir,s:Nr}=Y.indents,It=({className:e})=>{const{pathname:n}=wn(),{elementTrash:t}=fe(),{activeCluster:f}=ie(),l=t.length>0?" 1fr":"",p=f?" 1fr":"",i=l+p+" 1fr 1fr";if(n.includes("/element"))return w.jsxs(He,{className:e,$m:`${Nr} ${Ir}`,$pos:"fixed",$side:"left",$high:"bottom",$gtc:i,children:[w.jsx(nr,{}),w.jsx(zr,{}),p&&w.jsx(Zn,{}),l&&w.jsx(Xn,{})]})};It.propTypes={className:N.string};const{colors:We}=Y,Br=W.div`
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  &:hover svg {
    stroke: ${We.yellow};
  }

  & svg {
    transition: stroke 250ms;
    stroke: ${We.hovered};
    /* stroke: ${({$colored:e})=>e&&We.yellow}; */
    @keyframes refresh-spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(-360deg);
      }
    }
    animation: refresh-spin infinite 12s linear;
  }
`,Nt=({onClick:e})=>w.jsx(Br,{onClick:e,children:w.jsx($n,{size:"35px"})});Nt.propTypes={onClick:N.func};const{background:Fe}=Y.colors,{button:St}=Y.shadows,{m:Wr,s:Fr}=Y.indents,Bt=({className:e,filtredElements:n,setLiColor:t})=>{const{user:f}=ue(),{activeCluster:l}=ie(),{activeElement:p}=fe(),[i,o]=I.useState(null);if(I.useEffect(()=>{const v=window.speechSynthesis.getVoices();Array.isArray(v)&&v.length>0&&o(v),"onvoiceschanged"in window.speechSynthesis&&(window.speechSynthesis.onvoiceschanged=()=>{const d=window.speechSynthesis.getVoices();o(d)})},[]),!Array.isArray(i)||i.length===0)return;const m=v=>{if(!v.length)return;let d="",r=0;const c=v.reduce((u,b)=>(u[b.lang]||(u[b.lang]=0),u[b.lang]+=1,u),{});for(const u in c)c[u]>r&&(r=c[u],d=u);return d},C=n.length?m(n):f.lang,$=(v,d)=>v.replaceAll(", `",`;${d} `).replaceAll(" `",`${d} `).replaceAll(",`",";"),S=({text:v,playList:d,divider:r})=>{let c="";for(let u=0;u<d.length;u+=1){let b=d[u][v];const x=`@±@${d[u].lang}${r}`;b.endsWith(".")||b.endsWith("!")||b.endsWith("?")||b.endsWith('"')?(c+=$(b,r).replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",v!=="caption"?`__${r}`:`__${x}`).replaceAll(".",v!=="caption"?`.${r}`:`.${x}`).replaceAll(",",v!=="caption"?`,${r}`:`,${x}`).replaceAll("!",v!=="caption"?`!${r}`:`!${x}`).replaceAll("?",v!=="caption"?`?${r}`:`?${x}`).replaceAll(":",v!=="caption"?`:${r}`:`:${x}`),l.lang.includes("de")&&(c=c.replaceAll(`0.${r}`,"0.").replaceAll(`1.${r}`,"1.").replaceAll(`2.${r}`,"2.").replaceAll(`3.${r}`,"3.").replaceAll(`4.${r}`,"4.").replaceAll(`5.${r}`,"5.").replaceAll(`6.${r}`,"6.").replaceAll(`7.${r}`,"7.").replaceAll(`8.${r}`,"8.").replaceAll(`9.${r}`,"9."))):d[u].element.startsWith("[")||(v==="caption"&&(b.includes(" [")&&(b=b.substring(0,b.indexOf(" ["))),b=`${b}@±@${d[u].lang}`),c+=b+r)}return c},y=i,h=v=>{v.currentTarget.blur(),t(Fe);const d="$*@",r=n.findIndex(b=>b.element===p.element),c=n.splice(r===-1?0:r),u=Pe({setLiColor:t,divider:d,voices:y,text:S({text:"element",playList:c,divider:d}),lang:l.lang,rate:l.rate});u&&re.error(u)},T=v=>{v.currentTarget.blur();const d="$*@";t(Fe);const r=n.findIndex(b=>b.element===p.element),c=n.splice(r===-1?0:r),u=Pe({setLiColor:t,divider:d,voices:y,text:S({text:"caption",playList:c,divider:d}),lang:C,rate:f.rate});u&&re.error(u)},R=v=>{v.currentTarget.blur(),t(Fe);let d="";const r="$*@",c=n.findIndex(x=>x.element===p.element),u=n.splice(c===-1?0:c);for(let x=0;x<u.length;x+=1){const{element:P,caption:z,lang:F}=u[x];if(!P.startsWith("[")){const B=$(P,""),X=z.includes(" [")?z.substring(0,z.indexOf(" [")):$(z,"");d+=B+`@±@${F}`+X+r}}const b=Sn({setLiColor:t,divider:r,voices:y,text:d,lang:l.lang,rate:f.rate});b&&re.error(b)};return w.jsxs(He,{className:e,$m:`${Fr} ${Wr}`,$pos:"fixed",$side:"right",$high:"bottom",$gtc:"1fr 0.5fr 1fr",children:[w.jsx(pe,{onClick:h,$s:"m",$round:!0,$bs:St,children:(l==null?void 0:l.lang.at(0).toUpperCase())+(l==null?void 0:l.lang.substring(1))}),w.jsx(Nt,{onClick:R}),w.jsx(pe,{onClick:T,$s:"m",$round:!0,$bs:St,children:(C==null?void 0:C.at(0).toUpperCase())+(C==null?void 0:C.substring(1))})]})};Bt.propTypes={className:N.string,filtredElements:N.array,setLiColor:N.func};const Wt=({el:e,sortByDate:n,setSortByDate:t,setLiColor:f})=>{const l=le(),{user:p}=ue(),{activeCluster:i}=ie(),{element:o,caption:m}=e,C="$*@",$=(r,c)=>{let u="";return c?(r.trim().endsWith(".")||r.trim().endsWith("!")||r.trim().endsWith("?")||r.endsWith('"')?(u=r.trim().replaceAll(", `",`;${c} `).replaceAll(" `",`${c} `).replaceAll(",`",";").replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",`__${c}`).replaceAll(".",`.${c}`).replaceAll(",",`,${c}`).replaceAll("!",`!${c}`).replaceAll("?",`?${c}`).replaceAll(":",`:${c}`),i.lang.includes("de")&&(u=u.replaceAll(`0.${c}`,"0.").replaceAll(`1.${c}`,"1.").replaceAll(`2.${c}`,"2.").replaceAll(`3.${c}`,"3.").replaceAll(`4.${c}`,"4.").replaceAll(`5.${c}`,"5.").replaceAll(`6.${c}`,"6.").replaceAll(`7.${c}`,"7.").replaceAll(`8.${c}`,"8.").replaceAll(`9.${c}`,"9."))):u=r.trim()+c,u.includes("[")?u.substring(0,u.indexOf("["))+c:u):r},S=r=>{r.currentTarget.blur();const c=Pe({setLiColor:f,divider:C,voices:window.speechSynthesis.getVoices(),text:$(o,C),lang:i.lang,rate:i.rate});c&&re.error(c)},y=r=>{r.currentTarget.blur();const c=Pe({setLiColor:f,divider:C,voices:window.speechSynthesis.getVoices(),text:$(m,C),lang:e.lang,rate:p.rate});c&&re.error(c)},h=r=>{t(!n),n?re.success("Below is Recent"):re.success("Above is Recent"),r.stopPropagation()},T=r=>{const{_id:c}=i;l(kt(e)),r.currentTarget.closest("li").id!=="active-element"&&l(Ve({_id:c,activeEl:e._id}))},R=m.endsWith("mp3"),v=!R&&m.startsWith("http"),d=!R&&!v;return w.jsxs(Cr,{onClick:T,children:[w.jsx($t,{onClick:S,children:o}),w.jsx(Er,{onClick:h}),R&&w.jsx(Pr,{controls:!0,src:mt(m)}),v&&w.jsx(jr,{src:mt(m)}),d&&w.jsx($t,{onClick:y,children:m})]})};Wt.propTypes={el:N.object,sortByDate:N.bool,setSortByDate:N.func,$active:N.bool,$hovered:N.bool,setLiColor:N.func};const Ft=({el:e,index:n,length:t,sortByDate:f,setSortByDate:l,translateAll:p,liColor:i,setLiColor:o})=>{const m=le(),{elementTrash:C,activeElement:$}=fe(),[S,y]=I.useState(!1),{_id:h,favorite:T,checked:R}=e,v=C.find(x=>x._id===h),d=()=>{m(je({_id:h,favorite:!T}))},r=()=>{m(je({_id:h,checked:!R}))},c=()=>m(kn(e)),u=()=>y(!S),b=h===($==null?void 0:$._id);return w.jsxs($r,{id:b?"active-element":null,licolor:i,children:[w.jsxs(Ge,{$h:"100%",$p:"0",$fd:"column",children:[w.jsxs(Sr,{$hovered:T,children:[w.jsx("input",{type:"checkbox",name:"favorite",checked:T,onChange:d}),w.jsx(xn,{size:"20px"})]}),w.jsxs(Tr,{$hovered:R,children:[w.jsx("input",{type:"checkbox",name:"checked",checked:R,onChange:r}),w.jsx(Tn,{size:"15px"})]}),S&&t===n+1&&w.jsx(qe,{onClick:p,children:w.jsx(Rn,{size:"16px"})})]}),S&&w.jsx(Ze,{el:e,setIsForm:y}),!S&&w.jsx(Wt,{el:e,sortByDate:f,setSortByDate:l,setLiColor:o}),w.jsxs(Ge,{$h:"100%",$p:"0",$fd:"column",children:[w.jsx(Rr,{$hovered:v,onClick:c,children:w.jsx(An,{size:"16px"})}),w.jsx(Ar,{onClick:u,children:w.jsx(Cn,{size:"15px"})})]})]})};Ft.propTypes={el:N.object,index:N.number,length:N.number,sortByDate:N.bool,setSortByDate:N.func,translateAll:N.func,liColor:N.string,setLiColor:N.func};const Vr=W.ul`
  width: 100%;
  list-style: none;
`,{white:Gr}=Y.colors,Kr=()=>{const e=le(),{ref:n,inView:t,entry:f}=Yn({initialInView:!0,rootMargin:"0px 0px -30px 0px"}),{user:l}=ue(),{activeCluster:p}=ie(),{allElements:i,elementTrash:o,elementFilter:m,isLoading:C}=fe(),[$,S]=I.useState(Gr);let{elementSelect:y}=fe();y=y||[];const[h,T]=I.useState(!1);I.useEffect(()=>{p&&e(Ct({cluster:p._id})).unwrap().then(({result:u})=>{if(!p.activeEl)return;const b=u.elements.find(({_id:x})=>x===p.activeEl);e(kt(b))}).then(()=>{const u=document.getElementById("active-element");u&&En(u)})},[]);const R=i.filter(u=>u.cluster===(p==null?void 0:p._id)).sort((u,b)=>u.createdAt.localeCompare(b.createdAt)),d=(()=>{const u=o.map(b=>b._id);return y.includes("trash")?R.filter(b=>u.includes(b._id)):R})().filter(({element:u,caption:b,favorite:x,checked:P})=>{const z=u.toLowerCase().replace("·","").includes(m)||u.toLowerCase().includes(m)||b.toLowerCase().includes(m),F=y.includes("wordlist")?z&&Dn(u):z,B=()=>y.some(A=>["favorite","unfavorite"].includes(A))?y.includes("favorite")?F&&x===!0:F&&x===!1:F;return(()=>y.some(A=>["checked","unchecked"].includes(A))?y.includes("checked")?B()&&P===!0:B()&&P===!1:B())()}).sort(h?(u,b)=>b.createdAt.localeCompare(u.createdAt):(u,b)=>u.createdAt.localeCompare(b.createdAt)),r=async()=>{const u=l.lang;let b=0;await d.forEach(async x=>{if(b>1)return;const{_id:P,element:z}=x;if(!z.startsWith("[")||u!==x.lang){const F={from:p.lang,to:u},B=await we(z,F,l.engine);e(je({_id:P,lang:u,caption:B})),b=b+1}})},c=window.innerHeight<(f==null?void 0:f.target.getBoundingClientRect().y)+(f==null?void 0:f.target.getBoundingClientRect().height)*1.5;return w.jsxs(w.Fragment,{children:[w.jsxs(Vr,{children:[d.map((u,b,x)=>w.jsx(Ft,{el:u,index:b,length:x.length,sortByDate:h,setSortByDate:T,translateAll:r,liColor:$,setLiColor:S},u._id)),w.jsxs("div",{ref:n,children:[w.jsx(Lt,{}),w.jsx(It,{className:!t||!c?"shown":"hidden"}),w.jsx(Bt,{className:!t||!c?"shown":"hidden",filtredElements:d,setLiColor:S})]})]}),C&&w.jsx(_n,{})]})},{s:Tt,m:Ur}=Y.indents,Jr=()=>w.jsx(Ge,{$p:`0 ${Ur} ${Tt} ${Tt}`,children:w.jsx(Kr,{})});export{Jr as default};
