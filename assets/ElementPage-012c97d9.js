import{U as ze,r as z,t as Q,P as I,u as le,b as he,q as ie,j as y,T as He,V as Te,x as Fe,E as dt,H as gt,w as ue,S as cn,W as Rt,X as ln,Q as re,z as pe,Y as un,Z as pn,G as fn,i as hn,n as ye,s as F,_ as dn,$ as gn,a0 as mn,a1 as xe,a2 as At,a3 as vn,a4 as bn,M as yn,a5 as wn,a6 as $n,a7 as je,a8 as Sn,a9 as mt,aa as Ct,F as Ge,D as Tn,ab as Rn,C as An,A as Cn,ac as kn,N as En,ad as _n}from"./index-e20987f3.js";import{r as kt,H as Ln,T as xn}from"./index-4a7d3d39.js";import{w as Et}from"./writeClipboard-2e7b233f.js";import{v as jn,u as Pn}from"./index.esm-a29f03c8.js";import{a as Mn}from"./index-ad984f6f.js";const Ve=(e,n)=>{if(!n.includes("de"))return e;const t=e.trim().split(`
`);return t.length===1?e:["der","die","das"].includes(t[0].split(" ")[0])?`${t[0].trim()}, ${t[1].split("·")[1].replaceAll("⁰","").replaceAll("/"," / ").trim()}`:(e.includes("hat")||e.includes("ist"))&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e.includes("am")&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e},On=e=>/[a-z]/.test(e.charAt(0)),{VITE_DEEPL_API_KEY:Dn}={VITE_GOOGLE_CLIENT_ID:"689266183428-lh3lmpaqnd2qd6t93voa8s6ipt3836q1.apps.googleusercontent.com",VITE_DEEPL_API_KEY:"d15bf272-fb1f-4f29-bbc3-d3bbdd686c53:fx",VITE_GOOGLE_API_KEY:"AIzaSyDqQndBxYEuOG7F6iYDqQoiNF90tptRmBQ",VITE_PROD_BACK_URL:"https://studyorganizer.onrender.com",BASE_URL:"/studyorganizer/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},In={google:"",deepl:Dn},Ke=async(e,{from:n,to:t},g)=>{var a,i;ze.engine=g,ze.key=In[g];const c=e.replaceAll(" ·",",").replaceAll("·","");let f=await ze(`${c}`,{from:n,to:t});try{if(t.includes("en")&&c.toLowerCase().includes("uhr")&&(f=f.replaceAll("a.m. on","am on").replaceAll("p.m. on","pm on").replaceAll("a.m. to","am to").replaceAll("p.m. to","pm to").replaceAll("a.m.","am.").replaceAll("p.m.","pm.")),[".","!","?"].includes(c.at(c.length-1)))return f;const k=c.split(c.includes(", ")?", ":/\s+/),A=f.split(", "),v=t.includes("de")?A[0]:A[0].at(0).toLowerCase()+A[0].substring(1);return k.length===1?f.toLocaleLowerCase()+", ":["der","die","das"].includes(k[0].split(" ")[0])?f.replace("The ","").replace("the ","").split(", ")[0].toLocaleLowerCase()+", ":t.includes("en")&&((a=k[2])!=null&&a.startsWith("am"))?A[2].startsWith("the")?f:`${v}, ${A[1]}, the ${A[2]}`:(k[0].endsWith("n")&&["hat","ist"].includes((i=k[2])==null?void 0:i.split(" ")[0])&&n.includes("de")&&(f=t.includes("en")?"to "+v+", ":v+", "),f)}catch(l){return l.message}},Pe=(e,n)=>e.endsWith(n)?e.substring(0,e.length-1):e,zn=(e,n)=>{let t=84;e[0]&&(t=Number(e[0].style.height.replace("px",""))),z.useEffect(()=>{if(!e[0])return;let g=Math.max(...e.map(c=>c.scrollHeight));t!==g&&(g=g<=90?g:g+6,e.forEach(c=>{c.style.height=g+"px"}))},[t,e,n])},Re=[{value:"de",label:"German"},{value:"en",label:"English"},{value:"uk",label:"Ukrainian"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"it",label:"Italian"}],Ae=[{value:.3,label:"Rate: 0.3"},{value:.4,label:"Rate: 0.4"},{value:.5,label:"Rate: 0.5"},{value:.6,label:"Rate: 0.6"},{value:.8,label:"Rate: 0.8"},{value:1,label:"Rate: 1"},{value:1.25,label:"Rate: 1.25"},{value:1.5,label:"Rate: 1.5"}];var Ue=new Map,Ce=new WeakMap,vt=0,Nn=void 0;function Bn(e){return e?(Ce.has(e)||(vt+=1,Ce.set(e,vt.toString())),Ce.get(e)):"0"}function Wn(e){return Object.keys(e).sort().filter(n=>e[n]!==void 0).map(n=>`${n}_${n==="root"?Bn(e.root):e[n]}`).toString()}function Fn(e){const n=Wn(e);let t=Ue.get(n);if(!t){const g=new Map;let c;const f=new IntersectionObserver(a=>{a.forEach(i=>{var l;const k=i.isIntersecting&&c.some(A=>i.intersectionRatio>=A);e.trackVisibility&&typeof i.isVisible>"u"&&(i.isVisible=k),(l=g.get(i.target))==null||l.forEach(A=>{A(k,i)})})},e);c=f.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),t={id:n,observer:f,elements:g},Ue.set(n,t)}return t}function Gn(e,n,t={},g=Nn){if(typeof window.IntersectionObserver>"u"&&g!==void 0){const l=e.getBoundingClientRect();return n(g,{isIntersecting:g,target:e,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:l,intersectionRect:l,rootBounds:l}),()=>{}}const{id:c,observer:f,elements:a}=Fn(t),i=a.get(e)||[];return a.has(e)||a.set(e,i),i.push(n),f.observe(e),function(){i.splice(i.indexOf(n),1),i.length===0&&(a.delete(e),f.unobserve(e)),a.size===0&&(f.disconnect(),Ue.delete(c))}}function Vn({threshold:e,delay:n,trackVisibility:t,rootMargin:g,root:c,triggerOnce:f,skip:a,initialInView:i,fallbackInView:l,onChange:k}={}){var A;const[v,$]=z.useState(null),o=z.useRef(k),[u,p]=z.useState({inView:!!i,entry:void 0});o.current=k,z.useEffect(()=>{if(a||!v)return;let S;return S=Gn(v,(T,L)=>{p({inView:T,entry:L}),o.current&&o.current(T,L),L.isIntersecting&&f&&S&&(S(),S=void 0)},{root:c,rootMargin:g,threshold:e,trackVisibility:t,delay:n},l),()=>{S&&S()}},[Array.isArray(e)?e.toString():e,v,c,g,f,a,t,l,n]);const b=(A=u.entry)==null?void 0:A.target,d=z.useRef(void 0);!v&&b&&!f&&!a&&d.current!==b&&(d.current=b,p({inView:!!i,entry:void 0}));const h=[$,u.inView,u.entry];return h.ref=h[0],h.inView=h[1],h.entry=h[2],h}const{backgroundHoverd:ke,white:Ee,borderLight:_e}=Q.colors,_t=()=>{const e=le(),{user:n}=he(),{activeCluster:t}=ie(),g=({value:i})=>{e(Fe({_id:t._id,lang:i})).unwrap().then(l=>e(dt(l.result.cluster)))},c=({value:i})=>{e(Fe({_id:t._id,rate:i})).unwrap().then(l=>e(dt(l.result.cluster)))},f=({value:i})=>{const l=new FormData;l.append("lang",i),e(gt(l))},a=({value:i})=>{const l=new FormData;l.append("rate",i),e(gt(l))};return y.jsxs(He,{$m:"0",$cg:"8px",$ai:"center",$gtc:"2fr 2fr 2fr 2fr",children:[y.jsx(Te,{options:Re,defaultValue:Re.find(i=>i.value===(t==null?void 0:t.lang)),onChange:g,placeholder:"Language...",$ol:ke,$b:Ee,$bh:_e}),y.jsx(Te,{options:Ae,defaultValue:Ae.find(i=>i.value==(t==null?void 0:t.rate)),onChange:c,placeholder:"Rate...",$ol:ke,$b:Ee,$bh:_e}),y.jsx(Te,{options:Re,defaultValue:Re.find(i=>i.value===n.lang),onChange:f,placeholder:"Language...",$ol:ke,$b:Ee,$bh:_e}),y.jsx(Te,{options:Ae,defaultValue:Ae.find(i=>i.value==n.rate),onChange:a,placeholder:"Rate...",$ol:ke,$b:Ee,$bh:_e})]})};_t.propTypes={filtredElements:I.array,setLiColor:I.func};const{button:Un}=Q.shadows,qn=()=>{const e=le(),{user:n}=he(),{activeCluster:t}=ie();z.useEffect(()=>{const c=async f=>{f.key==="e"&&f.metaKey&&(f.preventDefault(),await g())};return addEventListener("keydown",c),()=>{removeEventListener("keydown",c)}},[]);const g=async c=>{const f=window.getSelection().toString();f&&await Et(f);const a=await kt();let i=Ve(a,t.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();i=Pe(i,",");const l={from:t.lang,to:n.lang};let k=await Ke(i,l,n.engine);k=Pe(k.trim(),",");const{_id:A}=t;try{const v={cluster:A,element:"[]",caption:i},$={cluster:A,element:i,caption:k,favorite:!0,checked:i.split(/\s+/).length<20},o=i.includes("https://")?v:$;e(Rt(o)).unwrap().then(()=>(c==null?void 0:c.target)&&ln()).finally(()=>{var u;return(u=c==null?void 0:c.target)==null?void 0:u.blur()})}catch(v){c==null||c.currentTarget.blur(),re.error(`Invalid element, ${v.message}`)}};return y.jsx(ue,{onClick:g,$s:"m",$round:!0,$bs:Un,children:y.jsx(cn,{size:18})})},{button:Hn}=Q.shadows,Kn=()=>{const e=le(),{elementTrash:n}=pe(),t=()=>{confirm("Are you sure you want to delete the selected Element(s)?")&&e(un(n.map(g=>g._id).join("&"))).unwrap().then(()=>e(pn()))};return y.jsx(ue,{onClick:t,$s:"m",$round:!0,$bs:Hn,children:y.jsx(Ln,{size:16})})};function Yn(e){return fn({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M250.73,210.63l-56-112a12,12,0,0,0-21.46,0l-20.52,41A84.2,84.2,0,0,1,114,126.22,107.48,107.48,0,0,0,139.33,68H160a12,12,0,0,0,0-24H108V32a12,12,0,0,0-24,0V44H32a12,12,0,0,0,0,24h83.13A83.69,83.69,0,0,1,96,110.35,84,84,0,0,1,83.6,91a12,12,0,1,0-21.81,10A107.55,107.55,0,0,0,78,126.24,83.54,83.54,0,0,1,32,140a12,12,0,0,0,0,24,107.47,107.47,0,0,0,64-21.07,108.4,108.4,0,0,0,45.39,19.44l-24.13,48.26a12,12,0,1,0,21.46,10.73L151.41,196h65.17l12.68,25.36a12,12,0,1,0,21.47-10.73ZM163.41,172,184,130.83,204.58,172Z"},child:[]}]})(e)}const{button:Qn}=Q.shadows,Zn=()=>{const{activeCluster:e}=ie();z.useEffect(()=>{const f=async a=>{a.metaKey&&a.key==="d"&&(a.preventDefault(),await c())};return addEventListener("keydown",f),()=>{removeEventListener("keydown",f)}},[]);let n=[];function t(f){f.forEach(a=>{const i=window.open(a,"_blank");i?n.push(i):re.error(`Failed to open tab: ${a}`)})}const g=()=>{n.forEach(f=>{f.close()}),n=[]},c=async()=>{const f=window.getSelection().toString();f&&await Et(f);const a=await kt();let i=[];e.lang.includes("de")&&i.push(`https://www.verbformen.com/conjugation/?w=${a}`),e.lang.includes("en")&&i.push(`https://dictionary.cambridge.org/dictionary/english-russian/${a}`),g(),t(i)};return y.jsx(ue,{onClick:c,$s:"m",$round:!0,$bs:Qn,children:y.jsx(Yn,{size:18})})};var Xn={exports:{}};(function(e){var n=function(t){var g=Object.prototype,c=g.hasOwnProperty,f=Object.defineProperty||function(s,r,m){s[r]=m.value},a,i=typeof Symbol=="function"?Symbol:{},l=i.iterator||"@@iterator",k=i.asyncIterator||"@@asyncIterator",A=i.toStringTag||"@@toStringTag";function v(s,r,m){return Object.defineProperty(s,r,{value:m,enumerable:!0,configurable:!0,writable:!0}),s[r]}try{v({},"")}catch{v=function(r,m,_){return r[m]=_}}function $(s,r,m,_){var R=r&&r.prototype instanceof S?r:S,M=Object.create(R.prototype),H=new W(_||[]);return f(M,"_invoke",{value:w(s,m,H)}),M}t.wrap=$;function o(s,r,m){try{return{type:"normal",arg:s.call(r,m)}}catch(_){return{type:"throw",arg:_}}}var u="suspendedStart",p="suspendedYield",b="executing",d="completed",h={};function S(){}function T(){}function L(){}var O={};v(O,l,function(){return this});var x=Object.getPrototypeOf,D=x&&x(x(P([])));D&&D!==g&&c.call(D,l)&&(O=D);var q=L.prototype=S.prototype=Object.create(O);T.prototype=L,f(q,"constructor",{value:L,configurable:!0}),f(L,"constructor",{value:T,configurable:!0}),T.displayName=v(L,A,"GeneratorFunction");function N(s){["next","throw","return"].forEach(function(r){v(s,r,function(m){return this._invoke(r,m)})})}t.isGeneratorFunction=function(s){var r=typeof s=="function"&&s.constructor;return r?r===T||(r.displayName||r.name)==="GeneratorFunction":!1},t.mark=function(s){return Object.setPrototypeOf?Object.setPrototypeOf(s,L):(s.__proto__=L,v(s,A,"GeneratorFunction")),s.prototype=Object.create(q),s},t.awrap=function(s){return{__await:s}};function B(s,r){function m(M,H,K,Z){var U=o(s[M],s,H);if(U.type==="throw")Z(U.arg);else{var ge=U.arg,ae=ge.value;return ae&&typeof ae=="object"&&c.call(ae,"__await")?r.resolve(ae.__await).then(function(ne){m("next",ne,K,Z)},function(ne){m("throw",ne,K,Z)}):r.resolve(ae).then(function(ne){ge.value=ne,K(ge)},function(ne){return m("throw",ne,K,Z)})}}var _;function R(M,H){function K(){return new r(function(Z,U){m(M,H,Z,U)})}return _=_?_.then(K,K):K()}f(this,"_invoke",{value:R})}N(B.prototype),v(B.prototype,k,function(){return this}),t.AsyncIterator=B,t.async=function(s,r,m,_,R){R===void 0&&(R=Promise);var M=new B($(s,r,m,_),R);return t.isGeneratorFunction(r)?M:M.next().then(function(H){return H.done?H.value:M.next()})};function w(s,r,m){var _=u;return function(M,H){if(_===b)throw new Error("Generator is already running");if(_===d){if(M==="throw")throw H;return V()}for(m.method=M,m.arg=H;;){var K=m.delegate;if(K){var Z=E(K,m);if(Z){if(Z===h)continue;return Z}}if(m.method==="next")m.sent=m._sent=m.arg;else if(m.method==="throw"){if(_===u)throw _=d,m.arg;m.dispatchException(m.arg)}else m.method==="return"&&m.abrupt("return",m.arg);_=b;var U=o(s,r,m);if(U.type==="normal"){if(_=m.done?d:p,U.arg===h)continue;return{value:U.arg,done:m.done}}else U.type==="throw"&&(_=d,m.method="throw",m.arg=U.arg)}}}function E(s,r){var m=r.method,_=s.iterator[m];if(_===a)return r.delegate=null,m==="throw"&&s.iterator.return&&(r.method="return",r.arg=a,E(s,r),r.method==="throw")||m!=="return"&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+m+"' method")),h;var R=o(_,s.iterator,r.arg);if(R.type==="throw")return r.method="throw",r.arg=R.arg,r.delegate=null,h;var M=R.arg;if(!M)return r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,h;if(M.done)r[s.resultName]=M.value,r.next=s.nextLoc,r.method!=="return"&&(r.method="next",r.arg=a);else return M;return r.delegate=null,h}N(q),v(q,A,"Generator"),v(q,l,function(){return this}),v(q,"toString",function(){return"[object Generator]"});function C(s){var r={tryLoc:s[0]};1 in s&&(r.catchLoc=s[1]),2 in s&&(r.finallyLoc=s[2],r.afterLoc=s[3]),this.tryEntries.push(r)}function j(s){var r=s.completion||{};r.type="normal",delete r.arg,s.completion=r}function W(s){this.tryEntries=[{tryLoc:"root"}],s.forEach(C,this),this.reset(!0)}t.keys=function(s){var r=Object(s),m=[];for(var _ in r)m.push(_);return m.reverse(),function R(){for(;m.length;){var M=m.pop();if(M in r)return R.value=M,R.done=!1,R}return R.done=!0,R}};function P(s){if(s!=null){var r=s[l];if(r)return r.call(s);if(typeof s.next=="function")return s;if(!isNaN(s.length)){var m=-1,_=function R(){for(;++m<s.length;)if(c.call(s,m))return R.value=s[m],R.done=!1,R;return R.value=a,R.done=!0,R};return _.next=_}}throw new TypeError(typeof s+" is not iterable")}t.values=P;function V(){return{value:a,done:!0}}return W.prototype={constructor:W,reset:function(s){if(this.prev=0,this.next=0,this.sent=this._sent=a,this.done=!1,this.delegate=null,this.method="next",this.arg=a,this.tryEntries.forEach(j),!s)for(var r in this)r.charAt(0)==="t"&&c.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=a)},stop:function(){this.done=!0;var s=this.tryEntries[0],r=s.completion;if(r.type==="throw")throw r.arg;return this.rval},dispatchException:function(s){if(this.done)throw s;var r=this;function m(Z,U){return M.type="throw",M.arg=s,r.next=Z,U&&(r.method="next",r.arg=a),!!U}for(var _=this.tryEntries.length-1;_>=0;--_){var R=this.tryEntries[_],M=R.completion;if(R.tryLoc==="root")return m("end");if(R.tryLoc<=this.prev){var H=c.call(R,"catchLoc"),K=c.call(R,"finallyLoc");if(H&&K){if(this.prev<R.catchLoc)return m(R.catchLoc,!0);if(this.prev<R.finallyLoc)return m(R.finallyLoc)}else if(H){if(this.prev<R.catchLoc)return m(R.catchLoc,!0)}else if(K){if(this.prev<R.finallyLoc)return m(R.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(s,r){for(var m=this.tryEntries.length-1;m>=0;--m){var _=this.tryEntries[m];if(_.tryLoc<=this.prev&&c.call(_,"finallyLoc")&&this.prev<_.finallyLoc){var R=_;break}}R&&(s==="break"||s==="continue")&&R.tryLoc<=r&&r<=R.finallyLoc&&(R=null);var M=R?R.completion:{};return M.type=s,M.arg=r,R?(this.method="next",this.next=R.finallyLoc,h):this.complete(M)},complete:function(s,r){if(s.type==="throw")throw s.arg;return s.type==="break"||s.type==="continue"?this.next=s.arg:s.type==="return"?(this.rval=this.arg=s.arg,this.method="return",this.next="end"):s.type==="normal"&&r&&(this.next=r),h},finish:function(s){for(var r=this.tryEntries.length-1;r>=0;--r){var m=this.tryEntries[r];if(m.finallyLoc===s)return this.complete(m.completion,m.afterLoc),j(m),h}},catch:function(s){for(var r=this.tryEntries.length-1;r>=0;--r){var m=this.tryEntries[r];if(m.tryLoc===s){var _=m.completion;if(_.type==="throw"){var R=_.arg;j(m)}return R}}throw new Error("illegal catch attempt")},delegateYield:function(s,r,m){return this.delegate={iterator:P(s),resultName:r,nextLoc:m},this.method==="next"&&(this.arg=a),h}},t}(e.exports);try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})(Xn);var be={},Lt={},X={};Object.defineProperty(X,"__esModule",{value:!0});X.browserSupportsPolyfills=X.compareTwoStringsUsingDiceCoefficient=X.commandToRegExp=X.concatTranscripts=X.debounce=void 0;var Jn=function(n,t,g){var c;return function(){var f=this,a=arguments,i=function(){c=null,g||n.apply(f,a)},l=g&&!c;clearTimeout(c),c=setTimeout(i,t),l&&n.apply(f,a)}};X.debounce=Jn;var er=function(){for(var n=arguments.length,t=new Array(n),g=0;g<n;g++)t[g]=arguments[g];return t.map(function(c){return c.trim()}).join(" ").trim()};X.concatTranscripts=er;var tr=/\s*\((.*?)\)\s*/g,nr=/(\(\?:[^)]+\))\?/g,rr=/(\(\?)?:\w+/g,ir=/\*/g,sr=/[-{}[\]+?.,\\^$|#]/g,ar=function(n){return n instanceof RegExp?new RegExp(n.source,"i"):(n=n.replace(sr,"\\$&").replace(tr,"(?:$1)?").replace(rr,function(t,g){return g?t:"([^\\s]+)"}).replace(ir,"(.*?)").replace(nr,"\\s*$1?\\s*"),new RegExp("^"+n+"$","i"))};X.commandToRegExp=ar;var or=function(n,t){if(n=n.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!n.length&&!t.length)return 1;if(!n.length||!t.length)return 0;if(n===t)return 1;if(n.length===1&&t.length===1||n.length<2||t.length<2)return 0;for(var g=new Map,c=0;c<n.length-1;c++){var f=n.substring(c,c+2),a=g.has(f)?g.get(f)+1:1;g.set(f,a)}for(var i=0,l=0;l<t.length-1;l++){var k=t.substring(l,l+2),A=g.has(k)?g.get(k):0;A>0&&(g.set(k,A-1),i++)}return 2*i/(n.length+t.length-2)};X.compareTwoStringsUsingDiceCoefficient=or;var cr=function(){return typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0)};X.browserSupportsPolyfills=cr;var fe={},ce={};Object.defineProperty(ce,"__esModule",{value:!0});ce.APPEND_TRANSCRIPT=ce.CLEAR_TRANSCRIPT=void 0;var lr="CLEAR_TRANSCRIPT";ce.CLEAR_TRANSCRIPT=lr;var ur="APPEND_TRANSCRIPT";ce.APPEND_TRANSCRIPT=ur;Object.defineProperty(fe,"__esModule",{value:!0});fe.appendTranscript=fe.clearTranscript=void 0;var xt=ce,pr=function(){return{type:xt.CLEAR_TRANSCRIPT}};fe.clearTranscript=pr;var fr=function(n,t){return{type:xt.APPEND_TRANSCRIPT,payload:{interimTranscript:n,finalTranscript:t}}};fe.appendTranscript=fr;var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0});Oe.transcriptReducer=void 0;var bt=ce,hr=X,dr=function(n,t){switch(t.type){case bt.CLEAR_TRANSCRIPT:return{interimTranscript:"",finalTranscript:""};case bt.APPEND_TRANSCRIPT:return{interimTranscript:t.payload.interimTranscript,finalTranscript:(0,hr.concatTranscripts)(n.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};Oe.transcriptReducer=dr;var jt={},Ye={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){return/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"")};e.default=n})(Ye);var Qe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.isNative=void 0;var n=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),t=function(f){return f===n};e.isNative=t;var g=n;e.default=g})(Qe);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=c(Ye),t=X,g=Qe;function c(v){return v&&v.__esModule?v:{default:v}}function f(v,$,o,u,p,b,d){try{var h=v[b](d),S=h.value}catch(T){o(T);return}h.done?$(S):Promise.resolve(S).then(u,p)}function a(v){return function(){var $=this,o=arguments;return new Promise(function(u,p){var b=v.apply($,o);function d(S){f(b,u,p,d,h,"next",S)}function h(S){f(b,u,p,d,h,"throw",S)}d(void 0)})}}function i(v,$){if(!(v instanceof $))throw new TypeError("Cannot call a class as a function")}function l(v,$){for(var o=0;o<$.length;o++){var u=$[o];u.enumerable=u.enumerable||!1,u.configurable=!0,"value"in u&&(u.writable=!0),Object.defineProperty(v,u.key,u)}}function k(v,$,o){return $&&l(v.prototype,$),o&&l(v,o),v}var A=function(){function v($){i(this,v),this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=function(){},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition($),(0,n.default)()&&(this.updateFinalTranscript=(0,t.debounce)(this.updateFinalTranscript,250,!0))}return k(v,[{key:"setSpeechRecognition",value:function(o){var u=!!o&&((0,g.isNative)(o)||(0,t.browserSupportsPolyfills)());u&&(this.disableRecognition(),this.recognition=new o,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(u)}},{key:"subscribe",value:function(o,u){this.subscribers[o]=u}},{key:"unsubscribe",value:function(o){delete this.subscribers[o]}},{key:"emitListeningChange",value:function(o){var u=this;this.listening=o,Object.keys(this.subscribers).forEach(function(p){var b=u.subscribers[p].onListeningChange;b(o)})}},{key:"emitMicrophoneAvailabilityChange",value:function(o){var u=this;this.isMicrophoneAvailable=o,Object.keys(this.subscribers).forEach(function(p){var b=u.subscribers[p].onMicrophoneAvailabilityChange;b(o)})}},{key:"emitTranscriptChange",value:function(o,u){var p=this;Object.keys(this.subscribers).forEach(function(b){var d=p.subscribers[b].onTranscriptChange;d(o,u)})}},{key:"emitClearTranscript",value:function(){var o=this;Object.keys(this.subscribers).forEach(function(u){var p=o.subscribers[u].onClearTranscript;p()})}},{key:"emitBrowserSupportsSpeechRecognitionChange",value:function(o){var u=this;Object.keys(this.subscribers).forEach(function(p){var b=u.subscribers[p],d=b.onBrowserSupportsSpeechRecognitionChange,h=b.onBrowserSupportsContinuousListeningChange;d(o),h(o)})}},{key:"disconnect",value:function(o){if(this.recognition&&this.listening)switch(o){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}},{key:"disableRecognition",value:function(){this.recognition&&(this.recognition.onresult=function(){},this.recognition.onend=function(){},this.recognition.onerror=function(){},this.listening&&this.stopListening())}},{key:"onError",value:function(o){o&&o.error&&o.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}},{key:"onRecognitionDisconnect",value:function(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}},{key:"updateTranscript",value:function(o){var u=o.results,p=o.resultIndex,b=p===void 0?u.length-1:p;this.interimTranscript="",this.finalTranscript="";for(var d=b;d<u.length;++d)u[d].isFinal&&(!(0,n.default)()||u[d][0].confidence>0)?this.updateFinalTranscript(u[d][0].transcript):this.interimTranscript=(0,t.concatTranscripts)(this.interimTranscript,u[d][0].transcript);var h=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(h=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,h||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}},{key:"updateFinalTranscript",value:function(o){this.finalTranscript=(0,t.concatTranscripts)(this.finalTranscript,o)}},{key:"resetTranscript",value:function(){this.disconnect("RESET")}},{key:"startListening",value:function(){var $=a(regeneratorRuntime.mark(function u(){var p,b,d,h,S,T,L=arguments;return regeneratorRuntime.wrap(function(x){for(;;)switch(x.prev=x.next){case 0:if(p=L.length>0&&L[0]!==void 0?L[0]:{},b=p.continuous,d=b===void 0?!1:b,h=p.language,this.recognition){x.next=3;break}return x.abrupt("return");case 3:if(S=d!==this.recognition.continuous,T=h&&h!==this.recognition.lang,!(S||T)){x.next=11;break}if(!this.listening){x.next=9;break}return x.next=9,this.stopListening();case 9:this.recognition.continuous=S?d:this.recognition.continuous,this.recognition.lang=T?h:this.recognition.lang;case 11:if(this.listening){x.next=22;break}return this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript()),x.prev=13,x.next=16,this.start();case 16:this.emitListeningChange(!0),x.next=22;break;case 19:x.prev=19,x.t0=x.catch(13),x.t0 instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1);case 22:case"end":return x.stop()}},u,this,[[13,19]])}));function o(){return $.apply(this,arguments)}return o}()},{key:"abortListening",value:function(){var $=a(regeneratorRuntime.mark(function u(){var p=this;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.disconnect("ABORT"),this.emitListeningChange(!1),d.next=4,new Promise(function(h){p.onStopListening=h});case 4:case"end":return d.stop()}},u,this)}));function o(){return $.apply(this,arguments)}return o}()},{key:"stopListening",value:function(){var $=a(regeneratorRuntime.mark(function u(){var p=this;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return this.disconnect("STOP"),this.emitListeningChange(!1),d.next=4,new Promise(function(h){p.onStopListening=h});case 4:case"end":return d.stop()}},u,this)}));function o(){return $.apply(this,arguments)}return o}()},{key:"getRecognition",value:function(){return this.recognition}},{key:"start",value:function(){var $=a(regeneratorRuntime.mark(function u(){return regeneratorRuntime.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:if(!(this.recognition&&!this.listening)){b.next=4;break}return b.next=3,this.recognition.start();case 3:this.listening=!0;case 4:case"end":return b.stop()}},u,this)}));function o(){return $.apply(this,arguments)}return o}()},{key:"stop",value:function(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}},{key:"abort",value:function(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}}]),v}();e.default=A})(jt);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.useSpeechRecognition=void 0;var n=z,t=X,g=fe,c=Oe,f=l(jt),a=l(Ye),i=l(Qe);function l(w){return w&&w.__esModule?w:{default:w}}function k(w,E,C,j,W,P,V){try{var s=w[P](V),r=s.value}catch(m){C(m);return}s.done?E(r):Promise.resolve(r).then(j,W)}function A(w){return function(){var E=this,C=arguments;return new Promise(function(j,W){var P=w.apply(E,C);function V(r){k(P,j,W,V,s,"next",r)}function s(r){k(P,j,W,V,s,"throw",r)}V(void 0)})}}function v(w){return u(w)||o(w)||h(w)||$()}function $(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function o(w){if(typeof Symbol<"u"&&Symbol.iterator in Object(w))return Array.from(w)}function u(w){if(Array.isArray(w))return S(w)}function p(w){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?p=function(C){return typeof C}:p=function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},p(w)}function b(w,E){return L(w)||T(w,E)||h(w,E)||d()}function d(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function h(w,E){if(w){if(typeof w=="string")return S(w,E);var C=Object.prototype.toString.call(w).slice(8,-1);if(C==="Object"&&w.constructor&&(C=w.constructor.name),C==="Map"||C==="Set")return Array.from(w);if(C==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(C))return S(w,E)}}function S(w,E){(E==null||E>w.length)&&(E=w.length);for(var C=0,j=new Array(E);C<E;C++)j[C]=w[C];return j}function T(w,E){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(w)))){var C=[],j=!0,W=!1,P=void 0;try{for(var V=w[Symbol.iterator](),s;!(j=(s=V.next()).done)&&(C.push(s.value),!(E&&C.length===E));j=!0);}catch(r){W=!0,P=r}finally{try{!j&&V.return!=null&&V.return()}finally{if(W)throw P}}return C}}function L(w){if(Array.isArray(w))return w}var O=!!i.default,x=O&&!(0,a.default)(),D,q=function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},C=E.transcribing,j=C===void 0?!0:C,W=E.clearTranscriptOnListen,P=W===void 0?!0:W,V=E.commands,s=V===void 0?[]:V,r=(0,n.useState)(N.getRecognitionManager()),m=b(r,1),_=m[0],R=(0,n.useState)(O),M=b(R,2),H=M[0],K=M[1],Z=(0,n.useState)(x),U=b(Z,2),ge=U[0],ae=U[1],ne=(0,n.useReducer)(c.transcriptReducer,{interimTranscript:_.interimTranscript,finalTranscript:""}),Xe=b(ne,2),Je=Xe[0],et=Je.interimTranscript,tt=Je.finalTranscript,nt=Xe[1],Ft=(0,n.useState)(_.listening),rt=b(Ft,2),Gt=rt[0],Vt=rt[1],Ut=(0,n.useState)(_.isMicrophoneAvailable),it=b(Ut,2),qt=it[0],Ht=it[1],st=(0,n.useRef)(s);st.current=s;var at=function(){nt((0,g.clearTranscript)())},me=(0,n.useCallback)(function(){_.resetTranscript(),at()},[_]),Kt=function(Y,te,oe){var se=p(Y)==="object"?Y.toString():Y,ve=se.replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),we=(0,t.compareTwoStringsUsingDiceCoefficient)(ve,te);return we>=oe?{command:Y,commandWithoutSpecials:ve,howSimilar:we,isFuzzyMatch:!0}:null},Yt=function(Y,te){var oe=(0,t.commandToRegExp)(Y),se=oe.exec(te);return se?{command:Y,parameters:se.slice(1)}:null},ot=(0,n.useCallback)(function(ee,Y){st.current.forEach(function(te){var oe=te.command,se=te.callback,ve=te.matchInterim,we=ve===void 0?!1:ve,ut=te.isFuzzyMatch,pt=ut===void 0?!1:ut,ft=te.fuzzyMatchingThreshold,Zt=ft===void 0?.8:ft,ht=te.bestMatchOnly,Xt=ht===void 0?!1:ht,$e=!Y&&we?ee.trim():Y.trim(),Jt=Array.isArray(oe)?oe:[oe],Se=Jt.map(function(J){return pt?Kt(J,$e,Zt):Yt(J,$e)}).filter(function(J){return J});if(pt&&Xt&&Se.length>=2){Se.sort(function(J,Ie){return Ie.howSimilar-J.howSimilar});var De=Se[0],en=De.command,tn=De.commandWithoutSpecials,nn=De.howSimilar;se(tn,$e,nn,{command:en,resetTranscript:me})}else Se.forEach(function(J){if(J.isFuzzyMatch){var Ie=J.command,rn=J.commandWithoutSpecials,sn=J.howSimilar;se(rn,$e,sn,{command:Ie,resetTranscript:me})}else{var an=J.command,on=J.parameters;se.apply(void 0,v(on).concat([{command:an,resetTranscript:me}]))}})})},[me]),ct=(0,n.useCallback)(function(ee,Y){j&&nt((0,g.appendTranscript)(ee,Y)),ot(ee,Y)},[ot,j]),lt=(0,n.useCallback)(function(){P&&at()},[P]);(0,n.useEffect)(function(){var ee=N.counter;N.counter+=1;var Y={onListeningChange:Vt,onMicrophoneAvailabilityChange:Ht,onTranscriptChange:ct,onClearTranscript:lt,onBrowserSupportsSpeechRecognitionChange:K,onBrowserSupportsContinuousListeningChange:ae};return _.subscribe(ee,Y),function(){_.unsubscribe(ee)}},[j,P,_,ct,lt]);var Qt=(0,t.concatTranscripts)(tt,et);return{transcript:Qt,interimTranscript:et,finalTranscript:tt,listening:Gt,isMicrophoneAvailable:qt,resetTranscript:me,browserSupportsSpeechRecognition:H,browserSupportsContinuousListening:ge}};e.useSpeechRecognition=q;var N={counter:0,applyPolyfill:function(E){D?D.setSpeechRecognition(E):D=new f.default(E);var C=!!E&&(0,t.browserSupportsPolyfills)();O=C,x=C},removePolyfill:function(){D?D.setSpeechRecognition(i.default):D=new f.default(i.default),O=!!i.default,x=O&&!(0,a.default)()},getRecognitionManager:function(){return D||(D=new f.default(i.default)),D},getRecognition:function(){var E=N.getRecognitionManager();return E.getRecognition()},startListening:function(){var w=A(regeneratorRuntime.mark(function C(){var j,W,P,V,s=arguments;return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return j=s.length>0&&s[0]!==void 0?s[0]:{},W=j.continuous,P=j.language,V=N.getRecognitionManager(),m.next=4,V.startListening({continuous:W,language:P});case 4:case"end":return m.stop()}},C)}));function E(){return w.apply(this,arguments)}return E}(),stopListening:function(){var w=A(regeneratorRuntime.mark(function C(){var j;return regeneratorRuntime.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return j=N.getRecognitionManager(),P.next=3,j.stopListening();case 3:case"end":return P.stop()}},C)}));function E(){return w.apply(this,arguments)}return E}(),abortListening:function(){var w=A(regeneratorRuntime.mark(function C(){var j;return regeneratorRuntime.wrap(function(P){for(;;)switch(P.prev=P.next){case 0:return j=N.getRecognitionManager(),P.next=3,j.abortListening();case 3:case"end":return P.stop()}},C)}));function E(){return w.apply(this,arguments)}return E}(),browserSupportsSpeechRecognition:function(){return O},browserSupportsContinuousListening:function(){return x}},B=N;e.default=B})(Lt);(function(e){function n(a){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(l){return typeof l}:n=function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},n(a)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"useSpeechRecognition",{enumerable:!0,get:function(){return t.useSpeechRecognition}}),e.default=void 0;var t=c(Lt);function g(){if(typeof WeakMap!="function")return null;var a=new WeakMap;return g=function(){return a},a}function c(a){if(a&&a.__esModule)return a;if(a===null||n(a)!=="object"&&typeof a!="function")return{default:a};var i=g();if(i&&i.has(a))return i.get(a);var l={},k=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var A in a)if(Object.prototype.hasOwnProperty.call(a,A)){var v=k?Object.getOwnPropertyDescriptor(a,A):null;v&&(v.get||v.set)?Object.defineProperty(l,A,v):l[A]=a[A]}return l.default=a,i&&i.set(a,l),l}var f=t.default;e.default=f})(be);const Le=hn(be),{colors:G,shadows:yt,indents:Ne}=Q,gr=ye`
  margin-bottom: 7px;
  padding-block: ${Ne.xs};

  display: grid;
  align-items: center;
  grid-template-columns: 1fr 25fr 1fr;

  border: 1px solid transparent;
  background-color: ${({licolor:e})=>e};
  border-radius: ${Ne.xs};
  font-size: 22px;

  &:last-of-type {
    margin-bottom: ${Ne.s};
  }
`,mr=F.li`
  ${gr}

  transition: box-shadow 250ms, border-color 250ms;

  &#active-element {
    border-color: ${G.border};
    background-color: ${G.background};
    box-shadow: ${yt.back};

    &:hover {
      border-color: ${G.accent};
    }
    & div button {
      transition: color 250ms;
      color: ${G.smokeBlack};
      &:hover {
        color: ${G.hovered};
      }
    }
  }

  & div button {
    transition: color 250ms;
    &:hover {
      color: ${G.hovered};
    }
  }

  &:hover {
    border-color: ${G.accent};
    box-shadow: ${yt.back};
  }

  &:hover label,
  &:hover button {
    opacity: 1;
  }
`,Pt=ye`
  min-height: 19px;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  & input {
    ${jn}
  }
`,vr=F.label`
  ${Pt}

  & svg {
    transition: stroke 250ms;
    stroke-width: 2px;
    color: ${({$hovered:e})=>e?G.yellow:"transparent"};
    stroke: ${({$hovered:e})=>e?G.yellow:G.border};
  }
  &:hover svg {
    stroke: ${G.placeholder};
  }
`,br=F.label`
  ${Pt}
  opacity: ${({$hovered:e})=>e?1:0};
  transition: opacity 250ms;

  & svg {
    transition: border-color 250ms, color 250ms;
    padding: 1px;
    border: 2px solid ${G.border};
    border-radius: 50%;
    color: ${({$hovered:e})=>e?G.border:"transparent"};
  }
  &:hover svg {
    border-color: ${G.placeholder};
    color: ${({$hovered:e})=>e?G.placeholder:"transparent"};
  }
`,de=ye`
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: transparent;
  border-color: transparent;
  transition: opacity 250ms color 250ms;
  color: ${G.black};

  & svg {
    transition: color 250ms;
    color: ${G.border};
  }
  &:hover,
  &:hover svg {
    color: ${G.placeholder};
  }
`,yr=F.button`
  ${de}

  opacity: ${({$hovered:e})=>e?1:0};
`,wr=F.button`
  ${de}

  opacity: 0;
`,{colors:Me,indents:Mt}=Q,Ot=ye`
  padding-block: 4px;
  display: grid;
  align-items: start;
  grid-template-columns: 20fr 1fr 20fr;
`,$r=F.div`
  ${Ot}
`,Sr=F.form`
  ${Ot}

  max-height: 70vh;
  overflow-y: scroll;
  scrollbar-width: none;
  grid-template-columns: 12fr 1fr 12fr;
`,wt=F.textarea`
  height: 84px;
  outline: none;
  border: 1px solid ${Me.accent};
  border-radius: ${Mt.xs};
  resize: none;
  overflow: clip;
  transition: height 150ms;
`,Tr=F.div`
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  &::after {
    content: '';
    height: calc(100% - 8px);
    width: 1px;
    border: 1px solid ${Me.borderLight};
    transition: border-color 250ms;
  }

  &:hover::after {
    border-color: ${Me.placeholder};
  }
`,Rr=F.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,Ar=F.button`
  ${de}
`;F.button`
  ${de}
`;const qe=F.button`
  ${de}
`,Cr=F.button`
  ${de}
`,$t=F.button`
  height: 100%;
  text-align: left;
  display: flex;
  align-items: top;
  background-color: transparent;
  border-color: transparent;
  border-radius: ${Mt.xs};
  color: ${Me.black};
  transition: background-color 250ms;
`,Dt=ye`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
`,kr=F.iframe`
  ${Dt}

  height: 60px;
  border-radius: 30px;
`,Er=F.audio`
  ${Dt}
`,Ze=({el:e,setIsForm:n})=>{const t=le(),g=z.useRef(null),c=z.useRef(null),f=z.useRef(null),{user:a}=he(),{activeCluster:i}=ie(),[l,k]=z.useState(""),{_id:A,element:v,caption:$}=e,{register:o,watch:u,setValue:p,handleSubmit:b,setFocus:d}=Pn({mode:"onBlur",defaultValues:{element:v,caption:$}}),{ref:h,...S}=o("element"),{ref:T,...L}=o("caption"),O=[g.current,c.current,f.current],x=[u("caption"),u("element")];zn(O,x),z.useEffect(()=>{d("element"),l&&v.trim().startsWith("der")?p("element",l+v.replace("der","").trim()+", "):l&&v.trim().startsWith("die")?p("element",l+v.replace("die","").trim()+", "):l&&v.trim().startsWith("das")?p("element",l+v.replace("das","").trim()+", "):l?p("element",l+v+", "):p("element",l+v)},[l,v,d,p]),z.useEffect(()=>{const B=async w=>{(w.code==="NumpadAdd"||w.ctrlKey&&w.key==="Escape")&&(w.preventDefault(),await N(a.engine),b(D)()),w.key==="Enter"&&(w.preventDefault(),b(D)()),w.key==="Escape"&&n(!1)};return addEventListener("keydown",B),()=>{removeEventListener("keydown",B)}},[]);const D=B=>{const w=a.lang;let E=B.caption.trim(),C=Ve(B.element,i.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();C=Pe(C,","),E=Pe(E,","),a.lang.includes("en")&&i.lang.includes("de")&&(C.includes("hat")||C.includes("ist"))&&C.split(`
`)[0].split(/,\s+/)[0].endsWith("n")&&(E=E.split(/,\s+/).map(P=>P.startsWith("to ")?P:`to ${P}`).join(", ")),t(A?xe({_id:A,lang:w,element:C,caption:E}):Rt({...e,caption:E})).then(t(At())),n(!1)},q=()=>{l===""&&k("der "),l==="der "&&k("die "),l==="die "&&k("das "),l==="das "&&k("")},N=async B=>{const w=u("element"),E=Ve(w,i.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim(),C={from:i.lang,to:a.lang},j=await Ke(E,C,B);p("caption",j)};return y.jsxs(Sr,{onSubmit:b(D),children:[y.jsx(wt,{...S,name:"element",ref:B=>{h(B),g.current=B}}),y.jsxs(Rr,{ref:f,children:[y.jsx(Cr,{type:"button",onClick:q,children:y.jsx(Mn,{size:"18px"})}),y.jsx(qe,{type:"button",onClick:()=>N("google"),children:y.jsx(dn,{size:"16px"})}),y.jsx(qe,{type:"button",onClick:()=>N("deepl"),children:y.jsx(gn,{size:"18px"})}),y.jsx(Ar,{children:y.jsx(mn,{size:"16px"})})]}),y.jsx(wt,{...L,name:"caption",ref:B=>{T(B),c.current=B}})]})};Ze.propTypes={el:I.object,setIsForm:I.func};const{button:_r}=Q.shadows,{l:Lr,xxl:qr}=Q.indents,xr=()=>{const[e,n]=z.useState(!1),{activeCluster:t}=ie(),[g,c]=z.useState(""),{transcript:f,listening:a,resetTranscript:i}=be.useSpeechRecognition(),{isMicrophoneAvailable:l}=be.useSpeechRecognition(),{browserSupportsSpeechRecognition:k}=be.useSpeechRecognition(),A=g.endsWith(", ")?f:f.replace(/^./,o=>o.toUpperCase()),v=`${g}${A}`;if(z.useEffect(()=>{if(!a)return;const o=(b,d)=>b.trim().endsWith(d)?`${b.trim()} `:`${b.trim()}${d} `,u=[".","?","!",","],p=b=>{if(u.includes(b.key)){b.preventDefault();const d=o(v,b.key);c(d),i()}if(b.key==="Backspace"){b.preventDefault();const d=v.substring(0,v.length-1);c(d),i()}if(b.code==="Space"){b.preventDefault();const d=v+" ";c(d),i()}};return addEventListener("keydown",p),()=>{removeEventListener("keydown",p)}},[v,a,g,i]),z.useEffect(()=>{const o=u=>{u.metaKey&&u.key==="r"&&(u.preventDefault(),a?(Le.stopListening(),i()):(c(""),n(!0),Le.startListening({language:t.lang,continuous:!0})))};return addEventListener("keydown",o),()=>{removeEventListener("keydown",o)}},[t.lang,a,i]),!k||!l)return;const $=o=>{a?(Le.stopListening(),i()):(c(""),n(!0),Le.startListening({language:t.lang,continuous:!0})),o==null||o.currentTarget.blur()};return y.jsxs(y.Fragment,{children:[y.jsx(ue,{onClick:$,$s:"m",$round:!0,$bs:_r,children:a?y.jsx(bn,{size:18}):y.jsx(vn,{size:18})}),e&&y.jsx(yn,{$x:`left: ${Lr}`,$y:"top: 50%",$bd:"none",onClick:()=>n(!1),children:y.jsx(Ze,{el:{cluster:t._id,element:v,favorite:!0,checked:v.split(/\s+/).length<20},setIsForm:()=>null})})]})},{m:jr,s:Pr}=Q.indents,It=({className:e})=>{const{pathname:n}=wn(),{elementTrash:t}=pe(),{activeCluster:g}=ie(),c=t.length>0?" 1fr":"",f=g?" 1fr":"",a=c+f+" 1fr 1fr";if(n.includes("/element"))return y.jsxs(He,{className:e,$m:`${Pr} ${jr}`,$pos:"fixed",$side:"left",$high:"bottom",$gtc:a,children:[y.jsx(Zn,{}),y.jsx(xr,{}),f&&y.jsx(qn,{}),c&&y.jsx(Kn,{})]})};It.propTypes={className:I.string};const{colors:Be}=Q,Mr=F.div`
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  &:hover svg {
    stroke: ${Be.yellow};
  }

  & svg {
    transition: stroke 250ms;
    stroke: ${Be.hovered};
    /* stroke: ${({$colored:e})=>e&&Be.yellow}; */
    @keyframes refresh-spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(-360deg);
      }
    }
    animation: refresh-spin infinite 12s linear;
  }
`,zt=({onClick:e})=>y.jsx(Mr,{onClick:e,children:y.jsx($n,{size:"35px"})});zt.propTypes={onClick:I.func};const{background:We}=Q.colors,{button:St}=Q.shadows,{m:Or,s:Dr}=Q.indents,Nt=({className:e,filtredElements:n,setLiColor:t})=>{const{user:g}=he(),{activeCluster:c}=ie(),{activeElement:f}=pe(),a=o=>{if(!o.length)return;let u="",p=0;const b=o.reduce((d,h)=>(d[h.lang]||(d[h.lang]=0),d[h.lang]+=1,d),{});for(const d in b)b[d]>p&&(p=b[d],u=d);return u},i=n.length?a(n):g.lang,l=(o,u)=>o.replaceAll(", `",`;${u} `).replaceAll(" `",`${u} `).replaceAll(",`",";"),k=({text:o,playList:u,divider:p})=>{let b="";for(let d=0;d<u.length;d+=1){let h=u[d][o];h.endsWith(".")||h.endsWith("!")||h.endsWith("?")||h.endsWith('"')?(b+=l(h,p).replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",`__${p}`).replaceAll(".",`.${p}`).replaceAll(",",`,${p}`).replaceAll("!",`!${p}`).replaceAll("?",`?${p}`).replaceAll(": ",`:${p} `),c.lang.includes("de")&&(b=b.replaceAll(`0.${p}`,"0.").replaceAll(`1.${p}`,"1.").replaceAll(`2.${p}`,"2.").replaceAll(`3.${p}`,"3.").replaceAll(`4.${p}`,"4.").replaceAll(`5.${p}`,"5.").replaceAll(`6.${p}`,"6.").replaceAll(`7.${p}`,"7.").replaceAll(`8.${p}`,"8.").replaceAll(`9.${p}`,"9.")),b=b.replaceAll(`${p}`,o==="caption"?`@±@${u[d].lang}${p}`:`${p}`)):u[d].element.startsWith("[")||(o==="caption"&&(h.includes(" [")&&(h=h.substring(0,h.indexOf(" ["))),h=`${h}@±@${u[d].lang}`),b+=h+p)}return b},A=o=>{t(We);const u="$*@",p=n.findIndex(h=>h.element===f.element),b=n.splice(p===-1?0:p),d=je({setLiColor:t,divider:u,text:k({text:"element",playList:b,divider:u}),lang:c.lang,rate:c.rate});o.currentTarget.blur(),d&&re.error(d)},v=o=>{const u="$*@";t(We);const p=n.findIndex(h=>h.element===f.element),b=n.splice(p===-1?0:p),d=je({setLiColor:t,divider:u,text:k({text:"caption",playList:b,divider:u}),lang:i,rate:g.rate});o.currentTarget.blur(),d&&re.error(d)},$=o=>{t(We);let u="";const p="$*@",b=n.findIndex(S=>S.element===f.element),d=n.splice(b===-1?0:b);for(let S=0;S<d.length;S+=1){const{element:T,caption:L,lang:O}=d[S];if(!T.startsWith("[")){const x=l(T,""),D=L.includes(" [")?L.substring(0,L.indexOf(" [")):l(L,"");u+=x+`@±@${O}`+D+p}}const h=Sn({setLiColor:t,divider:p,text:u,lang:c.lang,rate:g.rate});o.currentTarget.blur(),h&&re.error(h)};return y.jsxs(He,{className:e,$m:`${Dr} ${Or}`,$pos:"fixed",$side:"right",$high:"bottom",$gtc:"1fr 0.5fr 1fr",children:[y.jsx(ue,{onClick:A,$s:"m",$round:!0,$bs:St,children:(c==null?void 0:c.lang.at(0).toUpperCase())+(c==null?void 0:c.lang.substring(1))}),y.jsx(zt,{onClick:$}),y.jsx(ue,{onClick:v,$s:"m",$round:!0,$bs:St,children:(i==null?void 0:i.at(0).toUpperCase())+(i==null?void 0:i.substring(1))})]})};Nt.propTypes={className:I.string,filtredElements:I.array,setLiColor:I.func};const Bt=({el:e,sortByDate:n,setSortByDate:t,setLiColor:g})=>{const c=le(),{user:f}=he(),{activeCluster:a}=ie(),{element:i,caption:l}=e,k="$*@",A=(h,S)=>{let T="";return S?(h.trim().endsWith(".")||h.trim().endsWith("!")||h.trim().endsWith("?")||h.endsWith('"')?(T=h.trim().replaceAll(", `",`;${S} `).replaceAll(" `",`${S} `).replaceAll(",`",";").replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",`__${S}`).replaceAll(".",`.${S}`).replaceAll(",",`,${S}`).replaceAll("!",`!${S}`).replaceAll("?",`?${S}`).replaceAll(": ",`:${S} `),a.lang.includes("de")&&(T=T.replaceAll(`0.${S}`,"0.").replaceAll(`1.${S}`,"1.").replaceAll(`2.${S}`,"2.").replaceAll(`3.${S}`,"3.").replaceAll(`4.${S}`,"4.").replaceAll(`5.${S}`,"5.").replaceAll(`6.${S}`,"6.").replaceAll(`7.${S}`,"7.").replaceAll(`8.${S}`,"8.").replaceAll(`9.${S}`,"9."))):T=h.trim()+S,T.includes("[")?T.substring(0,T.indexOf("["))+S:T):h},v=h=>{const S=je({setLiColor:g,divider:k,text:A(i,k),lang:a.lang,rate:a.rate});h.currentTarget.blur(),S&&re.error(S)},$=h=>{const S=je({setLiColor:g,divider:k,text:A(l,k),lang:e.lang,rate:f.rate});h.currentTarget.blur(),S&&re.error(S)},o=h=>{t(!n),n?re.success("Below is Recent"):re.success("Above is Recent"),h.stopPropagation()},u=h=>{const{_id:S}=a;c(Ct(e)),h.currentTarget.closest("li").id!=="active-element"&&c(Fe({_id:S,activeEl:e._id}))},p=l.endsWith("mp3"),b=!p&&l.startsWith("http"),d=!p&&!b;return y.jsxs($r,{onClick:u,children:[y.jsx($t,{onClick:v,children:i}),y.jsx(Tr,{onClick:o}),p&&y.jsx(Er,{controls:!0,src:mt(l)}),b&&y.jsx(kr,{src:mt(l)}),d&&y.jsx($t,{onClick:$,children:l})]})};Bt.propTypes={el:I.object,sortByDate:I.bool,setSortByDate:I.func,$active:I.bool,$hovered:I.bool,setLiColor:I.func};const Wt=({el:e,index:n,length:t,sortByDate:g,setSortByDate:c,translateAll:f,liColor:a,setLiColor:i})=>{const l=le(),{elementTrash:k,activeElement:A}=pe(),[v,$]=z.useState(!1),{_id:o,favorite:u,checked:p}=e,b=k.find(O=>O._id===o),d=()=>{l(xe({_id:o,favorite:!u}))},h=()=>{l(xe({_id:o,checked:!p}))},S=()=>l(kn(e)),T=()=>$(!v),L=o===(A==null?void 0:A._id);return y.jsxs(mr,{id:L?"active-element":null,licolor:a,children:[y.jsxs(Ge,{$h:"100%",$p:"0",$fd:"column",children:[y.jsxs(vr,{$hovered:u,children:[y.jsx("input",{type:"checkbox",name:"favorite",checked:u,onChange:d}),y.jsx(xn,{size:"20px"})]}),y.jsxs(br,{$hovered:p,children:[y.jsx("input",{type:"checkbox",name:"checked",checked:p,onChange:h}),y.jsx(Tn,{size:"15px"})]}),v&&t===n+1&&y.jsx(qe,{onClick:f,children:y.jsx(Rn,{size:"16px"})})]}),v&&y.jsx(Ze,{el:e,setIsForm:$}),!v&&y.jsx(Bt,{el:e,sortByDate:g,setSortByDate:c,setLiColor:i}),y.jsxs(Ge,{$h:"100%",$p:"0",$fd:"column",children:[y.jsx(yr,{$hovered:b,onClick:S,children:y.jsx(An,{size:"16px"})}),y.jsx(wr,{onClick:T,children:y.jsx(Cn,{size:"15px"})})]})]})};Wt.propTypes={el:I.object,index:I.number,length:I.number,sortByDate:I.bool,setSortByDate:I.func,translateAll:I.func,liColor:I.string,setLiColor:I.func};const Ir=F.ul`
  width: 100%;
  list-style: none;
`,{white:zr}=Q.colors,Nr=()=>{const e=le(),{ref:n,inView:t,entry:g}=Vn({initialInView:!0,rootMargin:"0px 0px -30px 0px"}),{user:c}=he(),{activeCluster:f}=ie(),{allElements:a,elementTrash:i,elementFilter:l,isLoading:k}=pe(),[A,v]=z.useState(zr);let{elementSelect:$}=pe();$=$||[];const[o,u]=z.useState(!1);z.useEffect(()=>{f&&e(At({cluster:f._id})).unwrap().then(({result:T})=>{if(!f.activeEl)return;const L=T.elements.find(({_id:O})=>O===f.activeEl);e(Ct(L))}).then(()=>{const T=document.getElementById("active-element");T&&En(T)})},[]);const p=a.filter(T=>T.cluster===(f==null?void 0:f._id)).sort((T,L)=>T.createdAt.localeCompare(L.createdAt)),d=(()=>{const T=i.map(L=>L._id);return $.includes("trash")?p.filter(L=>T.includes(L._id)):p})().filter(({element:T,caption:L,favorite:O,checked:x})=>{const D=T.toLowerCase().replace("·","").includes(l)||T.toLowerCase().includes(l)||L.toLowerCase().includes(l),q=$.includes("wordlist")?D&&On(T):D,N=()=>$.some(w=>["favorite","unfavorite"].includes(w))?$.includes("favorite")?q&&O===!0:q&&O===!1:q;return(()=>$.some(w=>["checked","unchecked"].includes(w))?$.includes("checked")?N()&&x===!0:N()&&x===!1:N())()}).sort(o?(T,L)=>L.createdAt.localeCompare(T.createdAt):(T,L)=>T.createdAt.localeCompare(L.createdAt)),h=async()=>{const T=c.lang;let L=0;await d.forEach(async O=>{if(L>1)return;const{_id:x,element:D}=O;if(!D.startsWith("[")||T!==O.lang){const q={from:f.lang,to:T},N=await Ke(D,q,c.engine);e(xe({_id:x,lang:T,caption:N})),L=L+1}})},S=window.innerHeight<(g==null?void 0:g.target.getBoundingClientRect().y)+(g==null?void 0:g.target.getBoundingClientRect().height)*1.5;return y.jsxs(y.Fragment,{children:[y.jsxs(Ir,{children:[d.map((T,L,O)=>y.jsx(Wt,{el:T,index:L,length:O.length,sortByDate:o,setSortByDate:u,translateAll:h,liColor:A,setLiColor:v},T._id)),y.jsxs("div",{ref:n,children:[y.jsx(_t,{}),y.jsx(It,{className:!t||!S?"shown":"hidden"}),y.jsx(Nt,{className:!t||!S?"shown":"hidden",filtredElements:d,setLiColor:v})]})]}),k&&y.jsx(_n,{})]})},{s:Tt,m:Br}=Q.indents,Hr=()=>y.jsx(Ge,{$p:`0 ${Br} ${Tt} ${Tt}`,children:y.jsx(Nr,{})});export{Hr as default};
