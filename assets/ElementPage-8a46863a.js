import{U as Ne,r as M,t as K,P as N,u as oe,b as ue,w as ie,j as S,T as Ye,V as Re,y as Ve,G as dt,H as gt,x as pe,S as gn,W as Ct,X as Et,Q as ee,A as fe,Y as mn,Z as vn,_ as bn,$ as yn,k as xt,n as de,s as W,a0 as wn,a1 as Sn,a2 as $n,a3 as je,a4 as _t,a5 as Tn,a6 as kn,M as Rn,a7 as An,a8 as Pe,a9 as Cn,aa as En,ab as xn,ac as _n,ad as Ln,ae as Lt,F as Ge,E as jn,af as Pn,D as Mn,C as On,ag as Dn,N as In,ah as zn}from"./index-accf74cf.js";import{r as jt,H as Nn,T as Bn}from"./index-172df99a.js";import{w as Pt,S as Wn}from"./googleScopes-60218ec1.js";import{v as Fn,u as Vn}from"./index.esm-b82f45fa.js";import{a as Gn}from"./index-e1b21c30.js";const Ue=(e,n)=>{if(!n.includes("de"))return e;const t=e.trim().split(`
`);return t.length===1?e:["der","die","das"].includes(t[0].split(" ")[0])?`${t[0].trim()}, ${t[1].split("·")[1].replaceAll("⁰","").replaceAll("/"," / ").trim()}`:(e.includes("hat")||e.includes("ist"))&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e.includes("am")&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e},mt=(e,n)=>{let t=e;for(const r in n)t=t.replaceAll(r,n[r]);const p=r=>r.replace(/^./,a=>a.toUpperCase()),s=[...t.split(/\s+/)];for(let r=0;r<s.length;r+=1)[".","!","?"].includes(s[r].at(-1))&&s[r+1]&&s.splice(r+1,1,p(s[r+1]));return s.join(" ")},Un=e=>/[a-z]/.test(e.charAt(0)),{VITE_DEEPL_API_KEY:Kn}={VITE_GOOGLE_CLIENT_ID:"502819804892-294ksvklsg60pjugga88j8l13a6dgmf2.apps.googleusercontent.com",VITE_DEEPL_API_KEY:"d15bf272-fb1f-4f29-bbc3-d3bbdd686c53:fx",VITE_GOOGLE_API_KEY:"AIzaSyABIqXgO4nO0LhnoircvA4SL0uwOY_PxJ4",VITE_PROD_BACK_URL:"https://studyorganizer.onrender.com",BASE_URL:"/studyorganizer/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},Hn={google:"",deepl:Kn},we=async(e,{from:n,to:t},p)=>{var u,r;if(!e||e.length===0)return"";const s=e.replaceAll(" ·",",").replaceAll("·","");Ne.engine=p,Ne.key=Hn[p];try{let a=await Ne(`${s}`,{from:n,to:t});if(t.includes("en")&&s.toLowerCase().includes("uhr")&&(a=a.replaceAll("a.m. on","am on").replaceAll("p.m. on","pm on").replaceAll("a.m. to","am to").replaceAll("p.m. to","pm to").replaceAll("a.m.","am.").replaceAll("p.m.","pm.")),[".","!","?"].includes(s.at(-1)))return a;const A=s.split(s.includes(", ")?", ":/\s+/),w=a.split(", "),h=t.includes("de")?w[0]:w[0].at(0).toLowerCase()+w[0].substring(1);return A.length===1?a.toLocaleLowerCase()+", ":["der","die","das"].includes(A[0].split(" ")[0])?a.replace("The ","").replace("the ","").split(", ")[0].toLocaleLowerCase()+", ":t.includes("en")&&((u=A[2])!=null&&u.startsWith("am"))?w[2].startsWith("the")?a:`${h}, ${w[1]}, the ${w[2]}`:(A[0].endsWith("n")&&["hat","ist"].includes((r=A[2])==null?void 0:r.split(" ")[0])&&n.includes("de")&&(a=t.includes("en")?"to "+h+", ":h+", "),a)}catch(a){return a.message}},Me=(e,n)=>e.endsWith(n)?e.substring(0,e.length-1):e,Yn=(e,n)=>{let t=84;e[0]&&(t=Number(e[0].style.height.replace("px",""))),M.useEffect(()=>{if(!e[0])return;let p=Math.max(...e.map(s=>s.scrollHeight));t!==p&&(p=p<=90?p:p+6,e.forEach(s=>{s.style.height=p+"px"}))},[t,e,n])},Ae=[{value:"de",label:"German"},{value:"en",label:"English"},{value:"uk",label:"Ukrainian"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"it",label:"Italian"}],Ce=[{value:.3,label:"Rate: 0.3"},{value:.4,label:"Rate: 0.4"},{value:.5,label:"Rate: 0.5"},{value:.6,label:"Rate: 0.6"},{value:.8,label:"Rate: 0.8"},{value:1,label:"Rate: 1"},{value:1.25,label:"Rate: 1.25"},{value:1.5,label:"Rate: 1.5"}],qn={"..":".",". .":".","?.":"?","? .":"?","!.":"!","! .":"!",",,":",",", ,":","},Xn={" Dot":"."," dot":"."," exclamation mark":"!"," question mark":"?"," comma":","," colon":":"," semi-colon":";","Yes ":"Yes, ","No ":"No, "},Jn={" Punkt":"."," Ausrufezeichen":"!"," Fragezeichen":"?"," Komma":","," Doppelpunkt":":"," Semikolon":";","Ja ":"Ja, ","Nein ":"Nein, "," weil":", weil"," aber":", aber"," als":", als"," ob":", ob"," damit":", damit"," bevor":", bevor"," obwohl":", obwohl"," dass":", dass"," dann":", dann"," deshalb":", deshalb"," desvegen":", desvegen"," trotzdem":", trotzdem"},vt={...Xn,...Jn,...qn};var Ke=new Map,Ee=new WeakMap,bt=0,Zn=void 0;function Qn(e){return e?(Ee.has(e)||(bt+=1,Ee.set(e,bt.toString())),Ee.get(e)):"0"}function er(e){return Object.keys(e).sort().filter(n=>e[n]!==void 0).map(n=>`${n}_${n==="root"?Qn(e.root):e[n]}`).toString()}function tr(e){const n=er(e);let t=Ke.get(n);if(!t){const p=new Map;let s;const u=new IntersectionObserver(r=>{r.forEach(a=>{var f;const A=a.isIntersecting&&s.some(w=>a.intersectionRatio>=w);e.trackVisibility&&typeof a.isVisible>"u"&&(a.isVisible=A),(f=p.get(a.target))==null||f.forEach(w=>{w(A,a)})})},e);s=u.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),t={id:n,observer:u,elements:p},Ke.set(n,t)}return t}function nr(e,n,t={},p=Zn){if(typeof window.IntersectionObserver>"u"&&p!==void 0){const f=e.getBoundingClientRect();return n(p,{isIntersecting:p,target:e,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:f,intersectionRect:f,rootBounds:f}),()=>{}}const{id:s,observer:u,elements:r}=tr(t),a=r.get(e)||[];return r.has(e)||r.set(e,a),a.push(n),u.observe(e),function(){a.splice(a.indexOf(n),1),a.length===0&&(r.delete(e),u.unobserve(e)),r.size===0&&(u.disconnect(),Ke.delete(s))}}function rr({threshold:e,delay:n,trackVisibility:t,rootMargin:p,root:s,triggerOnce:u,skip:r,initialInView:a,fallbackInView:f,onChange:A}={}){var w;const[h,y]=M.useState(null),d=M.useRef(A),[T,x]=M.useState({inView:!!a,entry:void 0});d.current=A,M.useEffect(()=>{if(r||!h)return;let $;return $=nr(h,(i,o)=>{x({inView:i,entry:o}),d.current&&d.current(i,o),o.isIntersecting&&u&&$&&($(),$=void 0)},{root:s,rootMargin:p,threshold:e,trackVisibility:t,delay:n},f),()=>{$&&$()}},[Array.isArray(e)?e.toString():e,h,s,p,u,r,t,f,n]);const g=(w=T.entry)==null?void 0:w.target,m=M.useRef(void 0);!h&&g&&!u&&!r&&m.current!==g&&(m.current=g,x({inView:!!a,entry:void 0}));const v=[y,T.inView,T.entry];return v.ref=v[0],v.inView=v[1],v.entry=v[2],v}const{backgroundHoverd:xe,white:_e,borderLight:Le}=K.colors,Mt=()=>{const e=oe(),{user:n}=ue(),{activeCluster:t}=ie(),p=({value:a})=>{e(Ve({_id:t._id,lang:a})).unwrap().then(f=>e(dt(f.result.cluster)))},s=({value:a})=>{e(Ve({_id:t._id,rate:a})).unwrap().then(f=>e(dt(f.result.cluster)))},u=({value:a})=>{const f=new FormData;f.append("lang",a),e(gt(f))},r=({value:a})=>{const f=new FormData;f.append("rate",a),e(gt(f))};return S.jsxs(Ye,{$m:"0",$cg:"8px",$ai:"center",$gtc:"2fr 2fr 2fr 2fr",children:[S.jsx(Re,{options:Ae,defaultValue:Ae.find(a=>a.value===(t==null?void 0:t.lang)),onChange:p,placeholder:"Language...",$ol:xe,$b:_e,$bh:Le}),S.jsx(Re,{options:Ce,defaultValue:Ce.find(a=>a.value==(t==null?void 0:t.rate)),onChange:s,placeholder:"Rate...",$ol:xe,$b:_e,$bh:Le}),S.jsx(Re,{options:Ae,defaultValue:Ae.find(a=>a.value===n.lang),onChange:u,placeholder:"Language...",$ol:xe,$b:_e,$bh:Le}),S.jsx(Re,{options:Ce,defaultValue:Ce.find(a=>a.value==n.rate),onChange:r,placeholder:"Rate...",$ol:xe,$b:_e,$bh:Le})]})};Mt.propTypes={filtredElements:N.array,setLiColor:N.func};const{button:ir}=K.shadows,sr=()=>{const e=oe(),{user:n}=ue(),{activeCluster:t}=ie();M.useEffect(()=>{const s=async u=>{u.key==="e"&&u.metaKey&&!u.altKey&&!u.shiftKey&&(u.preventDefault(),await p())};return addEventListener("keydown",s),()=>{removeEventListener("keydown",s)}},[]);const p=async s=>{const u=window.getSelection().toString();u&&await Pt(u);const r=await jt();let a=Ue(r,t.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();a=Me(a,",");const f={from:t.lang,to:n.lang};let A=await we(a,f,n.engine);A=Me(A.trim(),",");const{_id:w}=t;try{const h={cluster:w,element:"[]",caption:a},y={cluster:w,element:a,caption:A,favorite:!0,checked:a.split(/\s+/).length<20},d=a.includes("https://")?h:y;e(Ct(d)).unwrap().then(()=>(s==null?void 0:s.target)&&Et()).finally(()=>{var T;return(T=s==null?void 0:s.target)==null?void 0:T.blur()})}catch(h){s==null||s.currentTarget.blur(),ee.error(`Invalid element, ${h.message}`)}};return S.jsx(pe,{onClick:p,$s:"m",$round:!0,$bs:ir,children:S.jsx(gn,{size:18})})},{button:or}=K.shadows,ar=()=>{const e=oe(),{elementTrash:n}=fe(),t=()=>{confirm("Are you sure you want to delete the selected Element(s)?")&&e(mn(n.map(p=>p._id).join("&"))).unwrap().then(()=>e(vn()))};return S.jsx(pe,{onClick:t,$s:"m",$round:!0,$bs:or,children:S.jsx(Nn,{size:16})})};function cr(e){return bn({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M250.73,210.63l-56-112a12,12,0,0,0-21.46,0l-20.52,41A84.2,84.2,0,0,1,114,126.22,107.48,107.48,0,0,0,139.33,68H160a12,12,0,0,0,0-24H108V32a12,12,0,0,0-24,0V44H32a12,12,0,0,0,0,24h83.13A83.69,83.69,0,0,1,96,110.35,84,84,0,0,1,83.6,91a12,12,0,1,0-21.81,10A107.55,107.55,0,0,0,78,126.24,83.54,83.54,0,0,1,32,140a12,12,0,0,0,0,24,107.47,107.47,0,0,0,64-21.07,108.4,108.4,0,0,0,45.39,19.44l-24.13,48.26a12,12,0,1,0,21.46,10.73L151.41,196h65.17l12.68,25.36a12,12,0,1,0,21.47-10.73ZM163.41,172,184,130.83,204.58,172Z"},child:[]}]})(e)}const{button:lr}=K.shadows,ur=()=>{const{activeCluster:e}=ie();M.useEffect(()=>{const u=async r=>{r.metaKey&&r.key==="d"&&!r.altKey&&!r.shiftKey&&(r.preventDefault(),await s())};return addEventListener("keydown",u),()=>{removeEventListener("keydown",u)}},[]);let n=[];function t(u){u.forEach(r=>{const a=window.open(r,"_blank");a?n.push(a):ee.error(`Failed to open tab: ${r}`)})}const p=()=>{n.forEach(u=>{u.close()}),n=[]},s=async()=>{const u=window.getSelection().toString();u&&await Pt(u);const r=await jt();let a=[];e.lang.includes("de")&&a.push(`https://www.verbformen.com/conjugation/?w=${r}`),e.lang.includes("en")&&a.push(`https://dictionary.cambridge.org/dictionary/english-russian/${r}`),p(),t(a)};return S.jsx(pe,{onClick:s,$s:"m",$round:!0,$bs:lr,children:S.jsx(cr,{size:18})})},{s:yt,m:pr}=K.indents,Ot=({className:e})=>{const{pathname:n}=yn(),{elementTrash:t}=fe(),{activeCluster:p}=ie(),s=t.length>0?" 1fr":"",u=p?" 1fr":"",r=s+u+" 1fr";if(n.includes("/element"))return S.jsxs(Ye,{className:e,$m:`${yt} ${pr}`,$pos:"fixed",$side:"left",$high:"bottom",$gtc:r,$cg:yt,children:[S.jsx(ur,{}),u&&S.jsx(sr,{}),s&&S.jsx(ar,{})]})};Ot.propTypes={className:N.string};var fr={exports:{}};(function(e){var n=function(t){var p=Object.prototype,s=p.hasOwnProperty,u=Object.defineProperty||function(c,l,b){c[l]=b.value},r,a=typeof Symbol=="function"?Symbol:{},f=a.iterator||"@@iterator",A=a.asyncIterator||"@@asyncIterator",w=a.toStringTag||"@@toStringTag";function h(c,l,b){return Object.defineProperty(c,l,{value:b,enumerable:!0,configurable:!0,writable:!0}),c[l]}try{h({},"")}catch{h=function(l,b,L){return l[b]=L}}function y(c,l,b,L){var _=l&&l.prototype instanceof $?l:$,I=Object.create(_.prototype),H=new z(L||[]);return u(I,"_invoke",{value:k(c,b,H)}),I}t.wrap=y;function d(c,l,b){try{return{type:"normal",arg:c.call(l,b)}}catch(L){return{type:"throw",arg:L}}}var T="suspendedStart",x="suspendedYield",g="executing",m="completed",v={};function $(){}function i(){}function o(){}var R={};h(R,f,function(){return this});var j=Object.getPrototypeOf,O=j&&j(j(D([])));O&&O!==p&&s.call(O,f)&&(R=O);var F=o.prototype=$.prototype=Object.create(R);i.prototype=o,u(F,"constructor",{value:o,configurable:!0}),u(o,"constructor",{value:i,configurable:!0}),i.displayName=h(o,w,"GeneratorFunction");function B(c){["next","throw","return"].forEach(function(l){h(c,l,function(b){return this._invoke(l,b)})})}t.isGeneratorFunction=function(c){var l=typeof c=="function"&&c.constructor;return l?l===i||(l.displayName||l.name)==="GeneratorFunction":!1},t.mark=function(c){return Object.setPrototypeOf?Object.setPrototypeOf(c,o):(c.__proto__=o,h(c,w,"GeneratorFunction")),c.prototype=Object.create(F),c},t.awrap=function(c){return{__await:c}};function Q(c,l){function b(I,H,Y,X){var U=d(c[I],c,H);if(U.type==="throw")X(U.arg);else{var ge=U.arg,ae=ge.value;return ae&&typeof ae=="object"&&s.call(ae,"__await")?l.resolve(ae.__await).then(function(re){b("next",re,Y,X)},function(re){b("throw",re,Y,X)}):l.resolve(ae).then(function(re){ge.value=re,Y(ge)},function(re){return b("throw",re,Y,X)})}}var L;function _(I,H){function Y(){return new l(function(X,U){b(I,H,X,U)})}return L=L?L.then(Y,Y):Y()}u(this,"_invoke",{value:_})}B(Q.prototype),h(Q.prototype,A,function(){return this}),t.AsyncIterator=Q,t.async=function(c,l,b,L,_){_===void 0&&(_=Promise);var I=new Q(y(c,l,b,L),_);return t.isGeneratorFunction(l)?I:I.next().then(function(H){return H.done?H.value:I.next()})};function k(c,l,b){var L=T;return function(I,H){if(L===g)throw new Error("Generator is already running");if(L===m){if(I==="throw")throw H;return V()}for(b.method=I,b.arg=H;;){var Y=b.delegate;if(Y){var X=E(Y,b);if(X){if(X===v)continue;return X}}if(b.method==="next")b.sent=b._sent=b.arg;else if(b.method==="throw"){if(L===T)throw L=m,b.arg;b.dispatchException(b.arg)}else b.method==="return"&&b.abrupt("return",b.arg);L=g;var U=d(c,l,b);if(U.type==="normal"){if(L=b.done?m:x,U.arg===v)continue;return{value:U.arg,done:b.done}}else U.type==="throw"&&(L=m,b.method="throw",b.arg=U.arg)}}}function E(c,l){var b=l.method,L=c.iterator[b];if(L===r)return l.delegate=null,b==="throw"&&c.iterator.return&&(l.method="return",l.arg=r,E(c,l),l.method==="throw")||b!=="return"&&(l.method="throw",l.arg=new TypeError("The iterator does not provide a '"+b+"' method")),v;var _=d(L,c.iterator,l.arg);if(_.type==="throw")return l.method="throw",l.arg=_.arg,l.delegate=null,v;var I=_.arg;if(!I)return l.method="throw",l.arg=new TypeError("iterator result is not an object"),l.delegate=null,v;if(I.done)l[c.resultName]=I.value,l.next=c.nextLoc,l.method!=="return"&&(l.method="next",l.arg=r);else return I;return l.delegate=null,v}B(F),h(F,w,"Generator"),h(F,f,function(){return this}),h(F,"toString",function(){return"[object Generator]"});function C(c){var l={tryLoc:c[0]};1 in c&&(l.catchLoc=c[1]),2 in c&&(l.finallyLoc=c[2],l.afterLoc=c[3]),this.tryEntries.push(l)}function P(c){var l=c.completion||{};l.type="normal",delete l.arg,c.completion=l}function z(c){this.tryEntries=[{tryLoc:"root"}],c.forEach(C,this),this.reset(!0)}t.keys=function(c){var l=Object(c),b=[];for(var L in l)b.push(L);return b.reverse(),function _(){for(;b.length;){var I=b.pop();if(I in l)return _.value=I,_.done=!1,_}return _.done=!0,_}};function D(c){if(c!=null){var l=c[f];if(l)return l.call(c);if(typeof c.next=="function")return c;if(!isNaN(c.length)){var b=-1,L=function _(){for(;++b<c.length;)if(s.call(c,b))return _.value=c[b],_.done=!1,_;return _.value=r,_.done=!0,_};return L.next=L}}throw new TypeError(typeof c+" is not iterable")}t.values=D;function V(){return{value:r,done:!0}}return z.prototype={constructor:z,reset:function(c){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(P),!c)for(var l in this)l.charAt(0)==="t"&&s.call(this,l)&&!isNaN(+l.slice(1))&&(this[l]=r)},stop:function(){this.done=!0;var c=this.tryEntries[0],l=c.completion;if(l.type==="throw")throw l.arg;return this.rval},dispatchException:function(c){if(this.done)throw c;var l=this;function b(X,U){return I.type="throw",I.arg=c,l.next=X,U&&(l.method="next",l.arg=r),!!U}for(var L=this.tryEntries.length-1;L>=0;--L){var _=this.tryEntries[L],I=_.completion;if(_.tryLoc==="root")return b("end");if(_.tryLoc<=this.prev){var H=s.call(_,"catchLoc"),Y=s.call(_,"finallyLoc");if(H&&Y){if(this.prev<_.catchLoc)return b(_.catchLoc,!0);if(this.prev<_.finallyLoc)return b(_.finallyLoc)}else if(H){if(this.prev<_.catchLoc)return b(_.catchLoc,!0)}else if(Y){if(this.prev<_.finallyLoc)return b(_.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(c,l){for(var b=this.tryEntries.length-1;b>=0;--b){var L=this.tryEntries[b];if(L.tryLoc<=this.prev&&s.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var _=L;break}}_&&(c==="break"||c==="continue")&&_.tryLoc<=l&&l<=_.finallyLoc&&(_=null);var I=_?_.completion:{};return I.type=c,I.arg=l,_?(this.method="next",this.next=_.finallyLoc,v):this.complete(I)},complete:function(c,l){if(c.type==="throw")throw c.arg;return c.type==="break"||c.type==="continue"?this.next=c.arg:c.type==="return"?(this.rval=this.arg=c.arg,this.method="return",this.next="end"):c.type==="normal"&&l&&(this.next=l),v},finish:function(c){for(var l=this.tryEntries.length-1;l>=0;--l){var b=this.tryEntries[l];if(b.finallyLoc===c)return this.complete(b.completion,b.afterLoc),P(b),v}},catch:function(c){for(var l=this.tryEntries.length-1;l>=0;--l){var b=this.tryEntries[l];if(b.tryLoc===c){var L=b.completion;if(L.type==="throw"){var _=L.arg;P(b)}return _}}throw new Error("illegal catch attempt")},delegateYield:function(c,l,b){return this.delegate={iterator:D(c),resultName:l,nextLoc:b},this.method==="next"&&(this.arg=r),v}},t}(e.exports);try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})(fr);var ye={},Dt={},J={};Object.defineProperty(J,"__esModule",{value:!0});J.browserSupportsPolyfills=J.compareTwoStringsUsingDiceCoefficient=J.commandToRegExp=J.concatTranscripts=J.debounce=void 0;var hr=function(n,t,p){var s;return function(){var u=this,r=arguments,a=function(){s=null,p||n.apply(u,r)},f=p&&!s;clearTimeout(s),s=setTimeout(a,t),f&&n.apply(u,r)}};J.debounce=hr;var dr=function(){for(var n=arguments.length,t=new Array(n),p=0;p<n;p++)t[p]=arguments[p];return t.map(function(s){return s.trim()}).join(" ").trim()};J.concatTranscripts=dr;var gr=/\s*\((.*?)\)\s*/g,mr=/(\(\?:[^)]+\))\?/g,vr=/(\(\?)?:\w+/g,br=/\*/g,yr=/[-{}[\]+?.,\\^$|#]/g,wr=function(n){return n instanceof RegExp?new RegExp(n.source,"i"):(n=n.replace(yr,"\\$&").replace(gr,"(?:$1)?").replace(vr,function(t,p){return p?t:"([^\\s]+)"}).replace(br,"(.*?)").replace(mr,"\\s*$1?\\s*"),new RegExp("^"+n+"$","i"))};J.commandToRegExp=wr;var Sr=function(n,t){if(n=n.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!n.length&&!t.length)return 1;if(!n.length||!t.length)return 0;if(n===t)return 1;if(n.length===1&&t.length===1||n.length<2||t.length<2)return 0;for(var p=new Map,s=0;s<n.length-1;s++){var u=n.substring(s,s+2),r=p.has(u)?p.get(u)+1:1;p.set(u,r)}for(var a=0,f=0;f<t.length-1;f++){var A=t.substring(f,f+2),w=p.has(A)?p.get(A):0;w>0&&(p.set(A,w-1),a++)}return 2*a/(n.length+t.length-2)};J.compareTwoStringsUsingDiceCoefficient=Sr;var $r=function(){return typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0)};J.browserSupportsPolyfills=$r;var he={},le={};Object.defineProperty(le,"__esModule",{value:!0});le.APPEND_TRANSCRIPT=le.CLEAR_TRANSCRIPT=void 0;var Tr="CLEAR_TRANSCRIPT";le.CLEAR_TRANSCRIPT=Tr;var kr="APPEND_TRANSCRIPT";le.APPEND_TRANSCRIPT=kr;Object.defineProperty(he,"__esModule",{value:!0});he.appendTranscript=he.clearTranscript=void 0;var It=le,Rr=function(){return{type:It.CLEAR_TRANSCRIPT}};he.clearTranscript=Rr;var Ar=function(n,t){return{type:It.APPEND_TRANSCRIPT,payload:{interimTranscript:n,finalTranscript:t}}};he.appendTranscript=Ar;var De={};Object.defineProperty(De,"__esModule",{value:!0});De.transcriptReducer=void 0;var wt=le,Cr=J,Er=function(n,t){switch(t.type){case wt.CLEAR_TRANSCRIPT:return{interimTranscript:"",finalTranscript:""};case wt.APPEND_TRANSCRIPT:return{interimTranscript:t.payload.interimTranscript,finalTranscript:(0,Cr.concatTranscripts)(n.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};De.transcriptReducer=Er;var zt={},qe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){return/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"")};e.default=n})(qe);var Xe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.isNative=void 0;var n=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),t=function(u){return u===n};e.isNative=t;var p=n;e.default=p})(Xe);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=s(qe),t=J,p=Xe;function s(h){return h&&h.__esModule?h:{default:h}}function u(h,y,d,T,x,g,m){try{var v=h[g](m),$=v.value}catch(i){d(i);return}v.done?y($):Promise.resolve($).then(T,x)}function r(h){return function(){var y=this,d=arguments;return new Promise(function(T,x){var g=h.apply(y,d);function m($){u(g,T,x,m,v,"next",$)}function v($){u(g,T,x,m,v,"throw",$)}m(void 0)})}}function a(h,y){if(!(h instanceof y))throw new TypeError("Cannot call a class as a function")}function f(h,y){for(var d=0;d<y.length;d++){var T=y[d];T.enumerable=T.enumerable||!1,T.configurable=!0,"value"in T&&(T.writable=!0),Object.defineProperty(h,T.key,T)}}function A(h,y,d){return y&&f(h.prototype,y),d&&f(h,d),h}var w=function(){function h(y){a(this,h),this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=function(){},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(y),(0,n.default)()&&(this.updateFinalTranscript=(0,t.debounce)(this.updateFinalTranscript,250,!0))}return A(h,[{key:"setSpeechRecognition",value:function(d){var T=!!d&&((0,p.isNative)(d)||(0,t.browserSupportsPolyfills)());T&&(this.disableRecognition(),this.recognition=new d,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(T)}},{key:"subscribe",value:function(d,T){this.subscribers[d]=T}},{key:"unsubscribe",value:function(d){delete this.subscribers[d]}},{key:"emitListeningChange",value:function(d){var T=this;this.listening=d,Object.keys(this.subscribers).forEach(function(x){var g=T.subscribers[x].onListeningChange;g(d)})}},{key:"emitMicrophoneAvailabilityChange",value:function(d){var T=this;this.isMicrophoneAvailable=d,Object.keys(this.subscribers).forEach(function(x){var g=T.subscribers[x].onMicrophoneAvailabilityChange;g(d)})}},{key:"emitTranscriptChange",value:function(d,T){var x=this;Object.keys(this.subscribers).forEach(function(g){var m=x.subscribers[g].onTranscriptChange;m(d,T)})}},{key:"emitClearTranscript",value:function(){var d=this;Object.keys(this.subscribers).forEach(function(T){var x=d.subscribers[T].onClearTranscript;x()})}},{key:"emitBrowserSupportsSpeechRecognitionChange",value:function(d){var T=this;Object.keys(this.subscribers).forEach(function(x){var g=T.subscribers[x],m=g.onBrowserSupportsSpeechRecognitionChange,v=g.onBrowserSupportsContinuousListeningChange;m(d),v(d)})}},{key:"disconnect",value:function(d){if(this.recognition&&this.listening)switch(d){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}},{key:"disableRecognition",value:function(){this.recognition&&(this.recognition.onresult=function(){},this.recognition.onend=function(){},this.recognition.onerror=function(){},this.listening&&this.stopListening())}},{key:"onError",value:function(d){d&&d.error&&d.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}},{key:"onRecognitionDisconnect",value:function(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}},{key:"updateTranscript",value:function(d){var T=d.results,x=d.resultIndex,g=x===void 0?T.length-1:x;this.interimTranscript="",this.finalTranscript="";for(var m=g;m<T.length;++m)T[m].isFinal&&(!(0,n.default)()||T[m][0].confidence>0)?this.updateFinalTranscript(T[m][0].transcript):this.interimTranscript=(0,t.concatTranscripts)(this.interimTranscript,T[m][0].transcript);var v=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(v=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,v||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}},{key:"updateFinalTranscript",value:function(d){this.finalTranscript=(0,t.concatTranscripts)(this.finalTranscript,d)}},{key:"resetTranscript",value:function(){this.disconnect("RESET")}},{key:"startListening",value:function(){var y=r(regeneratorRuntime.mark(function T(){var x,g,m,v,$,i,o=arguments;return regeneratorRuntime.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(x=o.length>0&&o[0]!==void 0?o[0]:{},g=x.continuous,m=g===void 0?!1:g,v=x.language,this.recognition){j.next=3;break}return j.abrupt("return");case 3:if($=m!==this.recognition.continuous,i=v&&v!==this.recognition.lang,!($||i)){j.next=11;break}if(!this.listening){j.next=9;break}return j.next=9,this.stopListening();case 9:this.recognition.continuous=$?m:this.recognition.continuous,this.recognition.lang=i?v:this.recognition.lang;case 11:if(this.listening){j.next=22;break}return this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript()),j.prev=13,j.next=16,this.start();case 16:this.emitListeningChange(!0),j.next=22;break;case 19:j.prev=19,j.t0=j.catch(13),j.t0 instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1);case 22:case"end":return j.stop()}},T,this,[[13,19]])}));function d(){return y.apply(this,arguments)}return d}()},{key:"abortListening",value:function(){var y=r(regeneratorRuntime.mark(function T(){var x=this;return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.disconnect("ABORT"),this.emitListeningChange(!1),m.next=4,new Promise(function(v){x.onStopListening=v});case 4:case"end":return m.stop()}},T,this)}));function d(){return y.apply(this,arguments)}return d}()},{key:"stopListening",value:function(){var y=r(regeneratorRuntime.mark(function T(){var x=this;return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return this.disconnect("STOP"),this.emitListeningChange(!1),m.next=4,new Promise(function(v){x.onStopListening=v});case 4:case"end":return m.stop()}},T,this)}));function d(){return y.apply(this,arguments)}return d}()},{key:"getRecognition",value:function(){return this.recognition}},{key:"start",value:function(){var y=r(regeneratorRuntime.mark(function T(){return regeneratorRuntime.wrap(function(g){for(;;)switch(g.prev=g.next){case 0:if(!(this.recognition&&!this.listening)){g.next=4;break}return g.next=3,this.recognition.start();case 3:this.listening=!0;case 4:case"end":return g.stop()}},T,this)}));function d(){return y.apply(this,arguments)}return d}()},{key:"stop",value:function(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}},{key:"abort",value:function(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}}]),h}();e.default=w})(zt);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.useSpeechRecognition=void 0;var n=M,t=J,p=he,s=De,u=f(zt),r=f(qe),a=f(Xe);function f(k){return k&&k.__esModule?k:{default:k}}function A(k,E,C,P,z,D,V){try{var c=k[D](V),l=c.value}catch(b){C(b);return}c.done?E(l):Promise.resolve(l).then(P,z)}function w(k){return function(){var E=this,C=arguments;return new Promise(function(P,z){var D=k.apply(E,C);function V(l){A(D,P,z,V,c,"next",l)}function c(l){A(D,P,z,V,c,"throw",l)}V(void 0)})}}function h(k){return T(k)||d(k)||v(k)||y()}function y(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function d(k){if(typeof Symbol<"u"&&Symbol.iterator in Object(k))return Array.from(k)}function T(k){if(Array.isArray(k))return $(k)}function x(k){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?x=function(C){return typeof C}:x=function(C){return C&&typeof Symbol=="function"&&C.constructor===Symbol&&C!==Symbol.prototype?"symbol":typeof C},x(k)}function g(k,E){return o(k)||i(k,E)||v(k,E)||m()}function m(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function v(k,E){if(k){if(typeof k=="string")return $(k,E);var C=Object.prototype.toString.call(k).slice(8,-1);if(C==="Object"&&k.constructor&&(C=k.constructor.name),C==="Map"||C==="Set")return Array.from(k);if(C==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(C))return $(k,E)}}function $(k,E){(E==null||E>k.length)&&(E=k.length);for(var C=0,P=new Array(E);C<E;C++)P[C]=k[C];return P}function i(k,E){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(k)))){var C=[],P=!0,z=!1,D=void 0;try{for(var V=k[Symbol.iterator](),c;!(P=(c=V.next()).done)&&(C.push(c.value),!(E&&C.length===E));P=!0);}catch(l){z=!0,D=l}finally{try{!P&&V.return!=null&&V.return()}finally{if(z)throw D}}return C}}function o(k){if(Array.isArray(k))return k}var R=!!a.default,j=R&&!(0,r.default)(),O,F=function(){var E=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},C=E.transcribing,P=C===void 0?!0:C,z=E.clearTranscriptOnListen,D=z===void 0?!0:z,V=E.commands,c=V===void 0?[]:V,l=(0,n.useState)(B.getRecognitionManager()),b=g(l,1),L=b[0],_=(0,n.useState)(R),I=g(_,2),H=I[0],Y=I[1],X=(0,n.useState)(j),U=g(X,2),ge=U[0],ae=U[1],re=(0,n.useReducer)(s.transcriptReducer,{interimTranscript:L.interimTranscript,finalTranscript:""}),Ze=g(re,2),Qe=Ze[0],et=Qe.interimTranscript,tt=Qe.finalTranscript,nt=Ze[1],qt=(0,n.useState)(L.listening),rt=g(qt,2),Xt=rt[0],Jt=rt[1],Zt=(0,n.useState)(L.isMicrophoneAvailable),it=g(Zt,2),Qt=it[0],en=it[1],st=(0,n.useRef)(c);st.current=c;var ot=function(){nt((0,p.clearTranscript)())},me=(0,n.useCallback)(function(){L.resetTranscript(),ot()},[L]),tn=function(q,ne,ce){var se=x(q)==="object"?q.toString():q,ve=se.replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),$e=(0,t.compareTwoStringsUsingDiceCoefficient)(ve,ne);return $e>=ce?{command:q,commandWithoutSpecials:ve,howSimilar:$e,isFuzzyMatch:!0}:null},nn=function(q,ne){var ce=(0,t.commandToRegExp)(q),se=ce.exec(ne);return se?{command:q,parameters:se.slice(1)}:null},at=(0,n.useCallback)(function(te,q){st.current.forEach(function(ne){var ce=ne.command,se=ne.callback,ve=ne.matchInterim,$e=ve===void 0?!1:ve,ut=ne.isFuzzyMatch,pt=ut===void 0?!1:ut,ft=ne.fuzzyMatchingThreshold,sn=ft===void 0?.8:ft,ht=ne.bestMatchOnly,on=ht===void 0?!1:ht,Te=!q&&$e?te.trim():q.trim(),an=Array.isArray(ce)?ce:[ce],ke=an.map(function(Z){return pt?tn(Z,Te,sn):nn(Z,Te)}).filter(function(Z){return Z});if(pt&&on&&ke.length>=2){ke.sort(function(Z,ze){return ze.howSimilar-Z.howSimilar});var Ie=ke[0],cn=Ie.command,ln=Ie.commandWithoutSpecials,un=Ie.howSimilar;se(ln,Te,un,{command:cn,resetTranscript:me})}else ke.forEach(function(Z){if(Z.isFuzzyMatch){var ze=Z.command,pn=Z.commandWithoutSpecials,fn=Z.howSimilar;se(pn,Te,fn,{command:ze,resetTranscript:me})}else{var hn=Z.command,dn=Z.parameters;se.apply(void 0,h(dn).concat([{command:hn,resetTranscript:me}]))}})})},[me]),ct=(0,n.useCallback)(function(te,q){P&&nt((0,p.appendTranscript)(te,q)),at(te,q)},[at,P]),lt=(0,n.useCallback)(function(){D&&ot()},[D]);(0,n.useEffect)(function(){var te=B.counter;B.counter+=1;var q={onListeningChange:Jt,onMicrophoneAvailabilityChange:en,onTranscriptChange:ct,onClearTranscript:lt,onBrowserSupportsSpeechRecognitionChange:Y,onBrowserSupportsContinuousListeningChange:ae};return L.subscribe(te,q),function(){L.unsubscribe(te)}},[P,D,L,ct,lt]);var rn=(0,t.concatTranscripts)(tt,et);return{transcript:rn,interimTranscript:et,finalTranscript:tt,listening:Xt,isMicrophoneAvailable:Qt,resetTranscript:me,browserSupportsSpeechRecognition:H,browserSupportsContinuousListening:ge}};e.useSpeechRecognition=F;var B={counter:0,applyPolyfill:function(E){O?O.setSpeechRecognition(E):O=new u.default(E);var C=!!E&&(0,t.browserSupportsPolyfills)();R=C,j=C},removePolyfill:function(){O?O.setSpeechRecognition(a.default):O=new u.default(a.default),R=!!a.default,j=R&&!(0,r.default)()},getRecognitionManager:function(){return O||(O=new u.default(a.default)),O},getRecognition:function(){var E=B.getRecognitionManager();return E.getRecognition()},startListening:function(){var k=w(regeneratorRuntime.mark(function C(){var P,z,D,V,c=arguments;return regeneratorRuntime.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return P=c.length>0&&c[0]!==void 0?c[0]:{},z=P.continuous,D=P.language,V=B.getRecognitionManager(),b.next=4,V.startListening({continuous:z,language:D});case 4:case"end":return b.stop()}},C)}));function E(){return k.apply(this,arguments)}return E}(),stopListening:function(){var k=w(regeneratorRuntime.mark(function C(){var P;return regeneratorRuntime.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return P=B.getRecognitionManager(),D.next=3,P.stopListening();case 3:case"end":return D.stop()}},C)}));function E(){return k.apply(this,arguments)}return E}(),abortListening:function(){var k=w(regeneratorRuntime.mark(function C(){var P;return regeneratorRuntime.wrap(function(D){for(;;)switch(D.prev=D.next){case 0:return P=B.getRecognitionManager(),D.next=3,P.abortListening();case 3:case"end":return D.stop()}},C)}));function E(){return k.apply(this,arguments)}return E}(),browserSupportsSpeechRecognition:function(){return R},browserSupportsContinuousListening:function(){return j}},Q=B;e.default=Q})(Dt);(function(e){function n(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(f){return typeof f}:n=function(f){return f&&typeof Symbol=="function"&&f.constructor===Symbol&&f!==Symbol.prototype?"symbol":typeof f},n(r)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"useSpeechRecognition",{enumerable:!0,get:function(){return t.useSpeechRecognition}}),e.default=void 0;var t=s(Dt);function p(){if(typeof WeakMap!="function")return null;var r=new WeakMap;return p=function(){return r},r}function s(r){if(r&&r.__esModule)return r;if(r===null||n(r)!=="object"&&typeof r!="function")return{default:r};var a=p();if(a&&a.has(r))return a.get(r);var f={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var w in r)if(Object.prototype.hasOwnProperty.call(r,w)){var h=A?Object.getOwnPropertyDescriptor(r,w):null;h&&(h.get||h.set)?Object.defineProperty(f,w,h):f[w]=r[w]}return f.default=r,a&&a.set(r,f),f}var u=t.default;e.default=u})(ye);const be=xt(ye);var Nt={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var n={}.hasOwnProperty;function t(){for(var p=[],s=0;s<arguments.length;s++){var u=arguments[s];if(u){var r=typeof u;if(r==="string"||r==="number")p.push(u);else if(Array.isArray(u)){if(u.length){var a=t.apply(null,u);a&&p.push(a)}}else if(r==="object"){if(u.toString!==Object.prototype.toString&&!u.toString.toString().includes("[native code]")){p.push(u.toString());continue}for(var f in u)n.call(u,f)&&u[f]&&p.push(f)}}}return p.join(" ")}e.exports?(t.default=t,e.exports=t):window.classNames=t})()})(Nt);var xr=Nt.exports;const _r=xt(xr),{colors:G,shadows:St,indents:Be}=K,Lr=de`
  margin-bottom: 7px;
  padding-block: ${Be.xs};

  display: grid;
  align-items: center;
  grid-template-columns: 1fr 25fr 1fr;
  column-gap: 4px;

  border: 1px solid transparent;
  background-color: ${({licolor:e})=>e};
  border-radius: ${Be.xs};
  font-size: 22px;

  &:last-of-type {
    margin-bottom: ${Be.s};
  }
`,jr=W.li`
  ${Lr}

  transition: box-shadow 250ms, border-color 250ms;

  &#active-element {
    border-color: ${G.border};
    background-color: ${G.background};
    box-shadow: ${St.back};

    &:hover {
      border-color: ${G.accent};
    }
    & div button {
      transition: color 250ms;
      color: ${G.smokeBlack};
      &:hover {
        color: ${G.hovered};
      }
    }
  }

  & div button {
    transition: color 250ms;
    &:hover {
      color: ${G.hovered};
    }
  }

  &:hover {
    border-color: ${G.accent};
    box-shadow: ${St.back};
  }

  &:hover label,
  &:hover button {
    opacity: 1;
  }
`,Bt=de`
  min-height: 19px;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  & input {
    ${Fn}
  }
`,Pr=W.label`
  ${Bt}

  & svg {
    transition: stroke 250ms;
    stroke-width: 2px;
    color: ${({$hovered:e})=>e?G.yellow:"transparent"};
    stroke: ${({$hovered:e})=>e?G.yellow:G.border};
  }
  &:hover svg {
    stroke: ${G.placeholder};
  }
`,Mr=W.label`
  ${Bt}
  opacity: ${({$hovered:e})=>e?1:0};
  transition: opacity 250ms;

  & svg {
    transition: border-color 250ms, color 250ms;
    padding: 1px;
    border: 2px solid ${G.border};
    border-radius: 50%;
    color: ${({$hovered:e})=>e?G.border:"transparent"};
  }
  &:hover svg {
    border-color: ${G.placeholder};
    color: ${({$hovered:e})=>e?G.placeholder:"transparent"};
  }
`,Se=de`
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: transparent;
  border-color: transparent;
  transition: opacity 250ms color 250ms;
  color: ${G.black};

  & svg {
    transition: color 250ms;
    color: ${G.border};
  }
  &:hover,
  &:hover svg {
    color: ${G.placeholder};
  }
`,Or=W.button`
  ${Se}

  opacity: ${({$hovered:e})=>e?1:0};
`,Dr=W.button`
  ${Se}

  opacity: 0;
`,{colors:Oe,indents:Wt}=K,Ft=de`
  padding-block: 4px;
  display: grid;
  align-items: start;
  grid-template-columns: 20fr 1fr 20fr;
`,Ir=W.div`
  ${Ft}
`,zr=W.form`
  ${Ft}

  max-height: 70vh;
  overflow-y: scroll;
  scrollbar-width: none;
  grid-template-columns: 12fr 1fr 12fr;
`,$t=W.textarea`
  height: 84px;
  outline: none;
  border: 1px solid ${Oe.accent};
  border-radius: ${Wt.xs};
  resize: none;
  overflow: clip;
  transition: height 150ms;
`,Nr=W.div`
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  &::after {
    content: '';
    height: calc(100% - 8px);
    width: 1px;
    border: 1px solid ${Oe.borderLight};
    transition: border-color 250ms;
  }

  &:hover::after {
    border-color: ${Oe.placeholder};
  }
`,Br=W.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,Wr=W.button`
  ${Se}
`,He=W.button`
  ${Se}
`,Fr=W.button`
  ${Se}
`,Tt=W.button`
  height: 100%;
  text-align: left;
  display: flex;
  align-items: top;
  background-color: transparent;
  border-color: transparent;
  border-radius: ${Wt.xs};
  color: ${Oe.black};
  transition: background-color 250ms;
`,Vr=de`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  height: 54px;
  border-radius: 30px;
`,Gr=W.iframe`
  ${Vr}
`,Je=({el:e,setIsForm:n,setRecording:t,setTranslation:p})=>{const s=M.useRef(null),u=M.useRef(null),r=M.useRef(null),a=oe(),{user:f}=ue(),{activeCluster:A}=ie(),[w,h]=M.useState(""),{_id:y,element:d,caption:T}=e,{register:x,watch:g,setValue:m,handleSubmit:v,setFocus:$}=Vn({mode:"onBlur",defaultValues:{element:d,caption:T}});M.useEffect(()=>{m("caption",T)},[T,m]);const{ref:i,...o}=x("element"),{ref:R,...j}=x("caption"),O=[s.current,u.current,r.current],F=[g("caption"),g("element")];Yn(O,F),M.useEffect(()=>{$("element"),w&&d.trim().startsWith("der")?m("element",w+d.replace("der","").trim()+", "):w&&d.trim().startsWith("die")?m("element",w+d.replace("die","").trim()+", "):w&&d.trim().startsWith("das")?m("element",w+d.replace("das","").trim()+", "):w?m("element",w+d+", "):m("element",w+d)},[w,d,$,m]),M.useEffect(()=>{const E=async C=>{(C.code==="NumpadAdd"||C.key==="F2")&&(C.preventDefault(),await k(f.engine),v(B)()),(C.key==="Enter"||C.key==="§")&&(C.preventDefault(),v(B)()),C.key==="Escape"&&(C.preventDefault(),n(!1)),C.code==="AltRight"&&s.current.focus()};return addEventListener("keydown",E),()=>{removeEventListener("keydown",E)}},[]);const B=E=>{const C=f.lang;let P=E.caption.trim(),z=Ue(E.element,A.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();z=Me(z,","),P=Me(P,","),f.lang.includes("en")&&A.lang.includes("de")&&(z.includes("hat")||z.includes("ist"))&&z.split(`
`)[0].split(/,\s+/)[0].endsWith("n")&&(P=P.split(/,\s+/).map(c=>c.startsWith("to ")?c:`to ${c}`).join(", ")),a(y?je({_id:y,lang:C,element:z,caption:P}):Ct({...e,element:z,caption:P})).then(a(_t())),y||(Et(),t(""),p("")),n(!1)},Q=()=>{w===""&&h("der "),w==="der "&&h("die "),w==="die "&&h("das "),w==="das "&&h("")},k=async E=>{const C=g("element"),P=Ue(C,A.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim(),z={from:A.lang,to:f.lang},D=await we(P,z,E);m("caption",D)};return S.jsxs(zr,{onSubmit:v(B),children:[S.jsx($t,{...o,name:"element",ref:E=>{i(E),s.current=E}}),S.jsxs(Br,{ref:r,children:[S.jsx(Fr,{type:"button",onClick:Q,children:S.jsx(Gn,{size:"18px"})}),S.jsx(He,{type:"button",onClick:()=>k("google"),children:S.jsx(wn,{size:"16px"})}),S.jsx(He,{type:"button",onClick:()=>k("deepl"),children:S.jsx(Sn,{size:"18px"})}),S.jsx(Wr,{children:S.jsx($n,{size:"16px"})})]}),S.jsx($t,{...j,name:"caption",ref:E=>{R(E),u.current=E}})]})};Je.propTypes={el:N.object,setIsForm:N.func,setRecording:N.func,setTranslation:N.func};const{button:Ur}=K.shadows,{m:Kr,xl:Hr}=K.indents,Vt=({className:e})=>{const{user:n}=ue(),[t,p]=M.useState(!1),{activeCluster:s}=ie(),[u,r]=M.useState(""),[a,f]=M.useState(""),{transcript:A,listening:w,resetTranscript:h}=ye.useSpeechRecognition(),{isMicrophoneAvailable:y}=ye.useSpeechRecognition(),{browserSupportsSpeechRecognition:d}=ye.useSpeechRecognition(),T=u.endsWith(", ")||u.replace(/[a-z]$/,"*#").endsWith("*#")?A.replace(/^./,$=>` ${$}`):A.replace(/^./,$=>$.toUpperCase()),x=`${u}${T}`,g=mt(x,vt),m=($,i)=>$.trim().endsWith(i)?`${$.trim()} `:`${$.trim()}${i} `;if(M.useEffect(()=>{if(!t)return;const $=[".","?","!",","],i=o=>{if($.includes(o.key)){o.preventDefault();const R=m(g,o.key);r(R),h()}if(o.key==="Backspace"){o.preventDefault();const R=window.getSelection().toString();if(window.getSelection().deleteFromDocument(),R){const j=g.replace(R,"");r(j)}else{const j=g.length-1,O=g.substring(0,j);r(O)}h()}if(o.key==="Space"){o.preventDefault();const R=g+" ";r(R),h()}};return addEventListener("keydown",i),()=>{removeEventListener("keydown",i)}},[t,w,g,h]),M.useEffect(()=>{const $=async i=>{const o=i.key==="F1"||i.key==="r"&&i.metaKey&&!i.altKey&&!i.shiftKey;if(w||o&&(i.preventDefault(),p(!0),be.startListening({language:s.lang,continuous:!0})),w&&o){i.preventDefault(),be.stopListening();const R=g.at(-1),j=!R||["!"].includes(R)?g:m(g,"."),O=await we(mt(j,vt),{from:s.lang,to:n.lang},n.engine);r(j),f(O),h()}};return addEventListener("keydown",$),()=>{removeEventListener("keydown",$)}},[s.lang,t,w,g,h,n.engine,n.lang]),M.useEffect(()=>{const $=async i=>{if(i.key==="Escape"||i.key==="Enter"||i.key==="§"){i.preventDefault(),be.stopListening(),p(!1),r(""),f(""),h();return}};return addEventListener("keyup",$),()=>{removeEventListener("keyup",$)}},[h]),!d||!y)return;const v=async $=>{if($==null||$.currentTarget.blur(),!w)p(!0),be.startListening({language:s.lang,continuous:!0});else{be.stopListening();const i=g.at(-1),o=!i||["!"].includes(i)?g:m(g,"."),R={from:s.lang,to:n.lang},j=await we(o,R,n.engine);r(o),f(j),h()}};return S.jsxs("div",{className:_r(e,"speak-btn",!t&&"hidden"),children:[S.jsx(pe,{onClick:v,$s:"m",$round:!0,$bs:Ur,children:w?S.jsx(kn,{size:18}):S.jsx(Tn,{size:18})}),t&&S.jsx(Rn,{$x:`left: ${Kr}`,$y:`top: ${Hr}`,$bd:"none",children:S.jsx(Je,{el:{cluster:s._id,element:g.trim(),caption:a.trim(),favorite:!0,checked:g.split(/\s+/).length<20},setIsForm:p,setRecording:r,setTranslation:f})})]})};Vt.propTypes={className:N.string};const{colors:We}=K,Yr=W.div`
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  &:hover svg {
    stroke: ${We.yellow};
  }

  & svg {
    transition: stroke 250ms;
    stroke: ${We.hovered};
    /* stroke: ${({$colored:e})=>e&&We.yellow}; */
    @keyframes refresh-spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(-360deg);
      }
    }
    animation: refresh-spin infinite 12s linear;
  }
`,Gt=({onClick:e})=>S.jsx(Yr,{onClick:e,children:S.jsx(An,{size:"35px"})});Gt.propTypes={onClick:N.func};const{background:Fe}=K.colors,{button:kt}=K.shadows,{s:Rt,m:qr}=K.indents,Ut=({className:e,filtredElements:n,setLiColor:t})=>{const{user:p}=ue(),{activeCluster:s}=ie(),{activeElement:u}=fe(),[r,a]=M.useState(null);if(M.useEffect(()=>{const g=window.speechSynthesis.getVoices();Array.isArray(g)&&g.length>0&&a(g),"onvoiceschanged"in window.speechSynthesis&&(window.speechSynthesis.onvoiceschanged=()=>{const m=window.speechSynthesis.getVoices();a(m)})},[]),!Array.isArray(r)||r.length===0)return;const f=g=>{if(!g.length)return;let m="",v=0;const $=g.reduce((i,o)=>(i[o.lang]||(i[o.lang]=0),i[o.lang]+=1,i),{});for(const i in $)$[i]>v&&(v=$[i],m=i);return m},A=n.length?f(n):p.lang,w=(g,m)=>g.replaceAll(", `",`;${m} `).replaceAll(" `",`${m} `).replaceAll(",`",";"),h=({text:g,playList:m,divider:v})=>{let $="";for(let i=0;i<m.length;i+=1){let o=m[i][g];const R=`@±@${m[i].lang}${v}`;o.endsWith(".")||o.endsWith("!")||o.endsWith("?")||o.endsWith('"')?($+=w(o,v).replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",g!=="caption"?`__${v}`:`__${R}`).replaceAll(".",g!=="caption"?`.${v}`:`.${R}`).replaceAll(",",g!=="caption"?`,${v}`:`,${R}`).replaceAll("!",g!=="caption"?`!${v}`:`!${R}`).replaceAll("?",g!=="caption"?`?${v}`:`?${R}`).replaceAll(":",g!=="caption"?`:${v}`:`:${R}`),s.lang.includes("de")&&($=$.replaceAll(`0.${v}`,"0.").replaceAll(`1.${v}`,"1.").replaceAll(`2.${v}`,"2.").replaceAll(`3.${v}`,"3.").replaceAll(`4.${v}`,"4.").replaceAll(`5.${v}`,"5.").replaceAll(`6.${v}`,"6.").replaceAll(`7.${v}`,"7.").replaceAll(`8.${v}`,"8.").replaceAll(`9.${v}`,"9."))):m[i].element.startsWith("[")||(g==="caption"&&(o.includes(" [")&&(o=o.substring(0,o.indexOf(" ["))),o=`${o}@±@${m[i].lang}`),$+=o+v)}return $},y=r,d=g=>{g.currentTarget.blur(),t(Fe);const m="$*@",v=n.findIndex(o=>o.element===u.element),$=n.splice(v===-1?0:v),i=Pe({setLiColor:t,divider:m,voices:y,text:h({text:"element",playList:$,divider:m}),lang:s.lang,rate:s.rate});i&&ee.error(i)},T=g=>{g.currentTarget.blur();const m="$*@";t(Fe);const v=n.findIndex(o=>o.element===u.element),$=n.splice(v===-1?0:v),i=Pe({setLiColor:t,divider:m,voices:y,text:h({text:"caption",playList:$,divider:m}),lang:A,rate:p.rate});i&&ee.error(i)},x=g=>{g.currentTarget.blur(),t(Fe);let m="";const v="$*@",$=n.findIndex(R=>R.element===u.element),i=n.splice($===-1?0:$);for(let R=0;R<i.length;R+=1){const{element:j,caption:O,lang:F}=i[R];if(!j.startsWith("[")){const B=w(j,""),Q=O.includes(" [")?O.substring(0,O.indexOf(" [")):w(O,"");m+=B+`@±@${F}`+Q+v}}const o=Cn({setLiColor:t,divider:v,voices:y,text:m,lang:s.lang,rate:p.rate});o&&ee.error(o)};return S.jsxs(Ye,{className:e,$m:`${Rt} ${qr}`,$pos:"fixed",$side:"right",$high:"bottom",$gtc:"1fr 0.5fr 1fr",$cg:Rt,children:[S.jsx(pe,{onClick:d,$s:"m",$round:!0,$bs:kt,children:(s==null?void 0:s.lang.at(0).toUpperCase())+(s==null?void 0:s.lang.substring(1))}),S.jsx(Gt,{onClick:x}),S.jsx(pe,{onClick:T,$s:"m",$round:!0,$bs:kt,children:(A==null?void 0:A.at(0).toUpperCase())+(A==null?void 0:A.substring(1))})]})};Ut.propTypes={className:N.string,filtredElements:N.array,setLiColor:N.func};const{background:Xr,backgroundHoverd:Jr}=K.colors,Zr=de`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
  height: 54px;
  border-radius: 30px;
`,Qr=W.audio`
  ${Zr}

  &::-webkit-media-controls {
    display: flex;
    justify-content: center;
    background-color: ${Xr};
  }

  &::-webkit-media-controls-panel {
    background-color: ${Jr};
  }
`,Kt=({src:e,accessToken:n,expiresIn:t})=>{const p=oe(),s=M.useRef(),[u,r]=M.useState("dump"),a=En({onSuccess:w=>{const{access_token:h,expires_in:y}=w,d={accessToken:h,expiresIn:y*1e3+Date.now()};p(xn(d)),f(h)},onError:w=>ee.error(w.message),scope:Wn}),f=async w=>{try{const h=await _n.get(e,{responseType:"blob",headers:{Authorization:`Bearer ${w}`}}).then(d=>d.data),y=URL.createObjectURL(h);r(y)}catch(h){ee.error(h.message)}},A=Date.now()<t;return S.jsx(Qr,{ref:s,src:e.endsWith(".mp3")?e:u,onError:()=>{!A&&a(),A&&f(n)},onPause:w=>w.target.blur(),onEnded:w=>w.target.blur(),controls:!0})};Kt.propTypes={src:N.string,accessToken:N.string,expiresIn:N.number};const Ht=({el:e,sortByDate:n,setSortByDate:t,setLiColor:p})=>{var v,$;const s=oe(),{user:u}=ue(),{activeCluster:r}=ie(),a=e.element,f=Ln(e.caption),[A,w]=M.useState(()=>{var i;return!((i=f.file)!=null&&i.endsWith(".mp3"))}),h="$*@",y=(i,o)=>{let R="";return o?(i.trim().endsWith(".")||i.trim().endsWith("!")||i.trim().endsWith("?")||i.endsWith('"')?(R=i.trim().replaceAll(", `",`;${o} `).replaceAll(" `",`${o} `).replaceAll(",`",";").replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",`__${o}`).replaceAll(".",`.${o}`).replaceAll(",",`,${o}`).replaceAll("!",`!${o}`).replaceAll("?",`?${o}`).replaceAll(":",`:${o}`),r.lang.includes("de")&&(R=R.replaceAll(`0.${o}`,"0.").replaceAll(`1.${o}`,"1.").replaceAll(`2.${o}`,"2.").replaceAll(`3.${o}`,"3.").replaceAll(`4.${o}`,"4.").replaceAll(`5.${o}`,"5.").replaceAll(`6.${o}`,"6.").replaceAll(`7.${o}`,"7.").replaceAll(`8.${o}`,"8.").replaceAll(`9.${o}`,"9."))):R=i.trim()+o,R.includes("[")?R.substring(0,R.indexOf("["))+o:R):i},d=i=>{i.currentTarget.blur();const o=Pe({setLiColor:p,divider:h,voices:window.speechSynthesis.getVoices(),text:y(a,h),lang:r.lang,rate:r.rate});o&&ee.error(o)},T=i=>{i.currentTarget.blur();const o=Pe({setLiColor:p,divider:h,voices:window.speechSynthesis.getVoices(),text:y(f.text,h),lang:e.lang,rate:u.rate});o&&ee.error(o)},x=i=>{const{_id:o}=r;s(Lt(e)),i.currentTarget.closest("li").id!=="active-element"&&s(Ve({_id:o,activeEl:e._id}))},g=i=>{t(!n),n?ee.success("Below is Recent"):ee.success("Above is Recent"),i.stopPropagation()},m=()=>{a.startsWith("[")?w(!A):g()};return S.jsx(S.Fragment,{children:S.jsxs(Ir,{onClick:x,children:[S.jsx(Tt,{onClick:d,children:a}),S.jsx(Nr,{onClick:m}),f.text&&S.jsx(Tt,{onClick:T,children:f.text}),A&&!f.text&&S.jsx(Gr,{src:f.link}),!A&&!f.text&&S.jsx(Kt,{src:f.file,accessToken:(v=u.googleToken)==null?void 0:v.accessToken,expiresIn:($=u.googleToken)==null?void 0:$.expiresIn})]})})};Ht.propTypes={el:N.object,sortByDate:N.bool,setSortByDate:N.func,$active:N.bool,$hovered:N.bool,setLiColor:N.func};const Yt=({el:e,index:n,length:t,sortByDate:p,setSortByDate:s,translateAll:u,liColor:r,setLiColor:a})=>{const f=oe(),{elementTrash:A,activeElement:w}=fe(),[h,y]=M.useState(!1),{_id:d,favorite:T,checked:x}=e,g=A.find(R=>R._id===d),m=d===(w==null?void 0:w._id);M.useEffect(()=>{const R=j=>{j.key==="F2"&&(j.preventDefault(),m&&y(!h))};return addEventListener("keydown",R),()=>{removeEventListener("keydown",R)}},[m,h]);const v=()=>{f(je({_id:d,favorite:!T}))},$=()=>{f(je({_id:d,checked:!x}))},i=()=>f(Dn(e)),o=()=>y(!h);return S.jsxs(jr,{id:m?"active-element":null,licolor:r,children:[S.jsxs(Ge,{$h:"100%",$p:"0",$fd:"column",children:[S.jsxs(Pr,{$hovered:T,children:[S.jsx("input",{type:"checkbox",name:"favorite",checked:T,onChange:v}),S.jsx(Bn,{size:"20px"})]}),S.jsxs(Mr,{$hovered:x,children:[S.jsx("input",{type:"checkbox",name:"checked",checked:x,onChange:$}),S.jsx(jn,{size:"15px"})]}),h&&t===n+1&&S.jsx(He,{onClick:u,children:S.jsx(Pn,{size:"16px"})})]}),h&&S.jsx(Je,{el:e,setIsForm:y}),!h&&S.jsx(Ht,{el:e,sortByDate:p,setSortByDate:s,setLiColor:a}),S.jsxs(Ge,{$h:"100%",$p:"0",$fd:"column",children:[S.jsx(Or,{$hovered:g,onClick:i,children:S.jsx(Mn,{size:"16px"})}),S.jsx(Dr,{onClick:o,children:S.jsx(On,{size:"15px"})})]})]})};Yt.propTypes={el:N.object,index:N.number,length:N.number,sortByDate:N.bool,setSortByDate:N.func,translateAll:N.func,liColor:N.string,setLiColor:N.func};const ei=W.ul`
  width: 100%;
  list-style: none;
`,ti=W.div`
  & .speak-btn {
    position: fixed;
    bottom: ${K.indents.s};
    left: calc(45% + 10px);
    /* transform: translateX(calc(-50%)); */
  }

  & .hidden {
    opacity: 0;
    transition: opacity 150ms;
    &:hover {
      opacity: 1;
    }
    & button {
      transition: color 750ms, border-color 750ms, background-color 750ms;
    }
  }
`,{white:ni}=K.colors,ri=()=>{const e=oe(),{ref:n,inView:t,entry:p}=rr({initialInView:!0,rootMargin:"0px 0px -30px 0px"}),{user:s}=ue(),{activeCluster:u}=ie(),{allElements:r,elementTrash:a,elementFilter:f,isLoading:A}=fe(),[w,h]=M.useState(ni);let{elementSelect:y}=fe();y=y||[];const[d,T]=M.useState(!1);M.useEffect(()=>{u&&e(_t({cluster:u._id})).unwrap().then(({result:i})=>{if(!u.activeEl)return;const o=i.elements.find(({_id:R})=>R===u.activeEl);e(Lt(o))}).then(()=>{const i=document.getElementById("active-element");i&&In(i)})},[]);const x=r.filter(i=>i.cluster===(u==null?void 0:u._id)).sort((i,o)=>i.createdAt.localeCompare(o.createdAt)),m=(()=>{const i=a.map(o=>o._id);return y.includes("trash")?x.filter(o=>i.includes(o._id)):x})().filter(({element:i,caption:o,favorite:R,checked:j})=>{const O=i.toLowerCase().replace("·","").includes(f)||i.toLowerCase().includes(f)||o.toLowerCase().includes(f),F=y.includes("wordlist")?O&&Un(i):O,B=()=>y.some(k=>["favorite","unfavorite"].includes(k))?y.includes("favorite")?F&&R===!0:F&&R===!1:F;return(()=>y.some(k=>["checked","unchecked"].includes(k))?y.includes("checked")?B()&&j===!0:B()&&j===!1:B())()}).sort(d?(i,o)=>o.createdAt.localeCompare(i.createdAt):(i,o)=>i.createdAt.localeCompare(o.createdAt)),v=async()=>{const i=s.lang;let o=0;await m.forEach(async R=>{if(o>1)return;const{_id:j,element:O}=R;if(!O.startsWith("[")||i!==R.lang){const F={from:u.lang,to:i},B=await we(O,F,s.engine);e(je({_id:j,lang:i,caption:B})),o=o+1}})},$=window.innerHeight<(p==null?void 0:p.target.getBoundingClientRect().y)+(p==null?void 0:p.target.getBoundingClientRect().height)*1.5;return S.jsxs(S.Fragment,{children:[S.jsxs(ei,{children:[m.map((i,o,R)=>S.jsx(Yt,{el:i,index:o,length:R.length,sortByDate:d,setSortByDate:T,translateAll:v,liColor:w,setLiColor:h},i._id)),S.jsxs(ti,{ref:n,children:[S.jsx(Mt,{}),S.jsx(Vt,{className:!t||!$?"shown":"hidden"}),S.jsx(Ot,{className:!t||!$?"shown":"hidden"}),S.jsx(Ut,{className:!t||!$?"shown":"hidden",filtredElements:m,setLiColor:h})]})]}),A&&S.jsx(zn,{})]})},{s:At,m:ii}=K.indents,ui=()=>S.jsx(Ge,{$p:`0 ${ii} ${At} ${At}`,children:S.jsx(ri,{})});export{ui as default};
