import{U as Ne,r as z,t as Q,P as B,u as le,b as ue,q as ie,j as $,T as He,V as Ae,x as Ve,E as dt,H as gt,w as pe,S as ln,W as Rt,X as At,Q as re,z as fe,Y as un,Z as pn,G as fn,i as hn,n as $e,s as F,_ as dn,$ as gn,a0 as mn,a1 as je,a2 as Ct,a3 as vn,a4 as yn,M as bn,a5 as wn,a6 as $n,a7 as Pe,a8 as Sn,a9 as mt,aa as kt,F as Ge,D as Tn,ab as Rn,C as An,A as Cn,ac as kn,N as En,ad as _n}from"./index-bad7cb7b.js";import{r as Et,H as Ln,T as xn}from"./index-791b5b85.js";import{w as _t}from"./writeClipboard-7d5da739.js";import{v as jn,u as Pn}from"./index.esm-d923600b.js";import{a as Mn}from"./index-2a82185b.js";const Ke=(e,n)=>{if(!n.includes("de"))return e;const t=e.trim().split(`
`);return t.length===1?e:["der","die","das"].includes(t[0].split(" ")[0])?`${t[0].trim()}, ${t[1].split("·")[1].replaceAll("⁰","").replaceAll("/"," / ").trim()}`:(e.includes("hat")||e.includes("ist"))&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e.includes("am")&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e},On=(e,n)=>{let t=e;for(const r in n)t=t.replaceAll(r,n[r]);const f=r=>r.replace(/^./,a=>a.toUpperCase()),l=[...t.split(/\s+/)];for(let r=0;r<l.length;r+=1)[".","!","?"].includes(l[r].at(-1))&&l[r+1]&&l.splice(r+1,1,f(l[r+1]));return l.join(" ")},Dn=e=>/[a-z]/.test(e.charAt(0)),{VITE_DEEPL_API_KEY:zn}={VITE_GOOGLE_CLIENT_ID:"689266183428-lh3lmpaqnd2qd6t93voa8s6ipt3836q1.apps.googleusercontent.com",VITE_DEEPL_API_KEY:"d15bf272-fb1f-4f29-bbc3-d3bbdd686c53:fx",VITE_GOOGLE_API_KEY:"AIzaSyDqQndBxYEuOG7F6iYDqQoiNF90tptRmBQ",VITE_PROD_BACK_URL:"https://studyorganizer.onrender.com",BASE_URL:"/studyorganizer/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},In={google:"",deepl:zn},we=async(e,{from:n,to:t},f)=>{var h,r;if(!e||e.length===0)return"";const l=e.replaceAll(" ·",",").replaceAll("·","");Ne.engine=f,Ne.key=In[f];try{let a=await Ne(`${l}`,{from:n,to:t});if(t.includes("en")&&l.toLowerCase().includes("uhr")&&(a=a.replaceAll("a.m. on","am on").replaceAll("p.m. on","pm on").replaceAll("a.m. to","am to").replaceAll("p.m. to","pm to").replaceAll("a.m.","am.").replaceAll("p.m.","pm.")),[".","!","?"].includes(l.at(-1)))return a;const A=l.split(l.includes(", ")?", ":/\s+/),C=a.split(", "),v=t.includes("de")?C[0]:C[0].at(0).toLowerCase()+C[0].substring(1);return A.length===1?a.toLocaleLowerCase()+", ":["der","die","das"].includes(A[0].split(" ")[0])?a.replace("The ","").replace("the ","").split(", ")[0].toLocaleLowerCase()+", ":t.includes("en")&&((h=A[2])!=null&&h.startsWith("am"))?C[2].startsWith("the")?a:`${v}, ${C[1]}, the ${C[2]}`:(A[0].endsWith("n")&&["hat","ist"].includes((r=A[2])==null?void 0:r.split(" ")[0])&&n.includes("de")&&(a=t.includes("en")?"to "+v+", ":v+", "),a)}catch(a){return a.message}},Me=(e,n)=>e.endsWith(n)?e.substring(0,e.length-1):e,Nn=(e,n)=>{let t=84;e[0]&&(t=Number(e[0].style.height.replace("px",""))),z.useEffect(()=>{if(!e[0])return;let f=Math.max(...e.map(l=>l.scrollHeight));t!==f&&(f=f<=90?f:f+6,e.forEach(l=>{l.style.height=f+"px"}))},[t,e,n])},Ce=[{value:"de",label:"German"},{value:"en",label:"English"},{value:"uk",label:"Ukrainian"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"it",label:"Italian"}],ke=[{value:.3,label:"Rate: 0.3"},{value:.4,label:"Rate: 0.4"},{value:.5,label:"Rate: 0.5"},{value:.6,label:"Rate: 0.6"},{value:.8,label:"Rate: 0.8"},{value:1,label:"Rate: 1"},{value:1.25,label:"Rate: 1.25"},{value:1.5,label:"Rate: 1.5"}],Bn={"Yes ":"Yes, ","No ":"No, ","Ja ":"Ja, ","Nein ":"Nein, "," Punkt":"."," Ausrufezeichen":"!"," Fragezeichen":"?"," Komma":","," Doppelpunkt":":"," Semikolon":";"," dot":"."," exclamation mark":"!"," question mark":"?"," comma":","," colon":":"," semi-colon":";"};var Ue=new Map,Ee=new WeakMap,vt=0,Wn=void 0;function Fn(e){return e?(Ee.has(e)||(vt+=1,Ee.set(e,vt.toString())),Ee.get(e)):"0"}function Vn(e){return Object.keys(e).sort().filter(n=>e[n]!==void 0).map(n=>`${n}_${n==="root"?Fn(e.root):e[n]}`).toString()}function Gn(e){const n=Vn(e);let t=Ue.get(n);if(!t){const f=new Map;let l;const h=new IntersectionObserver(r=>{r.forEach(a=>{var u;const A=a.isIntersecting&&l.some(C=>a.intersectionRatio>=C);e.trackVisibility&&typeof a.isVisible>"u"&&(a.isVisible=A),(u=f.get(a.target))==null||u.forEach(C=>{C(A,a)})})},e);l=h.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),t={id:n,observer:h,elements:f},Ue.set(n,t)}return t}function Kn(e,n,t={},f=Wn){if(typeof window.IntersectionObserver>"u"&&f!==void 0){const u=e.getBoundingClientRect();return n(f,{isIntersecting:f,target:e,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:u,intersectionRect:u,rootBounds:u}),()=>{}}const{id:l,observer:h,elements:r}=Gn(t),a=r.get(e)||[];return r.has(e)||r.set(e,a),a.push(n),h.observe(e),function(){a.splice(a.indexOf(n),1),a.length===0&&(r.delete(e),h.unobserve(e)),r.size===0&&(h.disconnect(),Ue.delete(l))}}function Un({threshold:e,delay:n,trackVisibility:t,rootMargin:f,root:l,triggerOnce:h,skip:r,initialInView:a,fallbackInView:u,onChange:A}={}){var C;const[v,b]=z.useState(null),g=z.useRef(A),[R,S]=z.useState({inView:!!a,entry:void 0});g.current=A,z.useEffect(()=>{if(r||!v)return;let o;return o=Kn(v,(p,w)=>{S({inView:p,entry:w}),g.current&&g.current(p,w),w.isIntersecting&&h&&o&&(o(),o=void 0)},{root:l,rootMargin:f,threshold:e,trackVisibility:t,delay:n},u),()=>{o&&o()}},[Array.isArray(e)?e.toString():e,v,l,f,h,r,t,u,n]);const m=(C=R.entry)==null?void 0:C.target,y=z.useRef(void 0);!v&&m&&!h&&!r&&y.current!==m&&(y.current=m,S({inView:!!a,entry:void 0}));const i=[b,R.inView,R.entry];return i.ref=i[0],i.inView=i[1],i.entry=i[2],i}const{backgroundHoverd:_e,white:Le,borderLight:xe}=Q.colors,Lt=()=>{const e=le(),{user:n}=ue(),{activeCluster:t}=ie(),f=({value:a})=>{e(Ve({_id:t._id,lang:a})).unwrap().then(u=>e(dt(u.result.cluster)))},l=({value:a})=>{e(Ve({_id:t._id,rate:a})).unwrap().then(u=>e(dt(u.result.cluster)))},h=({value:a})=>{const u=new FormData;u.append("lang",a),e(gt(u))},r=({value:a})=>{const u=new FormData;u.append("rate",a),e(gt(u))};return $.jsxs(He,{$m:"0",$cg:"8px",$ai:"center",$gtc:"2fr 2fr 2fr 2fr",children:[$.jsx(Ae,{options:Ce,defaultValue:Ce.find(a=>a.value===(t==null?void 0:t.lang)),onChange:f,placeholder:"Language...",$ol:_e,$b:Le,$bh:xe}),$.jsx(Ae,{options:ke,defaultValue:ke.find(a=>a.value==(t==null?void 0:t.rate)),onChange:l,placeholder:"Rate...",$ol:_e,$b:Le,$bh:xe}),$.jsx(Ae,{options:Ce,defaultValue:Ce.find(a=>a.value===n.lang),onChange:h,placeholder:"Language...",$ol:_e,$b:Le,$bh:xe}),$.jsx(Ae,{options:ke,defaultValue:ke.find(a=>a.value==n.rate),onChange:r,placeholder:"Rate...",$ol:_e,$b:Le,$bh:xe})]})};Lt.propTypes={filtredElements:B.array,setLiColor:B.func};const{button:qn}=Q.shadows,Hn=()=>{const e=le(),{user:n}=ue(),{activeCluster:t}=ie();z.useEffect(()=>{const l=async h=>{h.key==="e"&&h.metaKey&&!h.altKey&&!h.shiftKey&&(h.preventDefault(),await f())};return addEventListener("keydown",l),()=>{removeEventListener("keydown",l)}},[]);const f=async l=>{const h=window.getSelection().toString();h&&await _t(h);const r=await Et();let a=Ke(r,t.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();a=Me(a,",");const u={from:t.lang,to:n.lang};let A=await we(a,u,n.engine);A=Me(A.trim(),",");const{_id:C}=t;try{const v={cluster:C,element:"[]",caption:a},b={cluster:C,element:a,caption:A,favorite:!0,checked:a.split(/\s+/).length<20},g=a.includes("https://")?v:b;e(Rt(g)).unwrap().then(()=>(l==null?void 0:l.target)&&At()).finally(()=>{var R;return(R=l==null?void 0:l.target)==null?void 0:R.blur()})}catch(v){l==null||l.currentTarget.blur(),re.error(`Invalid element, ${v.message}`)}};return $.jsx(pe,{onClick:f,$s:"m",$round:!0,$bs:qn,children:$.jsx(ln,{size:18})})},{button:Yn}=Q.shadows,Qn=()=>{const e=le(),{elementTrash:n}=fe(),t=()=>{confirm("Are you sure you want to delete the selected Element(s)?")&&e(un(n.map(f=>f._id).join("&"))).unwrap().then(()=>e(pn()))};return $.jsx(pe,{onClick:t,$s:"m",$round:!0,$bs:Yn,children:$.jsx(Ln,{size:16})})};function Zn(e){return fn({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M250.73,210.63l-56-112a12,12,0,0,0-21.46,0l-20.52,41A84.2,84.2,0,0,1,114,126.22,107.48,107.48,0,0,0,139.33,68H160a12,12,0,0,0,0-24H108V32a12,12,0,0,0-24,0V44H32a12,12,0,0,0,0,24h83.13A83.69,83.69,0,0,1,96,110.35,84,84,0,0,1,83.6,91a12,12,0,1,0-21.81,10A107.55,107.55,0,0,0,78,126.24,83.54,83.54,0,0,1,32,140a12,12,0,0,0,0,24,107.47,107.47,0,0,0,64-21.07,108.4,108.4,0,0,0,45.39,19.44l-24.13,48.26a12,12,0,1,0,21.46,10.73L151.41,196h65.17l12.68,25.36a12,12,0,1,0,21.47-10.73ZM163.41,172,184,130.83,204.58,172Z"},child:[]}]})(e)}const{button:Jn}=Q.shadows,Xn=()=>{const{activeCluster:e}=ie();z.useEffect(()=>{const h=async r=>{r.metaKey&&r.key==="d"&&!r.altKey&&!r.shiftKey&&(r.preventDefault(),await l())};return addEventListener("keydown",h),()=>{removeEventListener("keydown",h)}},[]);let n=[];function t(h){h.forEach(r=>{const a=window.open(r,"_blank");a?n.push(a):re.error(`Failed to open tab: ${r}`)})}const f=()=>{n.forEach(h=>{h.close()}),n=[]},l=async()=>{const h=window.getSelection().toString();h&&await _t(h);const r=await Et();let a=[];e.lang.includes("de")&&a.push(`https://www.verbformen.com/conjugation/?w=${r}`),e.lang.includes("en")&&a.push(`https://dictionary.cambridge.org/dictionary/english-russian/${r}`),f(),t(a)};return $.jsx(pe,{onClick:l,$s:"m",$round:!0,$bs:Jn,children:$.jsx(Zn,{size:18})})};var er={exports:{}};(function(e){var n=function(t){var f=Object.prototype,l=f.hasOwnProperty,h=Object.defineProperty||function(c,s,d){c[s]=d.value},r,a=typeof Symbol=="function"?Symbol:{},u=a.iterator||"@@iterator",A=a.asyncIterator||"@@asyncIterator",C=a.toStringTag||"@@toStringTag";function v(c,s,d){return Object.defineProperty(c,s,{value:d,enumerable:!0,configurable:!0,writable:!0}),c[s]}try{v({},"")}catch{v=function(s,d,L){return s[d]=L}}function b(c,s,d,L){var k=s&&s.prototype instanceof o?s:o,O=Object.create(k.prototype),q=new W(L||[]);return h(O,"_invoke",{value:T(c,d,q)}),O}t.wrap=b;function g(c,s,d){try{return{type:"normal",arg:c.call(s,d)}}catch(L){return{type:"throw",arg:L}}}var R="suspendedStart",S="suspendedYield",m="executing",y="completed",i={};function o(){}function p(){}function w(){}var x={};v(x,u,function(){return this});var j=Object.getPrototypeOf,D=j&&j(j(M([])));D&&D!==f&&l.call(D,u)&&(x=D);var V=w.prototype=o.prototype=Object.create(x);p.prototype=w,h(V,"constructor",{value:w,configurable:!0}),h(w,"constructor",{value:p,configurable:!0}),p.displayName=v(w,C,"GeneratorFunction");function I(c){["next","throw","return"].forEach(function(s){v(c,s,function(d){return this._invoke(s,d)})})}t.isGeneratorFunction=function(c){var s=typeof c=="function"&&c.constructor;return s?s===p||(s.displayName||s.name)==="GeneratorFunction":!1},t.mark=function(c){return Object.setPrototypeOf?Object.setPrototypeOf(c,w):(c.__proto__=w,v(c,C,"GeneratorFunction")),c.prototype=Object.create(V),c},t.awrap=function(c){return{__await:c}};function N(c,s){function d(O,q,H,Z){var U=g(c[O],c,q);if(U.type==="throw")Z(U.arg);else{var ge=U.arg,ae=ge.value;return ae&&typeof ae=="object"&&l.call(ae,"__await")?s.resolve(ae.__await).then(function(ne){d("next",ne,H,Z)},function(ne){d("throw",ne,H,Z)}):s.resolve(ae).then(function(ne){ge.value=ne,H(ge)},function(ne){return d("throw",ne,H,Z)})}}var L;function k(O,q){function H(){return new s(function(Z,U){d(O,q,Z,U)})}return L=L?L.then(H,H):H()}h(this,"_invoke",{value:k})}I(N.prototype),v(N.prototype,A,function(){return this}),t.AsyncIterator=N,t.async=function(c,s,d,L,k){k===void 0&&(k=Promise);var O=new N(b(c,s,d,L),k);return t.isGeneratorFunction(s)?O:O.next().then(function(q){return q.done?q.value:O.next()})};function T(c,s,d){var L=R;return function(O,q){if(L===m)throw new Error("Generator is already running");if(L===y){if(O==="throw")throw q;return K()}for(d.method=O,d.arg=q;;){var H=d.delegate;if(H){var Z=_(H,d);if(Z){if(Z===i)continue;return Z}}if(d.method==="next")d.sent=d._sent=d.arg;else if(d.method==="throw"){if(L===R)throw L=y,d.arg;d.dispatchException(d.arg)}else d.method==="return"&&d.abrupt("return",d.arg);L=m;var U=g(c,s,d);if(U.type==="normal"){if(L=d.done?y:S,U.arg===i)continue;return{value:U.arg,done:d.done}}else U.type==="throw"&&(L=y,d.method="throw",d.arg=U.arg)}}}function _(c,s){var d=s.method,L=c.iterator[d];if(L===r)return s.delegate=null,d==="throw"&&c.iterator.return&&(s.method="return",s.arg=r,_(c,s),s.method==="throw")||d!=="return"&&(s.method="throw",s.arg=new TypeError("The iterator does not provide a '"+d+"' method")),i;var k=g(L,c.iterator,s.arg);if(k.type==="throw")return s.method="throw",s.arg=k.arg,s.delegate=null,i;var O=k.arg;if(!O)return s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,i;if(O.done)s[c.resultName]=O.value,s.next=c.nextLoc,s.method!=="return"&&(s.method="next",s.arg=r);else return O;return s.delegate=null,i}I(V),v(V,C,"Generator"),v(V,u,function(){return this}),v(V,"toString",function(){return"[object Generator]"});function E(c){var s={tryLoc:c[0]};1 in c&&(s.catchLoc=c[1]),2 in c&&(s.finallyLoc=c[2],s.afterLoc=c[3]),this.tryEntries.push(s)}function P(c){var s=c.completion||{};s.type="normal",delete s.arg,c.completion=s}function W(c){this.tryEntries=[{tryLoc:"root"}],c.forEach(E,this),this.reset(!0)}t.keys=function(c){var s=Object(c),d=[];for(var L in s)d.push(L);return d.reverse(),function k(){for(;d.length;){var O=d.pop();if(O in s)return k.value=O,k.done=!1,k}return k.done=!0,k}};function M(c){if(c!=null){var s=c[u];if(s)return s.call(c);if(typeof c.next=="function")return c;if(!isNaN(c.length)){var d=-1,L=function k(){for(;++d<c.length;)if(l.call(c,d))return k.value=c[d],k.done=!1,k;return k.value=r,k.done=!0,k};return L.next=L}}throw new TypeError(typeof c+" is not iterable")}t.values=M;function K(){return{value:r,done:!0}}return W.prototype={constructor:W,reset:function(c){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(P),!c)for(var s in this)s.charAt(0)==="t"&&l.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=r)},stop:function(){this.done=!0;var c=this.tryEntries[0],s=c.completion;if(s.type==="throw")throw s.arg;return this.rval},dispatchException:function(c){if(this.done)throw c;var s=this;function d(Z,U){return O.type="throw",O.arg=c,s.next=Z,U&&(s.method="next",s.arg=r),!!U}for(var L=this.tryEntries.length-1;L>=0;--L){var k=this.tryEntries[L],O=k.completion;if(k.tryLoc==="root")return d("end");if(k.tryLoc<=this.prev){var q=l.call(k,"catchLoc"),H=l.call(k,"finallyLoc");if(q&&H){if(this.prev<k.catchLoc)return d(k.catchLoc,!0);if(this.prev<k.finallyLoc)return d(k.finallyLoc)}else if(q){if(this.prev<k.catchLoc)return d(k.catchLoc,!0)}else if(H){if(this.prev<k.finallyLoc)return d(k.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(c,s){for(var d=this.tryEntries.length-1;d>=0;--d){var L=this.tryEntries[d];if(L.tryLoc<=this.prev&&l.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var k=L;break}}k&&(c==="break"||c==="continue")&&k.tryLoc<=s&&s<=k.finallyLoc&&(k=null);var O=k?k.completion:{};return O.type=c,O.arg=s,k?(this.method="next",this.next=k.finallyLoc,i):this.complete(O)},complete:function(c,s){if(c.type==="throw")throw c.arg;return c.type==="break"||c.type==="continue"?this.next=c.arg:c.type==="return"?(this.rval=this.arg=c.arg,this.method="return",this.next="end"):c.type==="normal"&&s&&(this.next=s),i},finish:function(c){for(var s=this.tryEntries.length-1;s>=0;--s){var d=this.tryEntries[s];if(d.finallyLoc===c)return this.complete(d.completion,d.afterLoc),P(d),i}},catch:function(c){for(var s=this.tryEntries.length-1;s>=0;--s){var d=this.tryEntries[s];if(d.tryLoc===c){var L=d.completion;if(L.type==="throw"){var k=L.arg;P(d)}return k}}throw new Error("illegal catch attempt")},delegateYield:function(c,s,d){return this.delegate={iterator:M(c),resultName:s,nextLoc:d},this.method==="next"&&(this.arg=r),i}},t}(e.exports);try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})(er);var be={},xt={},J={};Object.defineProperty(J,"__esModule",{value:!0});J.browserSupportsPolyfills=J.compareTwoStringsUsingDiceCoefficient=J.commandToRegExp=J.concatTranscripts=J.debounce=void 0;var tr=function(n,t,f){var l;return function(){var h=this,r=arguments,a=function(){l=null,f||n.apply(h,r)},u=f&&!l;clearTimeout(l),l=setTimeout(a,t),u&&n.apply(h,r)}};J.debounce=tr;var nr=function(){for(var n=arguments.length,t=new Array(n),f=0;f<n;f++)t[f]=arguments[f];return t.map(function(l){return l.trim()}).join(" ").trim()};J.concatTranscripts=nr;var rr=/\s*\((.*?)\)\s*/g,ir=/(\(\?:[^)]+\))\?/g,sr=/(\(\?)?:\w+/g,ar=/\*/g,or=/[-{}[\]+?.,\\^$|#]/g,cr=function(n){return n instanceof RegExp?new RegExp(n.source,"i"):(n=n.replace(or,"\\$&").replace(rr,"(?:$1)?").replace(sr,function(t,f){return f?t:"([^\\s]+)"}).replace(ar,"(.*?)").replace(ir,"\\s*$1?\\s*"),new RegExp("^"+n+"$","i"))};J.commandToRegExp=cr;var lr=function(n,t){if(n=n.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!n.length&&!t.length)return 1;if(!n.length||!t.length)return 0;if(n===t)return 1;if(n.length===1&&t.length===1||n.length<2||t.length<2)return 0;for(var f=new Map,l=0;l<n.length-1;l++){var h=n.substring(l,l+2),r=f.has(h)?f.get(h)+1:1;f.set(h,r)}for(var a=0,u=0;u<t.length-1;u++){var A=t.substring(u,u+2),C=f.has(A)?f.get(A):0;C>0&&(f.set(A,C-1),a++)}return 2*a/(n.length+t.length-2)};J.compareTwoStringsUsingDiceCoefficient=lr;var ur=function(){return typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0)};J.browserSupportsPolyfills=ur;var he={},ce={};Object.defineProperty(ce,"__esModule",{value:!0});ce.APPEND_TRANSCRIPT=ce.CLEAR_TRANSCRIPT=void 0;var pr="CLEAR_TRANSCRIPT";ce.CLEAR_TRANSCRIPT=pr;var fr="APPEND_TRANSCRIPT";ce.APPEND_TRANSCRIPT=fr;Object.defineProperty(he,"__esModule",{value:!0});he.appendTranscript=he.clearTranscript=void 0;var jt=ce,hr=function(){return{type:jt.CLEAR_TRANSCRIPT}};he.clearTranscript=hr;var dr=function(n,t){return{type:jt.APPEND_TRANSCRIPT,payload:{interimTranscript:n,finalTranscript:t}}};he.appendTranscript=dr;var De={};Object.defineProperty(De,"__esModule",{value:!0});De.transcriptReducer=void 0;var yt=ce,gr=J,mr=function(n,t){switch(t.type){case yt.CLEAR_TRANSCRIPT:return{interimTranscript:"",finalTranscript:""};case yt.APPEND_TRANSCRIPT:return{interimTranscript:t.payload.interimTranscript,finalTranscript:(0,gr.concatTranscripts)(n.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};De.transcriptReducer=mr;var Pt={},Ye={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){return/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"")};e.default=n})(Ye);var Qe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.isNative=void 0;var n=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),t=function(h){return h===n};e.isNative=t;var f=n;e.default=f})(Qe);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=l(Ye),t=J,f=Qe;function l(v){return v&&v.__esModule?v:{default:v}}function h(v,b,g,R,S,m,y){try{var i=v[m](y),o=i.value}catch(p){g(p);return}i.done?b(o):Promise.resolve(o).then(R,S)}function r(v){return function(){var b=this,g=arguments;return new Promise(function(R,S){var m=v.apply(b,g);function y(o){h(m,R,S,y,i,"next",o)}function i(o){h(m,R,S,y,i,"throw",o)}y(void 0)})}}function a(v,b){if(!(v instanceof b))throw new TypeError("Cannot call a class as a function")}function u(v,b){for(var g=0;g<b.length;g++){var R=b[g];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(v,R.key,R)}}function A(v,b,g){return b&&u(v.prototype,b),g&&u(v,g),v}var C=function(){function v(b){a(this,v),this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=function(){},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(b),(0,n.default)()&&(this.updateFinalTranscript=(0,t.debounce)(this.updateFinalTranscript,250,!0))}return A(v,[{key:"setSpeechRecognition",value:function(g){var R=!!g&&((0,f.isNative)(g)||(0,t.browserSupportsPolyfills)());R&&(this.disableRecognition(),this.recognition=new g,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(R)}},{key:"subscribe",value:function(g,R){this.subscribers[g]=R}},{key:"unsubscribe",value:function(g){delete this.subscribers[g]}},{key:"emitListeningChange",value:function(g){var R=this;this.listening=g,Object.keys(this.subscribers).forEach(function(S){var m=R.subscribers[S].onListeningChange;m(g)})}},{key:"emitMicrophoneAvailabilityChange",value:function(g){var R=this;this.isMicrophoneAvailable=g,Object.keys(this.subscribers).forEach(function(S){var m=R.subscribers[S].onMicrophoneAvailabilityChange;m(g)})}},{key:"emitTranscriptChange",value:function(g,R){var S=this;Object.keys(this.subscribers).forEach(function(m){var y=S.subscribers[m].onTranscriptChange;y(g,R)})}},{key:"emitClearTranscript",value:function(){var g=this;Object.keys(this.subscribers).forEach(function(R){var S=g.subscribers[R].onClearTranscript;S()})}},{key:"emitBrowserSupportsSpeechRecognitionChange",value:function(g){var R=this;Object.keys(this.subscribers).forEach(function(S){var m=R.subscribers[S],y=m.onBrowserSupportsSpeechRecognitionChange,i=m.onBrowserSupportsContinuousListeningChange;y(g),i(g)})}},{key:"disconnect",value:function(g){if(this.recognition&&this.listening)switch(g){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}},{key:"disableRecognition",value:function(){this.recognition&&(this.recognition.onresult=function(){},this.recognition.onend=function(){},this.recognition.onerror=function(){},this.listening&&this.stopListening())}},{key:"onError",value:function(g){g&&g.error&&g.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}},{key:"onRecognitionDisconnect",value:function(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}},{key:"updateTranscript",value:function(g){var R=g.results,S=g.resultIndex,m=S===void 0?R.length-1:S;this.interimTranscript="",this.finalTranscript="";for(var y=m;y<R.length;++y)R[y].isFinal&&(!(0,n.default)()||R[y][0].confidence>0)?this.updateFinalTranscript(R[y][0].transcript):this.interimTranscript=(0,t.concatTranscripts)(this.interimTranscript,R[y][0].transcript);var i=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(i=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,i||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}},{key:"updateFinalTranscript",value:function(g){this.finalTranscript=(0,t.concatTranscripts)(this.finalTranscript,g)}},{key:"resetTranscript",value:function(){this.disconnect("RESET")}},{key:"startListening",value:function(){var b=r(regeneratorRuntime.mark(function R(){var S,m,y,i,o,p,w=arguments;return regeneratorRuntime.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(S=w.length>0&&w[0]!==void 0?w[0]:{},m=S.continuous,y=m===void 0?!1:m,i=S.language,this.recognition){j.next=3;break}return j.abrupt("return");case 3:if(o=y!==this.recognition.continuous,p=i&&i!==this.recognition.lang,!(o||p)){j.next=11;break}if(!this.listening){j.next=9;break}return j.next=9,this.stopListening();case 9:this.recognition.continuous=o?y:this.recognition.continuous,this.recognition.lang=p?i:this.recognition.lang;case 11:if(this.listening){j.next=22;break}return this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript()),j.prev=13,j.next=16,this.start();case 16:this.emitListeningChange(!0),j.next=22;break;case 19:j.prev=19,j.t0=j.catch(13),j.t0 instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1);case 22:case"end":return j.stop()}},R,this,[[13,19]])}));function g(){return b.apply(this,arguments)}return g}()},{key:"abortListening",value:function(){var b=r(regeneratorRuntime.mark(function R(){var S=this;return regeneratorRuntime.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return this.disconnect("ABORT"),this.emitListeningChange(!1),y.next=4,new Promise(function(i){S.onStopListening=i});case 4:case"end":return y.stop()}},R,this)}));function g(){return b.apply(this,arguments)}return g}()},{key:"stopListening",value:function(){var b=r(regeneratorRuntime.mark(function R(){var S=this;return regeneratorRuntime.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return this.disconnect("STOP"),this.emitListeningChange(!1),y.next=4,new Promise(function(i){S.onStopListening=i});case 4:case"end":return y.stop()}},R,this)}));function g(){return b.apply(this,arguments)}return g}()},{key:"getRecognition",value:function(){return this.recognition}},{key:"start",value:function(){var b=r(regeneratorRuntime.mark(function R(){return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(this.recognition&&!this.listening)){m.next=4;break}return m.next=3,this.recognition.start();case 3:this.listening=!0;case 4:case"end":return m.stop()}},R,this)}));function g(){return b.apply(this,arguments)}return g}()},{key:"stop",value:function(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}},{key:"abort",value:function(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}}]),v}();e.default=C})(Pt);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.useSpeechRecognition=void 0;var n=z,t=J,f=he,l=De,h=u(Pt),r=u(Ye),a=u(Qe);function u(T){return T&&T.__esModule?T:{default:T}}function A(T,_,E,P,W,M,K){try{var c=T[M](K),s=c.value}catch(d){E(d);return}c.done?_(s):Promise.resolve(s).then(P,W)}function C(T){return function(){var _=this,E=arguments;return new Promise(function(P,W){var M=T.apply(_,E);function K(s){A(M,P,W,K,c,"next",s)}function c(s){A(M,P,W,K,c,"throw",s)}K(void 0)})}}function v(T){return R(T)||g(T)||i(T)||b()}function b(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g(T){if(typeof Symbol<"u"&&Symbol.iterator in Object(T))return Array.from(T)}function R(T){if(Array.isArray(T))return o(T)}function S(T){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?S=function(E){return typeof E}:S=function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},S(T)}function m(T,_){return w(T)||p(T,_)||i(T,_)||y()}function y(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i(T,_){if(T){if(typeof T=="string")return o(T,_);var E=Object.prototype.toString.call(T).slice(8,-1);if(E==="Object"&&T.constructor&&(E=T.constructor.name),E==="Map"||E==="Set")return Array.from(T);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return o(T,_)}}function o(T,_){(_==null||_>T.length)&&(_=T.length);for(var E=0,P=new Array(_);E<_;E++)P[E]=T[E];return P}function p(T,_){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(T)))){var E=[],P=!0,W=!1,M=void 0;try{for(var K=T[Symbol.iterator](),c;!(P=(c=K.next()).done)&&(E.push(c.value),!(_&&E.length===_));P=!0);}catch(s){W=!0,M=s}finally{try{!P&&K.return!=null&&K.return()}finally{if(W)throw M}}return E}}function w(T){if(Array.isArray(T))return T}var x=!!a.default,j=x&&!(0,r.default)(),D,V=function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},E=_.transcribing,P=E===void 0?!0:E,W=_.clearTranscriptOnListen,M=W===void 0?!0:W,K=_.commands,c=K===void 0?[]:K,s=(0,n.useState)(I.getRecognitionManager()),d=m(s,1),L=d[0],k=(0,n.useState)(x),O=m(k,2),q=O[0],H=O[1],Z=(0,n.useState)(j),U=m(Z,2),ge=U[0],ae=U[1],ne=(0,n.useReducer)(l.transcriptReducer,{interimTranscript:L.interimTranscript,finalTranscript:""}),Je=m(ne,2),Xe=Je[0],et=Xe.interimTranscript,tt=Xe.finalTranscript,nt=Je[1],Vt=(0,n.useState)(L.listening),rt=m(Vt,2),Gt=rt[0],Kt=rt[1],Ut=(0,n.useState)(L.isMicrophoneAvailable),it=m(Ut,2),qt=it[0],Ht=it[1],st=(0,n.useRef)(c);st.current=c;var at=function(){nt((0,f.clearTranscript)())},me=(0,n.useCallback)(function(){L.resetTranscript(),at()},[L]),Yt=function(Y,te,oe){var se=S(Y)==="object"?Y.toString():Y,ve=se.replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),Se=(0,t.compareTwoStringsUsingDiceCoefficient)(ve,te);return Se>=oe?{command:Y,commandWithoutSpecials:ve,howSimilar:Se,isFuzzyMatch:!0}:null},Qt=function(Y,te){var oe=(0,t.commandToRegExp)(Y),se=oe.exec(te);return se?{command:Y,parameters:se.slice(1)}:null},ot=(0,n.useCallback)(function(ee,Y){st.current.forEach(function(te){var oe=te.command,se=te.callback,ve=te.matchInterim,Se=ve===void 0?!1:ve,ut=te.isFuzzyMatch,pt=ut===void 0?!1:ut,ft=te.fuzzyMatchingThreshold,Jt=ft===void 0?.8:ft,ht=te.bestMatchOnly,Xt=ht===void 0?!1:ht,Te=!Y&&Se?ee.trim():Y.trim(),en=Array.isArray(oe)?oe:[oe],Re=en.map(function(X){return pt?Yt(X,Te,Jt):Qt(X,Te)}).filter(function(X){return X});if(pt&&Xt&&Re.length>=2){Re.sort(function(X,Ie){return Ie.howSimilar-X.howSimilar});var ze=Re[0],tn=ze.command,nn=ze.commandWithoutSpecials,rn=ze.howSimilar;se(nn,Te,rn,{command:tn,resetTranscript:me})}else Re.forEach(function(X){if(X.isFuzzyMatch){var Ie=X.command,sn=X.commandWithoutSpecials,an=X.howSimilar;se(sn,Te,an,{command:Ie,resetTranscript:me})}else{var on=X.command,cn=X.parameters;se.apply(void 0,v(cn).concat([{command:on,resetTranscript:me}]))}})})},[me]),ct=(0,n.useCallback)(function(ee,Y){P&&nt((0,f.appendTranscript)(ee,Y)),ot(ee,Y)},[ot,P]),lt=(0,n.useCallback)(function(){M&&at()},[M]);(0,n.useEffect)(function(){var ee=I.counter;I.counter+=1;var Y={onListeningChange:Kt,onMicrophoneAvailabilityChange:Ht,onTranscriptChange:ct,onClearTranscript:lt,onBrowserSupportsSpeechRecognitionChange:H,onBrowserSupportsContinuousListeningChange:ae};return L.subscribe(ee,Y),function(){L.unsubscribe(ee)}},[P,M,L,ct,lt]);var Zt=(0,t.concatTranscripts)(tt,et);return{transcript:Zt,interimTranscript:et,finalTranscript:tt,listening:Gt,isMicrophoneAvailable:qt,resetTranscript:me,browserSupportsSpeechRecognition:q,browserSupportsContinuousListening:ge}};e.useSpeechRecognition=V;var I={counter:0,applyPolyfill:function(_){D?D.setSpeechRecognition(_):D=new h.default(_);var E=!!_&&(0,t.browserSupportsPolyfills)();x=E,j=E},removePolyfill:function(){D?D.setSpeechRecognition(a.default):D=new h.default(a.default),x=!!a.default,j=x&&!(0,r.default)()},getRecognitionManager:function(){return D||(D=new h.default(a.default)),D},getRecognition:function(){var _=I.getRecognitionManager();return _.getRecognition()},startListening:function(){var T=C(regeneratorRuntime.mark(function E(){var P,W,M,K,c=arguments;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return P=c.length>0&&c[0]!==void 0?c[0]:{},W=P.continuous,M=P.language,K=I.getRecognitionManager(),d.next=4,K.startListening({continuous:W,language:M});case 4:case"end":return d.stop()}},E)}));function _(){return T.apply(this,arguments)}return _}(),stopListening:function(){var T=C(regeneratorRuntime.mark(function E(){var P;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return P=I.getRecognitionManager(),M.next=3,P.stopListening();case 3:case"end":return M.stop()}},E)}));function _(){return T.apply(this,arguments)}return _}(),abortListening:function(){var T=C(regeneratorRuntime.mark(function E(){var P;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return P=I.getRecognitionManager(),M.next=3,P.abortListening();case 3:case"end":return M.stop()}},E)}));function _(){return T.apply(this,arguments)}return _}(),browserSupportsSpeechRecognition:function(){return x},browserSupportsContinuousListening:function(){return j}},N=I;e.default=N})(xt);(function(e){function n(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(u){return typeof u}:n=function(u){return u&&typeof Symbol=="function"&&u.constructor===Symbol&&u!==Symbol.prototype?"symbol":typeof u},n(r)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"useSpeechRecognition",{enumerable:!0,get:function(){return t.useSpeechRecognition}}),e.default=void 0;var t=l(xt);function f(){if(typeof WeakMap!="function")return null;var r=new WeakMap;return f=function(){return r},r}function l(r){if(r&&r.__esModule)return r;if(r===null||n(r)!=="object"&&typeof r!="function")return{default:r};var a=f();if(a&&a.has(r))return a.get(r);var u={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in r)if(Object.prototype.hasOwnProperty.call(r,C)){var v=A?Object.getOwnPropertyDescriptor(r,C):null;v&&(v.get||v.set)?Object.defineProperty(u,C,v):u[C]=r[C]}return u.default=r,a&&a.set(r,u),u}var h=t.default;e.default=h})(be);const ye=hn(be),{colors:G,shadows:bt,indents:Be}=Q,vr=$e`
  margin-bottom: 7px;
  padding-block: ${Be.xs};

  display: grid;
  align-items: center;
  grid-template-columns: 1fr 25fr 1fr;

  border: 1px solid transparent;
  background-color: ${({licolor:e})=>e};
  border-radius: ${Be.xs};
  font-size: 22px;

  &:last-of-type {
    margin-bottom: ${Be.s};
  }
`,yr=F.li`
  ${vr}

  transition: box-shadow 250ms, border-color 250ms;

  &#active-element {
    border-color: ${G.border};
    background-color: ${G.background};
    box-shadow: ${bt.back};

    &:hover {
      border-color: ${G.accent};
    }
    & div button {
      transition: color 250ms;
      color: ${G.smokeBlack};
      &:hover {
        color: ${G.hovered};
      }
    }
  }

  & div button {
    transition: color 250ms;
    &:hover {
      color: ${G.hovered};
    }
  }

  &:hover {
    border-color: ${G.accent};
    box-shadow: ${bt.back};
  }

  &:hover label,
  &:hover button {
    opacity: 1;
  }
`,Mt=$e`
  min-height: 19px;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  & input {
    ${jn}
  }
`,br=F.label`
  ${Mt}

  & svg {
    transition: stroke 250ms;
    stroke-width: 2px;
    color: ${({$hovered:e})=>e?G.yellow:"transparent"};
    stroke: ${({$hovered:e})=>e?G.yellow:G.border};
  }
  &:hover svg {
    stroke: ${G.placeholder};
  }
`,wr=F.label`
  ${Mt}
  opacity: ${({$hovered:e})=>e?1:0};
  transition: opacity 250ms;

  & svg {
    transition: border-color 250ms, color 250ms;
    padding: 1px;
    border: 2px solid ${G.border};
    border-radius: 50%;
    color: ${({$hovered:e})=>e?G.border:"transparent"};
  }
  &:hover svg {
    border-color: ${G.placeholder};
    color: ${({$hovered:e})=>e?G.placeholder:"transparent"};
  }
`,de=$e`
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: transparent;
  border-color: transparent;
  transition: opacity 250ms color 250ms;
  color: ${G.black};

  & svg {
    transition: color 250ms;
    color: ${G.border};
  }
  &:hover,
  &:hover svg {
    color: ${G.placeholder};
  }
`,$r=F.button`
  ${de}

  opacity: ${({$hovered:e})=>e?1:0};
`,Sr=F.button`
  ${de}

  opacity: 0;
`,{colors:Oe,indents:Ot}=Q,Dt=$e`
  padding-block: 4px;
  display: grid;
  align-items: start;
  grid-template-columns: 20fr 1fr 20fr;
`,Tr=F.div`
  ${Dt}
`,Rr=F.form`
  ${Dt}

  max-height: 70vh;
  overflow-y: scroll;
  scrollbar-width: none;
  grid-template-columns: 12fr 1fr 12fr;
`,wt=F.textarea`
  height: 84px;
  outline: none;
  border: 1px solid ${Oe.accent};
  border-radius: ${Ot.xs};
  resize: none;
  overflow: clip;
  transition: height 150ms;
`,Ar=F.div`
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  &::after {
    content: '';
    height: calc(100% - 8px);
    width: 1px;
    border: 1px solid ${Oe.borderLight};
    transition: border-color 250ms;
  }

  &:hover::after {
    border-color: ${Oe.placeholder};
  }
`,Cr=F.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,kr=F.button`
  ${de}
`;F.button`
  ${de}
`;const qe=F.button`
  ${de}
`,Er=F.button`
  ${de}
`,$t=F.button`
  height: 100%;
  text-align: left;
  display: flex;
  align-items: top;
  background-color: transparent;
  border-color: transparent;
  border-radius: ${Ot.xs};
  color: ${Oe.black};
  transition: background-color 250ms;
`,zt=$e`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
`,_r=F.iframe`
  ${zt}

  height: 60px;
  border-radius: 30px;
`,Lr=F.audio`
  ${zt}
`,Ze=({el:e,setIsForm:n})=>{const t=le(),f=z.useRef(null),l=z.useRef(null),h=z.useRef(null),{user:r}=ue(),{activeCluster:a}=ie(),[u,A]=z.useState(""),{_id:C,element:v,caption:b}=e,{register:g,watch:R,setValue:S,handleSubmit:m,setFocus:y}=Pn({mode:"onBlur",defaultValues:{element:v,caption:b}});z.useEffect(()=>{S("caption",b)},[b,S]);const{ref:i,...o}=g("element"),{ref:p,...w}=g("caption"),x=[f.current,l.current,h.current],j=[R("caption"),R("element")];Nn(x,j),z.useEffect(()=>{y("element"),u&&v.trim().startsWith("der")?S("element",u+v.replace("der","").trim()+", "):u&&v.trim().startsWith("die")?S("element",u+v.replace("die","").trim()+", "):u&&v.trim().startsWith("das")?S("element",u+v.replace("das","").trim()+", "):u?S("element",u+v+", "):S("element",u+v)},[u,v,y,S]),z.useEffect(()=>{const N=async T=>{(T.code==="NumpadAdd"||T.ctrlKey&&T.key==="Escape")&&(T.preventDefault(),await I(r.engine),m(D)()),T.key==="Enter"&&(T.preventDefault(),m(D)()),T.key==="Escape"&&n(!1)};return addEventListener("keydown",N),()=>{removeEventListener("keydown",N)}},[]);const D=N=>{const T=r.lang;let _=N.caption.trim(),E=Ke(N.element,a.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();E=Me(E,","),_=Me(_,","),r.lang.includes("en")&&a.lang.includes("de")&&(E.includes("hat")||E.includes("ist"))&&E.split(`
`)[0].split(/,\s+/)[0].endsWith("n")&&(_=_.split(/,\s+/).map(M=>M.startsWith("to ")?M:`to ${M}`).join(", ")),t(C?je({_id:C,lang:T,element:E,caption:_}):Rt({...e,element:E,caption:_})).then(t(Ct())),n(!1)},V=()=>{u===""&&A("der "),u==="der "&&A("die "),u==="die "&&A("das "),u==="das "&&A("")},I=async N=>{const T=R("element"),_=Ke(T,a.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim(),E={from:a.lang,to:r.lang},P=await we(_,E,N);S("caption",P)};return $.jsxs(Rr,{onSubmit:m(D),children:[$.jsx(wt,{...o,name:"element",ref:N=>{i(N),f.current=N}}),$.jsxs(Cr,{ref:h,children:[$.jsx(Er,{type:"button",onClick:V,children:$.jsx(Mn,{size:"18px"})}),$.jsx(qe,{type:"button",onClick:()=>I("google"),children:$.jsx(dn,{size:"16px"})}),$.jsx(qe,{type:"button",onClick:()=>I("deepl"),children:$.jsx(gn,{size:"18px"})}),$.jsx(kr,{children:$.jsx(mn,{size:"16px"})})]}),$.jsx(wt,{...w,name:"caption",ref:N=>{p(N),l.current=N}})]})};Ze.propTypes={el:B.object,setIsForm:B.func};const{button:xr}=Q.shadows,{m:jr,xl:Pr}=Q.indents,Mr=()=>{const{user:e}=ue(),[n,t]=z.useState(!1),{activeCluster:f}=ie(),[l,h]=z.useState(""),[r,a]=z.useState(""),{transcript:u,listening:A,resetTranscript:C}=be.useSpeechRecognition(),{isMicrophoneAvailable:v}=be.useSpeechRecognition(),{browserSupportsSpeechRecognition:b}=be.useSpeechRecognition(),g=l.endsWith(", ")||l.replace(/[a-z]$/,"*#").endsWith("*#")?u.replace(/^./,i=>` ${i}`):u.replace(/^./,i=>i.toUpperCase()),R=`${l}${g}`,S=On(R,Bn),m=(i,o)=>i.trim().endsWith(o)?`${i.trim()} `:`${i.trim()}${o} `;if(z.useEffect(()=>{if(!A||!n)return;const i=[".","?","!",","],o=p=>{if(i.includes(p.key)){p.preventDefault();const w=m(S,p.key);h(w),C()}if(p.key==="Backspace"){p.preventDefault();const w=S.length-1,x=S.substring(0,w);h(x),C()}if(p.key==="Space"){p.preventDefault();const w=S+" ";h(w),C()}};return addEventListener("keydown",o),()=>{removeEventListener("keydown",o)}},[S,n,A,l,C]),z.useEffect(()=>{const i=async o=>{if(A||(o.key==="Enter"&&(o.preventDefault(),At()),o.metaKey&&o.key==="r"&&!o.altKey&&!o.shiftKey&&(o.preventDefault(),h(""),a(""),t(!0),ye.startListening({language:f.lang,continuous:!0}))),A){if(o.key==="Escape")return o.preventDefault(),ye.stopListening();if(o.metaKey&&o.key==="r"&&!o.altKey&&!o.shiftKey){o.preventDefault(),ye.stopListening();const p=S.at(-1),w=[".","?","!"].includes(p)?S:m(S,"."),x=await we(w,{from:f.lang,to:e.lang},e.engine);a(x),C()}}};return addEventListener("keydown",i),()=>{removeEventListener("keydown",i)}},[f.lang,S,A,C,u,e.engine,e.lang]),!b||!v)return;const y=async i=>{if(i==null||i.currentTarget.blur(),!A)h(""),a(""),t(!0),ye.startListening({language:f.lang,continuous:!0});else{ye.stopListening();const o=[".","?","!"].includes(S.at(-1))?S:m(S,"."),p={from:f.lang,to:e.lang},w=await we(o,p,e.engine);h(o),a(w),C()}};return $.jsxs($.Fragment,{children:[$.jsx(pe,{onClick:y,$s:"m",$round:!0,$bs:xr,children:A?$.jsx(yn,{size:18}):$.jsx(vn,{size:18})}),n&&$.jsx(bn,{$x:`left: ${jr}`,$y:`top: ${Pr}`,$bd:"none",children:$.jsx(Ze,{el:{cluster:f._id,element:S.trim(),caption:r.trim(),favorite:!0,checked:S.split(/\s+/).length<20},setIsForm:t})})]})},{m:Or,s:Dr}=Q.indents,It=({className:e})=>{const{pathname:n}=wn(),{elementTrash:t}=fe(),{activeCluster:f}=ie(),l=t.length>0?" 1fr":"",h=f?" 1fr":"",r=l+h+" 1fr 1fr";if(n.includes("/element"))return $.jsxs(He,{className:e,$m:`${Dr} ${Or}`,$pos:"fixed",$side:"left",$high:"bottom",$gtc:r,children:[$.jsx(Xn,{}),$.jsx(Mr,{}),h&&$.jsx(Hn,{}),l&&$.jsx(Qn,{})]})};It.propTypes={className:B.string};const{colors:We}=Q,zr=F.div`
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  &:hover svg {
    stroke: ${We.yellow};
  }

  & svg {
    transition: stroke 250ms;
    stroke: ${We.hovered};
    /* stroke: ${({$colored:e})=>e&&We.yellow}; */
    @keyframes refresh-spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(-360deg);
      }
    }
    animation: refresh-spin infinite 12s linear;
  }
`,Nt=({onClick:e})=>$.jsx(zr,{onClick:e,children:$.jsx($n,{size:"35px"})});Nt.propTypes={onClick:B.func};const{background:Fe}=Q.colors,{button:St}=Q.shadows,{m:Ir,s:Nr}=Q.indents,Bt=({className:e,filtredElements:n,setLiColor:t})=>{const{user:f}=ue(),{activeCluster:l}=ie(),{activeElement:h}=fe(),[r,a]=z.useState(null);if(z.useEffect(()=>{const m=window.speechSynthesis.getVoices();Array.isArray(m)&&m.length>0&&a(m),"onvoiceschanged"in window.speechSynthesis&&(window.speechSynthesis.onvoiceschanged=()=>{const y=window.speechSynthesis.getVoices();a(y)})},[]),!Array.isArray(r)||r.length===0)return;const u=m=>{if(!m.length)return;let y="",i=0;const o=m.reduce((p,w)=>(p[w.lang]||(p[w.lang]=0),p[w.lang]+=1,p),{});for(const p in o)o[p]>i&&(i=o[p],y=p);return y},A=n.length?u(n):f.lang,C=(m,y)=>m.replaceAll(", `",`;${y} `).replaceAll(" `",`${y} `).replaceAll(",`",";"),v=({text:m,playList:y,divider:i})=>{let o="";for(let p=0;p<y.length;p+=1){let w=y[p][m];const x=`@±@${y[p].lang}${i}`;w.endsWith(".")||w.endsWith("!")||w.endsWith("?")||w.endsWith('"')?(o+=C(w,i).replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",m!=="caption"?`__${i}`:`__${x}`).replaceAll(".",m!=="caption"?`.${i}`:`.${x}`).replaceAll(",",m!=="caption"?`,${i}`:`,${x}`).replaceAll("!",m!=="caption"?`!${i}`:`!${x}`).replaceAll("?",m!=="caption"?`?${i}`:`?${x}`).replaceAll(":",m!=="caption"?`:${i}`:`:${x}`),l.lang.includes("de")&&(o=o.replaceAll(`0.${i}`,"0.").replaceAll(`1.${i}`,"1.").replaceAll(`2.${i}`,"2.").replaceAll(`3.${i}`,"3.").replaceAll(`4.${i}`,"4.").replaceAll(`5.${i}`,"5.").replaceAll(`6.${i}`,"6.").replaceAll(`7.${i}`,"7.").replaceAll(`8.${i}`,"8.").replaceAll(`9.${i}`,"9."))):y[p].element.startsWith("[")||(m==="caption"&&(w.includes(" [")&&(w=w.substring(0,w.indexOf(" ["))),w=`${w}@±@${y[p].lang}`),o+=w+i)}return o},b=r,g=m=>{m.currentTarget.blur(),t(Fe);const y="$*@",i=n.findIndex(w=>w.element===h.element),o=n.splice(i===-1?0:i),p=Pe({setLiColor:t,divider:y,voices:b,text:v({text:"element",playList:o,divider:y}),lang:l.lang,rate:l.rate});p&&re.error(p)},R=m=>{m.currentTarget.blur();const y="$*@";t(Fe);const i=n.findIndex(w=>w.element===h.element),o=n.splice(i===-1?0:i),p=Pe({setLiColor:t,divider:y,voices:b,text:v({text:"caption",playList:o,divider:y}),lang:A,rate:f.rate});p&&re.error(p)},S=m=>{m.currentTarget.blur(),t(Fe);let y="";const i="$*@",o=n.findIndex(x=>x.element===h.element),p=n.splice(o===-1?0:o);for(let x=0;x<p.length;x+=1){const{element:j,caption:D,lang:V}=p[x];if(!j.startsWith("[")){const I=C(j,""),N=D.includes(" [")?D.substring(0,D.indexOf(" [")):C(D,"");y+=I+`@±@${V}`+N+i}}const w=Sn({setLiColor:t,divider:i,voices:b,text:y,lang:l.lang,rate:f.rate});w&&re.error(w)};return $.jsxs(He,{className:e,$m:`${Nr} ${Ir}`,$pos:"fixed",$side:"right",$high:"bottom",$gtc:"1fr 0.5fr 1fr",children:[$.jsx(pe,{onClick:g,$s:"m",$round:!0,$bs:St,children:(l==null?void 0:l.lang.at(0).toUpperCase())+(l==null?void 0:l.lang.substring(1))}),$.jsx(Nt,{onClick:S}),$.jsx(pe,{onClick:R,$s:"m",$round:!0,$bs:St,children:(A==null?void 0:A.at(0).toUpperCase())+(A==null?void 0:A.substring(1))})]})};Bt.propTypes={className:B.string,filtredElements:B.array,setLiColor:B.func};const Wt=({el:e,sortByDate:n,setSortByDate:t,setLiColor:f})=>{const l=le(),{user:h}=ue(),{activeCluster:r}=ie(),{element:a,caption:u}=e,A="$*@",C=(i,o)=>{let p="";return o?(i.trim().endsWith(".")||i.trim().endsWith("!")||i.trim().endsWith("?")||i.endsWith('"')?(p=i.trim().replaceAll(", `",`;${o} `).replaceAll(" `",`${o} `).replaceAll(",`",";").replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",`__${o}`).replaceAll(".",`.${o}`).replaceAll(",",`,${o}`).replaceAll("!",`!${o}`).replaceAll("?",`?${o}`).replaceAll(":",`:${o}`),r.lang.includes("de")&&(p=p.replaceAll(`0.${o}`,"0.").replaceAll(`1.${o}`,"1.").replaceAll(`2.${o}`,"2.").replaceAll(`3.${o}`,"3.").replaceAll(`4.${o}`,"4.").replaceAll(`5.${o}`,"5.").replaceAll(`6.${o}`,"6.").replaceAll(`7.${o}`,"7.").replaceAll(`8.${o}`,"8.").replaceAll(`9.${o}`,"9."))):p=i.trim()+o,p.includes("[")?p.substring(0,p.indexOf("["))+o:p):i},v=i=>{i.currentTarget.blur();const o=Pe({setLiColor:f,divider:A,voices:window.speechSynthesis.getVoices(),text:C(a,A),lang:r.lang,rate:r.rate});o&&re.error(o)},b=i=>{i.currentTarget.blur();const o=Pe({setLiColor:f,divider:A,voices:window.speechSynthesis.getVoices(),text:C(u,A),lang:e.lang,rate:h.rate});o&&re.error(o)},g=i=>{t(!n),n?re.success("Below is Recent"):re.success("Above is Recent"),i.stopPropagation()},R=i=>{const{_id:o}=r;l(kt(e)),i.currentTarget.closest("li").id!=="active-element"&&l(Ve({_id:o,activeEl:e._id}))},S=u.endsWith("mp3"),m=!S&&u.startsWith("http"),y=!S&&!m;return $.jsxs(Tr,{onClick:R,children:[$.jsx($t,{onClick:v,children:a}),$.jsx(Ar,{onClick:g}),S&&$.jsx(Lr,{controls:!0,src:mt(u)}),m&&$.jsx(_r,{src:mt(u)}),y&&$.jsx($t,{onClick:b,children:u})]})};Wt.propTypes={el:B.object,sortByDate:B.bool,setSortByDate:B.func,$active:B.bool,$hovered:B.bool,setLiColor:B.func};const Ft=({el:e,index:n,length:t,sortByDate:f,setSortByDate:l,translateAll:h,liColor:r,setLiColor:a})=>{const u=le(),{elementTrash:A,activeElement:C}=fe(),[v,b]=z.useState(!1),{_id:g,favorite:R,checked:S}=e,m=A.find(x=>x._id===g),y=()=>{u(je({_id:g,favorite:!R}))},i=()=>{u(je({_id:g,checked:!S}))},o=()=>u(kn(e)),p=()=>b(!v),w=g===(C==null?void 0:C._id);return $.jsxs(yr,{id:w?"active-element":null,licolor:r,children:[$.jsxs(Ge,{$h:"100%",$p:"0",$fd:"column",children:[$.jsxs(br,{$hovered:R,children:[$.jsx("input",{type:"checkbox",name:"favorite",checked:R,onChange:y}),$.jsx(xn,{size:"20px"})]}),$.jsxs(wr,{$hovered:S,children:[$.jsx("input",{type:"checkbox",name:"checked",checked:S,onChange:i}),$.jsx(Tn,{size:"15px"})]}),v&&t===n+1&&$.jsx(qe,{onClick:h,children:$.jsx(Rn,{size:"16px"})})]}),v&&$.jsx(Ze,{el:e,setIsForm:b}),!v&&$.jsx(Wt,{el:e,sortByDate:f,setSortByDate:l,setLiColor:a}),$.jsxs(Ge,{$h:"100%",$p:"0",$fd:"column",children:[$.jsx($r,{$hovered:m,onClick:o,children:$.jsx(An,{size:"16px"})}),$.jsx(Sr,{onClick:p,children:$.jsx(Cn,{size:"15px"})})]})]})};Ft.propTypes={el:B.object,index:B.number,length:B.number,sortByDate:B.bool,setSortByDate:B.func,translateAll:B.func,liColor:B.string,setLiColor:B.func};const Br=F.ul`
  width: 100%;
  list-style: none;
`,{white:Wr}=Q.colors,Fr=()=>{const e=le(),{ref:n,inView:t,entry:f}=Un({initialInView:!0,rootMargin:"0px 0px -30px 0px"}),{user:l}=ue(),{activeCluster:h}=ie(),{allElements:r,elementTrash:a,elementFilter:u,isLoading:A}=fe(),[C,v]=z.useState(Wr);let{elementSelect:b}=fe();b=b||[];const[g,R]=z.useState(!1);z.useEffect(()=>{h&&e(Ct({cluster:h._id})).unwrap().then(({result:p})=>{if(!h.activeEl)return;const w=p.elements.find(({_id:x})=>x===h.activeEl);e(kt(w))}).then(()=>{const p=document.getElementById("active-element");p&&En(p)})},[]);const S=r.filter(p=>p.cluster===(h==null?void 0:h._id)).sort((p,w)=>p.createdAt.localeCompare(w.createdAt)),y=(()=>{const p=a.map(w=>w._id);return b.includes("trash")?S.filter(w=>p.includes(w._id)):S})().filter(({element:p,caption:w,favorite:x,checked:j})=>{const D=p.toLowerCase().replace("·","").includes(u)||p.toLowerCase().includes(u)||w.toLowerCase().includes(u),V=b.includes("wordlist")?D&&Dn(p):D,I=()=>b.some(T=>["favorite","unfavorite"].includes(T))?b.includes("favorite")?V&&x===!0:V&&x===!1:V;return(()=>b.some(T=>["checked","unchecked"].includes(T))?b.includes("checked")?I()&&j===!0:I()&&j===!1:I())()}).sort(g?(p,w)=>w.createdAt.localeCompare(p.createdAt):(p,w)=>p.createdAt.localeCompare(w.createdAt)),i=async()=>{const p=l.lang;let w=0;await y.forEach(async x=>{if(w>1)return;const{_id:j,element:D}=x;if(!D.startsWith("[")||p!==x.lang){const V={from:h.lang,to:p},I=await we(D,V,l.engine);e(je({_id:j,lang:p,caption:I})),w=w+1}})},o=window.innerHeight<(f==null?void 0:f.target.getBoundingClientRect().y)+(f==null?void 0:f.target.getBoundingClientRect().height)*1.5;return $.jsxs($.Fragment,{children:[$.jsxs(Br,{children:[y.map((p,w,x)=>$.jsx(Ft,{el:p,index:w,length:x.length,sortByDate:g,setSortByDate:R,translateAll:i,liColor:C,setLiColor:v},p._id)),$.jsxs("div",{ref:n,children:[$.jsx(Lt,{}),$.jsx(It,{className:!t||!o?"shown":"hidden"}),$.jsx(Bt,{className:!t||!o?"shown":"hidden",filtredElements:y,setLiColor:v})]})]}),A&&$.jsx(_n,{})]})},{s:Tt,m:Vr}=Q.indents,Yr=()=>$.jsx(Ge,{$p:`0 ${Vr} ${Tt} ${Tt}`,children:$.jsx(Fr,{})});export{Yr as default};
