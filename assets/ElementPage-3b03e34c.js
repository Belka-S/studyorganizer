import{U as Ne,r as z,t as Q,P as B,u as le,b as ue,q as ie,j as $,T as He,V as Ae,x as Ve,E as dt,H as gt,w as pe,S as ln,W as Rt,X as At,Q as re,z as fe,Y as un,Z as pn,G as fn,i as hn,n as $e,s as F,_ as dn,$ as gn,a0 as mn,a1 as je,a2 as Ct,a3 as vn,a4 as bn,M as yn,a5 as wn,a6 as $n,a7 as Pe,a8 as Sn,a9 as mt,aa as kt,F as Ge,D as Tn,ab as Rn,C as An,A as Cn,ac as kn,N as En,ad as _n}from"./index-3e8cd1d8.js";import{r as Et,H as Ln,T as xn}from"./index-9aa80dbc.js";import{w as _t}from"./writeClipboard-88c5ca67.js";import{v as jn,u as Pn}from"./index.esm-d156379d.js";import{a as Mn}from"./index-0c4210ff.js";const Ke=(e,n)=>{if(!n.includes("de"))return e;const t=e.trim().split(`
`);return t.length===1?e:["der","die","das"].includes(t[0].split(" ")[0])?`${t[0].trim()}, ${t[1].split("·")[1].replaceAll("⁰","").replaceAll("/"," / ").trim()}`:(e.includes("hat")||e.includes("ist"))&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e.includes("am")&&!t[0].trim().includes(" ")?`${t[0].trim()}, ${t[1].split("·")[1].trim()}, `+t[1].split("·")[2]:e},On=(e,n)=>{let t=e;for(const r in n)t=t.replaceAll(r,n[r]);const h=r=>r.replace(/^./,a=>a.toUpperCase()),l=[...t.split(/\s+/)];for(let r=0;r<l.length;r+=1)[".","!","?"].includes(l[r].at(-1))&&l[r+1]&&l.splice(r+1,1,h(l[r+1]));return l.join(" ")},Dn=e=>/[a-z]/.test(e.charAt(0)),{VITE_DEEPL_API_KEY:zn}={VITE_GOOGLE_CLIENT_ID:"689266183428-lh3lmpaqnd2qd6t93voa8s6ipt3836q1.apps.googleusercontent.com",VITE_DEEPL_API_KEY:"d15bf272-fb1f-4f29-bbc3-d3bbdd686c53:fx",VITE_GOOGLE_API_KEY:"AIzaSyDqQndBxYEuOG7F6iYDqQoiNF90tptRmBQ",VITE_PROD_BACK_URL:"https://studyorganizer.onrender.com",BASE_URL:"/studyorganizer/",MODE:"production",DEV:!1,PROD:!0,SSR:!1},In={google:"",deepl:zn},we=async(e,{from:n,to:t},h)=>{var f,r;if(!e||e.length===0)return"";const l=e.replaceAll(" ·",",").replaceAll("·","");Ne.engine=h,Ne.key=In[h];try{let a=await Ne(`${l}`,{from:n,to:t});if(t.includes("en")&&l.toLowerCase().includes("uhr")&&(a=a.replaceAll("a.m. on","am on").replaceAll("p.m. on","pm on").replaceAll("a.m. to","am to").replaceAll("p.m. to","pm to").replaceAll("a.m.","am.").replaceAll("p.m.","pm.")),[".","!","?"].includes(l.at(-1)))return a;const A=l.split(l.includes(", ")?", ":/\s+/),C=a.split(", "),v=t.includes("de")?C[0]:C[0].at(0).toLowerCase()+C[0].substring(1);return A.length===1?a.toLocaleLowerCase()+", ":["der","die","das"].includes(A[0].split(" ")[0])?a.replace("The ","").replace("the ","").split(", ")[0].toLocaleLowerCase()+", ":t.includes("en")&&((f=A[2])!=null&&f.startsWith("am"))?C[2].startsWith("the")?a:`${v}, ${C[1]}, the ${C[2]}`:(A[0].endsWith("n")&&["hat","ist"].includes((r=A[2])==null?void 0:r.split(" ")[0])&&n.includes("de")&&(a=t.includes("en")?"to "+v+", ":v+", "),a)}catch(a){return a.message}},Me=(e,n)=>e.endsWith(n)?e.substring(0,e.length-1):e,Nn=(e,n)=>{let t=84;e[0]&&(t=Number(e[0].style.height.replace("px",""))),z.useEffect(()=>{if(!e[0])return;let h=Math.max(...e.map(l=>l.scrollHeight));t!==h&&(h=h<=90?h:h+6,e.forEach(l=>{l.style.height=h+"px"}))},[t,e,n])},Ce=[{value:"de",label:"German"},{value:"en",label:"English"},{value:"uk",label:"Ukrainian"},{value:"ru",label:"Russian"},{value:"es",label:"Spanish"},{value:"fr",label:"French"},{value:"it",label:"Italian"}],ke=[{value:.3,label:"Rate: 0.3"},{value:.4,label:"Rate: 0.4"},{value:.5,label:"Rate: 0.5"},{value:.6,label:"Rate: 0.6"},{value:.8,label:"Rate: 0.8"},{value:1,label:"Rate: 1"},{value:1.25,label:"Rate: 1.25"},{value:1.5,label:"Rate: 1.5"}],Bn={"..":".",". .":".",",,":",",", ,":","},Wn={" Dot":"."," dot":"."," exclamation mark":"!"," question mark":"?"," comma":","," colon":":"," semi-colon":";","Yes ":"Yes, ","No ":"No, "},Fn={" Punkt":"."," Ausrufezeichen":"!"," Fragezeichen":"?"," Komma":","," Doppelpunkt":":"," Semikolon":";","Ja ":"Ja, ","Nein ":"Nein, "," weil":", weil"," aber":", aber"," als":", als"," ob":", ob"," damit":", damit"," bevor":", bevor"," obwohl":", obwohl"," dass":", dass"," dann":", dann"," deshalb":", deshalb"," desvegen":", desvegen"," trotzdem":", trotzdem"},Vn={...Wn,...Fn,...Bn};var Ue=new Map,Ee=new WeakMap,vt=0,Gn=void 0;function Kn(e){return e?(Ee.has(e)||(vt+=1,Ee.set(e,vt.toString())),Ee.get(e)):"0"}function Un(e){return Object.keys(e).sort().filter(n=>e[n]!==void 0).map(n=>`${n}_${n==="root"?Kn(e.root):e[n]}`).toString()}function qn(e){const n=Un(e);let t=Ue.get(n);if(!t){const h=new Map;let l;const f=new IntersectionObserver(r=>{r.forEach(a=>{var p;const A=a.isIntersecting&&l.some(C=>a.intersectionRatio>=C);e.trackVisibility&&typeof a.isVisible>"u"&&(a.isVisible=A),(p=h.get(a.target))==null||p.forEach(C=>{C(A,a)})})},e);l=f.thresholds||(Array.isArray(e.threshold)?e.threshold:[e.threshold||0]),t={id:n,observer:f,elements:h},Ue.set(n,t)}return t}function Hn(e,n,t={},h=Gn){if(typeof window.IntersectionObserver>"u"&&h!==void 0){const p=e.getBoundingClientRect();return n(h,{isIntersecting:h,target:e,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:p,intersectionRect:p,rootBounds:p}),()=>{}}const{id:l,observer:f,elements:r}=qn(t),a=r.get(e)||[];return r.has(e)||r.set(e,a),a.push(n),f.observe(e),function(){a.splice(a.indexOf(n),1),a.length===0&&(r.delete(e),f.unobserve(e)),r.size===0&&(f.disconnect(),Ue.delete(l))}}function Yn({threshold:e,delay:n,trackVisibility:t,rootMargin:h,root:l,triggerOnce:f,skip:r,initialInView:a,fallbackInView:p,onChange:A}={}){var C;const[v,w]=z.useState(null),g=z.useRef(A),[R,S]=z.useState({inView:!!a,entry:void 0});g.current=A,z.useEffect(()=>{if(r||!v)return;let o;return o=Hn(v,(u,y)=>{S({inView:u,entry:y}),g.current&&g.current(u,y),y.isIntersecting&&f&&o&&(o(),o=void 0)},{root:l,rootMargin:h,threshold:e,trackVisibility:t,delay:n},p),()=>{o&&o()}},[Array.isArray(e)?e.toString():e,v,l,h,f,r,t,p,n]);const m=(C=R.entry)==null?void 0:C.target,b=z.useRef(void 0);!v&&m&&!f&&!r&&b.current!==m&&(b.current=m,S({inView:!!a,entry:void 0}));const i=[w,R.inView,R.entry];return i.ref=i[0],i.inView=i[1],i.entry=i[2],i}const{backgroundHoverd:_e,white:Le,borderLight:xe}=Q.colors,Lt=()=>{const e=le(),{user:n}=ue(),{activeCluster:t}=ie(),h=({value:a})=>{e(Ve({_id:t._id,lang:a})).unwrap().then(p=>e(dt(p.result.cluster)))},l=({value:a})=>{e(Ve({_id:t._id,rate:a})).unwrap().then(p=>e(dt(p.result.cluster)))},f=({value:a})=>{const p=new FormData;p.append("lang",a),e(gt(p))},r=({value:a})=>{const p=new FormData;p.append("rate",a),e(gt(p))};return $.jsxs(He,{$m:"0",$cg:"8px",$ai:"center",$gtc:"2fr 2fr 2fr 2fr",children:[$.jsx(Ae,{options:Ce,defaultValue:Ce.find(a=>a.value===(t==null?void 0:t.lang)),onChange:h,placeholder:"Language...",$ol:_e,$b:Le,$bh:xe}),$.jsx(Ae,{options:ke,defaultValue:ke.find(a=>a.value==(t==null?void 0:t.rate)),onChange:l,placeholder:"Rate...",$ol:_e,$b:Le,$bh:xe}),$.jsx(Ae,{options:Ce,defaultValue:Ce.find(a=>a.value===n.lang),onChange:f,placeholder:"Language...",$ol:_e,$b:Le,$bh:xe}),$.jsx(Ae,{options:ke,defaultValue:ke.find(a=>a.value==n.rate),onChange:r,placeholder:"Rate...",$ol:_e,$b:Le,$bh:xe})]})};Lt.propTypes={filtredElements:B.array,setLiColor:B.func};const{button:Qn}=Q.shadows,Zn=()=>{const e=le(),{user:n}=ue(),{activeCluster:t}=ie();z.useEffect(()=>{const l=async f=>{f.key==="e"&&f.metaKey&&!f.altKey&&!f.shiftKey&&(f.preventDefault(),await h())};return addEventListener("keydown",l),()=>{removeEventListener("keydown",l)}},[]);const h=async l=>{const f=window.getSelection().toString();f&&await _t(f);const r=await Et();let a=Ke(r,t.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();a=Me(a,",");const p={from:t.lang,to:n.lang};let A=await we(a,p,n.engine);A=Me(A.trim(),",");const{_id:C}=t;try{const v={cluster:C,element:"[]",caption:a},w={cluster:C,element:a,caption:A,favorite:!0,checked:a.split(/\s+/).length<20},g=a.includes("https://")?v:w;e(Rt(g)).unwrap().then(()=>(l==null?void 0:l.target)&&At()).finally(()=>{var R;return(R=l==null?void 0:l.target)==null?void 0:R.blur()})}catch(v){l==null||l.currentTarget.blur(),re.error(`Invalid element, ${v.message}`)}};return $.jsx(pe,{onClick:h,$s:"m",$round:!0,$bs:Qn,children:$.jsx(ln,{size:18})})},{button:Jn}=Q.shadows,Xn=()=>{const e=le(),{elementTrash:n}=fe(),t=()=>{confirm("Are you sure you want to delete the selected Element(s)?")&&e(un(n.map(h=>h._id).join("&"))).unwrap().then(()=>e(pn()))};return $.jsx(pe,{onClick:t,$s:"m",$round:!0,$bs:Jn,children:$.jsx(Ln,{size:16})})};function er(e){return fn({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M250.73,210.63l-56-112a12,12,0,0,0-21.46,0l-20.52,41A84.2,84.2,0,0,1,114,126.22,107.48,107.48,0,0,0,139.33,68H160a12,12,0,0,0,0-24H108V32a12,12,0,0,0-24,0V44H32a12,12,0,0,0,0,24h83.13A83.69,83.69,0,0,1,96,110.35,84,84,0,0,1,83.6,91a12,12,0,1,0-21.81,10A107.55,107.55,0,0,0,78,126.24,83.54,83.54,0,0,1,32,140a12,12,0,0,0,0,24,107.47,107.47,0,0,0,64-21.07,108.4,108.4,0,0,0,45.39,19.44l-24.13,48.26a12,12,0,1,0,21.46,10.73L151.41,196h65.17l12.68,25.36a12,12,0,1,0,21.47-10.73ZM163.41,172,184,130.83,204.58,172Z"},child:[]}]})(e)}const{button:tr}=Q.shadows,nr=()=>{const{activeCluster:e}=ie();z.useEffect(()=>{const f=async r=>{r.metaKey&&r.key==="d"&&!r.altKey&&!r.shiftKey&&(r.preventDefault(),await l())};return addEventListener("keydown",f),()=>{removeEventListener("keydown",f)}},[]);let n=[];function t(f){f.forEach(r=>{const a=window.open(r,"_blank");a?n.push(a):re.error(`Failed to open tab: ${r}`)})}const h=()=>{n.forEach(f=>{f.close()}),n=[]},l=async()=>{const f=window.getSelection().toString();f&&await _t(f);const r=await Et();let a=[];e.lang.includes("de")&&a.push(`https://www.verbformen.com/conjugation/?w=${r}`),e.lang.includes("en")&&a.push(`https://dictionary.cambridge.org/dictionary/english-russian/${r}`),h(),t(a)};return $.jsx(pe,{onClick:l,$s:"m",$round:!0,$bs:tr,children:$.jsx(er,{size:18})})};var rr={exports:{}};(function(e){var n=function(t){var h=Object.prototype,l=h.hasOwnProperty,f=Object.defineProperty||function(c,s,d){c[s]=d.value},r,a=typeof Symbol=="function"?Symbol:{},p=a.iterator||"@@iterator",A=a.asyncIterator||"@@asyncIterator",C=a.toStringTag||"@@toStringTag";function v(c,s,d){return Object.defineProperty(c,s,{value:d,enumerable:!0,configurable:!0,writable:!0}),c[s]}try{v({},"")}catch{v=function(s,d,L){return s[d]=L}}function w(c,s,d,L){var k=s&&s.prototype instanceof o?s:o,O=Object.create(k.prototype),q=new W(L||[]);return f(O,"_invoke",{value:T(c,d,q)}),O}t.wrap=w;function g(c,s,d){try{return{type:"normal",arg:c.call(s,d)}}catch(L){return{type:"throw",arg:L}}}var R="suspendedStart",S="suspendedYield",m="executing",b="completed",i={};function o(){}function u(){}function y(){}var x={};v(x,p,function(){return this});var j=Object.getPrototypeOf,D=j&&j(j(M([])));D&&D!==h&&l.call(D,p)&&(x=D);var V=y.prototype=o.prototype=Object.create(x);u.prototype=y,f(V,"constructor",{value:y,configurable:!0}),f(y,"constructor",{value:u,configurable:!0}),u.displayName=v(y,C,"GeneratorFunction");function I(c){["next","throw","return"].forEach(function(s){v(c,s,function(d){return this._invoke(s,d)})})}t.isGeneratorFunction=function(c){var s=typeof c=="function"&&c.constructor;return s?s===u||(s.displayName||s.name)==="GeneratorFunction":!1},t.mark=function(c){return Object.setPrototypeOf?Object.setPrototypeOf(c,y):(c.__proto__=y,v(c,C,"GeneratorFunction")),c.prototype=Object.create(V),c},t.awrap=function(c){return{__await:c}};function N(c,s){function d(O,q,H,Z){var U=g(c[O],c,q);if(U.type==="throw")Z(U.arg);else{var ge=U.arg,ae=ge.value;return ae&&typeof ae=="object"&&l.call(ae,"__await")?s.resolve(ae.__await).then(function(ne){d("next",ne,H,Z)},function(ne){d("throw",ne,H,Z)}):s.resolve(ae).then(function(ne){ge.value=ne,H(ge)},function(ne){return d("throw",ne,H,Z)})}}var L;function k(O,q){function H(){return new s(function(Z,U){d(O,q,Z,U)})}return L=L?L.then(H,H):H()}f(this,"_invoke",{value:k})}I(N.prototype),v(N.prototype,A,function(){return this}),t.AsyncIterator=N,t.async=function(c,s,d,L,k){k===void 0&&(k=Promise);var O=new N(w(c,s,d,L),k);return t.isGeneratorFunction(s)?O:O.next().then(function(q){return q.done?q.value:O.next()})};function T(c,s,d){var L=R;return function(O,q){if(L===m)throw new Error("Generator is already running");if(L===b){if(O==="throw")throw q;return K()}for(d.method=O,d.arg=q;;){var H=d.delegate;if(H){var Z=_(H,d);if(Z){if(Z===i)continue;return Z}}if(d.method==="next")d.sent=d._sent=d.arg;else if(d.method==="throw"){if(L===R)throw L=b,d.arg;d.dispatchException(d.arg)}else d.method==="return"&&d.abrupt("return",d.arg);L=m;var U=g(c,s,d);if(U.type==="normal"){if(L=d.done?b:S,U.arg===i)continue;return{value:U.arg,done:d.done}}else U.type==="throw"&&(L=b,d.method="throw",d.arg=U.arg)}}}function _(c,s){var d=s.method,L=c.iterator[d];if(L===r)return s.delegate=null,d==="throw"&&c.iterator.return&&(s.method="return",s.arg=r,_(c,s),s.method==="throw")||d!=="return"&&(s.method="throw",s.arg=new TypeError("The iterator does not provide a '"+d+"' method")),i;var k=g(L,c.iterator,s.arg);if(k.type==="throw")return s.method="throw",s.arg=k.arg,s.delegate=null,i;var O=k.arg;if(!O)return s.method="throw",s.arg=new TypeError("iterator result is not an object"),s.delegate=null,i;if(O.done)s[c.resultName]=O.value,s.next=c.nextLoc,s.method!=="return"&&(s.method="next",s.arg=r);else return O;return s.delegate=null,i}I(V),v(V,C,"Generator"),v(V,p,function(){return this}),v(V,"toString",function(){return"[object Generator]"});function E(c){var s={tryLoc:c[0]};1 in c&&(s.catchLoc=c[1]),2 in c&&(s.finallyLoc=c[2],s.afterLoc=c[3]),this.tryEntries.push(s)}function P(c){var s=c.completion||{};s.type="normal",delete s.arg,c.completion=s}function W(c){this.tryEntries=[{tryLoc:"root"}],c.forEach(E,this),this.reset(!0)}t.keys=function(c){var s=Object(c),d=[];for(var L in s)d.push(L);return d.reverse(),function k(){for(;d.length;){var O=d.pop();if(O in s)return k.value=O,k.done=!1,k}return k.done=!0,k}};function M(c){if(c!=null){var s=c[p];if(s)return s.call(c);if(typeof c.next=="function")return c;if(!isNaN(c.length)){var d=-1,L=function k(){for(;++d<c.length;)if(l.call(c,d))return k.value=c[d],k.done=!1,k;return k.value=r,k.done=!0,k};return L.next=L}}throw new TypeError(typeof c+" is not iterable")}t.values=M;function K(){return{value:r,done:!0}}return W.prototype={constructor:W,reset:function(c){if(this.prev=0,this.next=0,this.sent=this._sent=r,this.done=!1,this.delegate=null,this.method="next",this.arg=r,this.tryEntries.forEach(P),!c)for(var s in this)s.charAt(0)==="t"&&l.call(this,s)&&!isNaN(+s.slice(1))&&(this[s]=r)},stop:function(){this.done=!0;var c=this.tryEntries[0],s=c.completion;if(s.type==="throw")throw s.arg;return this.rval},dispatchException:function(c){if(this.done)throw c;var s=this;function d(Z,U){return O.type="throw",O.arg=c,s.next=Z,U&&(s.method="next",s.arg=r),!!U}for(var L=this.tryEntries.length-1;L>=0;--L){var k=this.tryEntries[L],O=k.completion;if(k.tryLoc==="root")return d("end");if(k.tryLoc<=this.prev){var q=l.call(k,"catchLoc"),H=l.call(k,"finallyLoc");if(q&&H){if(this.prev<k.catchLoc)return d(k.catchLoc,!0);if(this.prev<k.finallyLoc)return d(k.finallyLoc)}else if(q){if(this.prev<k.catchLoc)return d(k.catchLoc,!0)}else if(H){if(this.prev<k.finallyLoc)return d(k.finallyLoc)}else throw new Error("try statement without catch or finally")}}},abrupt:function(c,s){for(var d=this.tryEntries.length-1;d>=0;--d){var L=this.tryEntries[d];if(L.tryLoc<=this.prev&&l.call(L,"finallyLoc")&&this.prev<L.finallyLoc){var k=L;break}}k&&(c==="break"||c==="continue")&&k.tryLoc<=s&&s<=k.finallyLoc&&(k=null);var O=k?k.completion:{};return O.type=c,O.arg=s,k?(this.method="next",this.next=k.finallyLoc,i):this.complete(O)},complete:function(c,s){if(c.type==="throw")throw c.arg;return c.type==="break"||c.type==="continue"?this.next=c.arg:c.type==="return"?(this.rval=this.arg=c.arg,this.method="return",this.next="end"):c.type==="normal"&&s&&(this.next=s),i},finish:function(c){for(var s=this.tryEntries.length-1;s>=0;--s){var d=this.tryEntries[s];if(d.finallyLoc===c)return this.complete(d.completion,d.afterLoc),P(d),i}},catch:function(c){for(var s=this.tryEntries.length-1;s>=0;--s){var d=this.tryEntries[s];if(d.tryLoc===c){var L=d.completion;if(L.type==="throw"){var k=L.arg;P(d)}return k}}throw new Error("illegal catch attempt")},delegateYield:function(c,s,d){return this.delegate={iterator:M(c),resultName:s,nextLoc:d},this.method==="next"&&(this.arg=r),i}},t}(e.exports);try{regeneratorRuntime=n}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}})(rr);var ye={},xt={},J={};Object.defineProperty(J,"__esModule",{value:!0});J.browserSupportsPolyfills=J.compareTwoStringsUsingDiceCoefficient=J.commandToRegExp=J.concatTranscripts=J.debounce=void 0;var ir=function(n,t,h){var l;return function(){var f=this,r=arguments,a=function(){l=null,h||n.apply(f,r)},p=h&&!l;clearTimeout(l),l=setTimeout(a,t),p&&n.apply(f,r)}};J.debounce=ir;var sr=function(){for(var n=arguments.length,t=new Array(n),h=0;h<n;h++)t[h]=arguments[h];return t.map(function(l){return l.trim()}).join(" ").trim()};J.concatTranscripts=sr;var ar=/\s*\((.*?)\)\s*/g,or=/(\(\?:[^)]+\))\?/g,cr=/(\(\?)?:\w+/g,lr=/\*/g,ur=/[-{}[\]+?.,\\^$|#]/g,pr=function(n){return n instanceof RegExp?new RegExp(n.source,"i"):(n=n.replace(ur,"\\$&").replace(ar,"(?:$1)?").replace(cr,function(t,h){return h?t:"([^\\s]+)"}).replace(lr,"(.*?)").replace(or,"\\s*$1?\\s*"),new RegExp("^"+n+"$","i"))};J.commandToRegExp=pr;var fr=function(n,t){if(n=n.replace(/\s+/g,"").toLowerCase(),t=t.replace(/\s+/g,"").toLowerCase(),!n.length&&!t.length)return 1;if(!n.length||!t.length)return 0;if(n===t)return 1;if(n.length===1&&t.length===1||n.length<2||t.length<2)return 0;for(var h=new Map,l=0;l<n.length-1;l++){var f=n.substring(l,l+2),r=h.has(f)?h.get(f)+1:1;h.set(f,r)}for(var a=0,p=0;p<t.length-1;p++){var A=t.substring(p,p+2),C=h.has(A)?h.get(A):0;C>0&&(h.set(A,C-1),a++)}return 2*a/(n.length+t.length-2)};J.compareTwoStringsUsingDiceCoefficient=fr;var hr=function(){return typeof window<"u"&&window.navigator!==void 0&&window.navigator.mediaDevices!==void 0&&window.navigator.mediaDevices.getUserMedia!==void 0&&(window.AudioContext!==void 0||window.webkitAudioContext!==void 0)};J.browserSupportsPolyfills=hr;var he={},ce={};Object.defineProperty(ce,"__esModule",{value:!0});ce.APPEND_TRANSCRIPT=ce.CLEAR_TRANSCRIPT=void 0;var dr="CLEAR_TRANSCRIPT";ce.CLEAR_TRANSCRIPT=dr;var gr="APPEND_TRANSCRIPT";ce.APPEND_TRANSCRIPT=gr;Object.defineProperty(he,"__esModule",{value:!0});he.appendTranscript=he.clearTranscript=void 0;var jt=ce,mr=function(){return{type:jt.CLEAR_TRANSCRIPT}};he.clearTranscript=mr;var vr=function(n,t){return{type:jt.APPEND_TRANSCRIPT,payload:{interimTranscript:n,finalTranscript:t}}};he.appendTranscript=vr;var De={};Object.defineProperty(De,"__esModule",{value:!0});De.transcriptReducer=void 0;var bt=ce,br=J,yr=function(n,t){switch(t.type){case bt.CLEAR_TRANSCRIPT:return{interimTranscript:"",finalTranscript:""};case bt.APPEND_TRANSCRIPT:return{interimTranscript:t.payload.interimTranscript,finalTranscript:(0,br.concatTranscripts)(n.finalTranscript,t.payload.finalTranscript)};default:throw new Error}};De.transcriptReducer=yr;var Pt={},Ye={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=function(){return/(android)/i.test(typeof navigator<"u"?navigator.userAgent:"")};e.default=n})(Ye);var Qe={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.isNative=void 0;var n=typeof window<"u"&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),t=function(f){return f===n};e.isNative=t;var h=n;e.default=h})(Qe);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=l(Ye),t=J,h=Qe;function l(v){return v&&v.__esModule?v:{default:v}}function f(v,w,g,R,S,m,b){try{var i=v[m](b),o=i.value}catch(u){g(u);return}i.done?w(o):Promise.resolve(o).then(R,S)}function r(v){return function(){var w=this,g=arguments;return new Promise(function(R,S){var m=v.apply(w,g);function b(o){f(m,R,S,b,i,"next",o)}function i(o){f(m,R,S,b,i,"throw",o)}b(void 0)})}}function a(v,w){if(!(v instanceof w))throw new TypeError("Cannot call a class as a function")}function p(v,w){for(var g=0;g<w.length;g++){var R=w[g];R.enumerable=R.enumerable||!1,R.configurable=!0,"value"in R&&(R.writable=!0),Object.defineProperty(v,R.key,R)}}function A(v,w,g){return w&&p(v.prototype,w),g&&p(v,g),v}var C=function(){function v(w){a(this,v),this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=function(){},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(w),(0,n.default)()&&(this.updateFinalTranscript=(0,t.debounce)(this.updateFinalTranscript,250,!0))}return A(v,[{key:"setSpeechRecognition",value:function(g){var R=!!g&&((0,h.isNative)(g)||(0,t.browserSupportsPolyfills)());R&&(this.disableRecognition(),this.recognition=new g,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(R)}},{key:"subscribe",value:function(g,R){this.subscribers[g]=R}},{key:"unsubscribe",value:function(g){delete this.subscribers[g]}},{key:"emitListeningChange",value:function(g){var R=this;this.listening=g,Object.keys(this.subscribers).forEach(function(S){var m=R.subscribers[S].onListeningChange;m(g)})}},{key:"emitMicrophoneAvailabilityChange",value:function(g){var R=this;this.isMicrophoneAvailable=g,Object.keys(this.subscribers).forEach(function(S){var m=R.subscribers[S].onMicrophoneAvailabilityChange;m(g)})}},{key:"emitTranscriptChange",value:function(g,R){var S=this;Object.keys(this.subscribers).forEach(function(m){var b=S.subscribers[m].onTranscriptChange;b(g,R)})}},{key:"emitClearTranscript",value:function(){var g=this;Object.keys(this.subscribers).forEach(function(R){var S=g.subscribers[R].onClearTranscript;S()})}},{key:"emitBrowserSupportsSpeechRecognitionChange",value:function(g){var R=this;Object.keys(this.subscribers).forEach(function(S){var m=R.subscribers[S],b=m.onBrowserSupportsSpeechRecognitionChange,i=m.onBrowserSupportsContinuousListeningChange;b(g),i(g)})}},{key:"disconnect",value:function(g){if(this.recognition&&this.listening)switch(g){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;case"STOP":default:this.pauseAfterDisconnect=!0,this.stop()}}},{key:"disableRecognition",value:function(){this.recognition&&(this.recognition.onresult=function(){},this.recognition.onend=function(){},this.recognition.onerror=function(){},this.listening&&this.stopListening())}},{key:"onError",value:function(g){g&&g.error&&g.error==="not-allowed"&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}},{key:"onRecognitionDisconnect",value:function(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}},{key:"updateTranscript",value:function(g){var R=g.results,S=g.resultIndex,m=S===void 0?R.length-1:S;this.interimTranscript="",this.finalTranscript="";for(var b=m;b<R.length;++b)R[b].isFinal&&(!(0,n.default)()||R[b][0].confidence>0)?this.updateFinalTranscript(R[b][0].transcript):this.interimTranscript=(0,t.concatTranscripts)(this.interimTranscript,R[b][0].transcript);var i=!1;this.interimTranscript===""&&this.finalTranscript!==""?(this.previousResultWasFinalOnly&&(i=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,i||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}},{key:"updateFinalTranscript",value:function(g){this.finalTranscript=(0,t.concatTranscripts)(this.finalTranscript,g)}},{key:"resetTranscript",value:function(){this.disconnect("RESET")}},{key:"startListening",value:function(){var w=r(regeneratorRuntime.mark(function R(){var S,m,b,i,o,u,y=arguments;return regeneratorRuntime.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:if(S=y.length>0&&y[0]!==void 0?y[0]:{},m=S.continuous,b=m===void 0?!1:m,i=S.language,this.recognition){j.next=3;break}return j.abrupt("return");case 3:if(o=b!==this.recognition.continuous,u=i&&i!==this.recognition.lang,!(o||u)){j.next=11;break}if(!this.listening){j.next=9;break}return j.next=9,this.stopListening();case 9:this.recognition.continuous=o?b:this.recognition.continuous,this.recognition.lang=u?i:this.recognition.lang;case 11:if(this.listening){j.next=22;break}return this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript()),j.prev=13,j.next=16,this.start();case 16:this.emitListeningChange(!0),j.next=22;break;case 19:j.prev=19,j.t0=j.catch(13),j.t0 instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1);case 22:case"end":return j.stop()}},R,this,[[13,19]])}));function g(){return w.apply(this,arguments)}return g}()},{key:"abortListening",value:function(){var w=r(regeneratorRuntime.mark(function R(){var S=this;return regeneratorRuntime.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return this.disconnect("ABORT"),this.emitListeningChange(!1),b.next=4,new Promise(function(i){S.onStopListening=i});case 4:case"end":return b.stop()}},R,this)}));function g(){return w.apply(this,arguments)}return g}()},{key:"stopListening",value:function(){var w=r(regeneratorRuntime.mark(function R(){var S=this;return regeneratorRuntime.wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return this.disconnect("STOP"),this.emitListeningChange(!1),b.next=4,new Promise(function(i){S.onStopListening=i});case 4:case"end":return b.stop()}},R,this)}));function g(){return w.apply(this,arguments)}return g}()},{key:"getRecognition",value:function(){return this.recognition}},{key:"start",value:function(){var w=r(regeneratorRuntime.mark(function R(){return regeneratorRuntime.wrap(function(m){for(;;)switch(m.prev=m.next){case 0:if(!(this.recognition&&!this.listening)){m.next=4;break}return m.next=3,this.recognition.start();case 3:this.listening=!0;case 4:case"end":return m.stop()}},R,this)}));function g(){return w.apply(this,arguments)}return g}()},{key:"stop",value:function(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}},{key:"abort",value:function(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}}]),v}();e.default=C})(Pt);(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.useSpeechRecognition=void 0;var n=z,t=J,h=he,l=De,f=p(Pt),r=p(Ye),a=p(Qe);function p(T){return T&&T.__esModule?T:{default:T}}function A(T,_,E,P,W,M,K){try{var c=T[M](K),s=c.value}catch(d){E(d);return}c.done?_(s):Promise.resolve(s).then(P,W)}function C(T){return function(){var _=this,E=arguments;return new Promise(function(P,W){var M=T.apply(_,E);function K(s){A(M,P,W,K,c,"next",s)}function c(s){A(M,P,W,K,c,"throw",s)}K(void 0)})}}function v(T){return R(T)||g(T)||i(T)||w()}function w(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g(T){if(typeof Symbol<"u"&&Symbol.iterator in Object(T))return Array.from(T)}function R(T){if(Array.isArray(T))return o(T)}function S(T){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?S=function(E){return typeof E}:S=function(E){return E&&typeof Symbol=="function"&&E.constructor===Symbol&&E!==Symbol.prototype?"symbol":typeof E},S(T)}function m(T,_){return y(T)||u(T,_)||i(T,_)||b()}function b(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function i(T,_){if(T){if(typeof T=="string")return o(T,_);var E=Object.prototype.toString.call(T).slice(8,-1);if(E==="Object"&&T.constructor&&(E=T.constructor.name),E==="Map"||E==="Set")return Array.from(T);if(E==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(E))return o(T,_)}}function o(T,_){(_==null||_>T.length)&&(_=T.length);for(var E=0,P=new Array(_);E<_;E++)P[E]=T[E];return P}function u(T,_){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(T)))){var E=[],P=!0,W=!1,M=void 0;try{for(var K=T[Symbol.iterator](),c;!(P=(c=K.next()).done)&&(E.push(c.value),!(_&&E.length===_));P=!0);}catch(s){W=!0,M=s}finally{try{!P&&K.return!=null&&K.return()}finally{if(W)throw M}}return E}}function y(T){if(Array.isArray(T))return T}var x=!!a.default,j=x&&!(0,r.default)(),D,V=function(){var _=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},E=_.transcribing,P=E===void 0?!0:E,W=_.clearTranscriptOnListen,M=W===void 0?!0:W,K=_.commands,c=K===void 0?[]:K,s=(0,n.useState)(I.getRecognitionManager()),d=m(s,1),L=d[0],k=(0,n.useState)(x),O=m(k,2),q=O[0],H=O[1],Z=(0,n.useState)(j),U=m(Z,2),ge=U[0],ae=U[1],ne=(0,n.useReducer)(l.transcriptReducer,{interimTranscript:L.interimTranscript,finalTranscript:""}),Je=m(ne,2),Xe=Je[0],et=Xe.interimTranscript,tt=Xe.finalTranscript,nt=Je[1],Vt=(0,n.useState)(L.listening),rt=m(Vt,2),Gt=rt[0],Kt=rt[1],Ut=(0,n.useState)(L.isMicrophoneAvailable),it=m(Ut,2),qt=it[0],Ht=it[1],st=(0,n.useRef)(c);st.current=c;var at=function(){nt((0,h.clearTranscript)())},me=(0,n.useCallback)(function(){L.resetTranscript(),at()},[L]),Yt=function(Y,te,oe){var se=S(Y)==="object"?Y.toString():Y,ve=se.replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),Se=(0,t.compareTwoStringsUsingDiceCoefficient)(ve,te);return Se>=oe?{command:Y,commandWithoutSpecials:ve,howSimilar:Se,isFuzzyMatch:!0}:null},Qt=function(Y,te){var oe=(0,t.commandToRegExp)(Y),se=oe.exec(te);return se?{command:Y,parameters:se.slice(1)}:null},ot=(0,n.useCallback)(function(ee,Y){st.current.forEach(function(te){var oe=te.command,se=te.callback,ve=te.matchInterim,Se=ve===void 0?!1:ve,ut=te.isFuzzyMatch,pt=ut===void 0?!1:ut,ft=te.fuzzyMatchingThreshold,Jt=ft===void 0?.8:ft,ht=te.bestMatchOnly,Xt=ht===void 0?!1:ht,Te=!Y&&Se?ee.trim():Y.trim(),en=Array.isArray(oe)?oe:[oe],Re=en.map(function(X){return pt?Yt(X,Te,Jt):Qt(X,Te)}).filter(function(X){return X});if(pt&&Xt&&Re.length>=2){Re.sort(function(X,Ie){return Ie.howSimilar-X.howSimilar});var ze=Re[0],tn=ze.command,nn=ze.commandWithoutSpecials,rn=ze.howSimilar;se(nn,Te,rn,{command:tn,resetTranscript:me})}else Re.forEach(function(X){if(X.isFuzzyMatch){var Ie=X.command,sn=X.commandWithoutSpecials,an=X.howSimilar;se(sn,Te,an,{command:Ie,resetTranscript:me})}else{var on=X.command,cn=X.parameters;se.apply(void 0,v(cn).concat([{command:on,resetTranscript:me}]))}})})},[me]),ct=(0,n.useCallback)(function(ee,Y){P&&nt((0,h.appendTranscript)(ee,Y)),ot(ee,Y)},[ot,P]),lt=(0,n.useCallback)(function(){M&&at()},[M]);(0,n.useEffect)(function(){var ee=I.counter;I.counter+=1;var Y={onListeningChange:Kt,onMicrophoneAvailabilityChange:Ht,onTranscriptChange:ct,onClearTranscript:lt,onBrowserSupportsSpeechRecognitionChange:H,onBrowserSupportsContinuousListeningChange:ae};return L.subscribe(ee,Y),function(){L.unsubscribe(ee)}},[P,M,L,ct,lt]);var Zt=(0,t.concatTranscripts)(tt,et);return{transcript:Zt,interimTranscript:et,finalTranscript:tt,listening:Gt,isMicrophoneAvailable:qt,resetTranscript:me,browserSupportsSpeechRecognition:q,browserSupportsContinuousListening:ge}};e.useSpeechRecognition=V;var I={counter:0,applyPolyfill:function(_){D?D.setSpeechRecognition(_):D=new f.default(_);var E=!!_&&(0,t.browserSupportsPolyfills)();x=E,j=E},removePolyfill:function(){D?D.setSpeechRecognition(a.default):D=new f.default(a.default),x=!!a.default,j=x&&!(0,r.default)()},getRecognitionManager:function(){return D||(D=new f.default(a.default)),D},getRecognition:function(){var _=I.getRecognitionManager();return _.getRecognition()},startListening:function(){var T=C(regeneratorRuntime.mark(function E(){var P,W,M,K,c=arguments;return regeneratorRuntime.wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return P=c.length>0&&c[0]!==void 0?c[0]:{},W=P.continuous,M=P.language,K=I.getRecognitionManager(),d.next=4,K.startListening({continuous:W,language:M});case 4:case"end":return d.stop()}},E)}));function _(){return T.apply(this,arguments)}return _}(),stopListening:function(){var T=C(regeneratorRuntime.mark(function E(){var P;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return P=I.getRecognitionManager(),M.next=3,P.stopListening();case 3:case"end":return M.stop()}},E)}));function _(){return T.apply(this,arguments)}return _}(),abortListening:function(){var T=C(regeneratorRuntime.mark(function E(){var P;return regeneratorRuntime.wrap(function(M){for(;;)switch(M.prev=M.next){case 0:return P=I.getRecognitionManager(),M.next=3,P.abortListening();case 3:case"end":return M.stop()}},E)}));function _(){return T.apply(this,arguments)}return _}(),browserSupportsSpeechRecognition:function(){return x},browserSupportsContinuousListening:function(){return j}},N=I;e.default=N})(xt);(function(e){function n(r){"@babel/helpers - typeof";return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?n=function(p){return typeof p}:n=function(p){return p&&typeof Symbol=="function"&&p.constructor===Symbol&&p!==Symbol.prototype?"symbol":typeof p},n(r)}Object.defineProperty(e,"__esModule",{value:!0}),Object.defineProperty(e,"useSpeechRecognition",{enumerable:!0,get:function(){return t.useSpeechRecognition}}),e.default=void 0;var t=l(xt);function h(){if(typeof WeakMap!="function")return null;var r=new WeakMap;return h=function(){return r},r}function l(r){if(r&&r.__esModule)return r;if(r===null||n(r)!=="object"&&typeof r!="function")return{default:r};var a=h();if(a&&a.has(r))return a.get(r);var p={},A=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in r)if(Object.prototype.hasOwnProperty.call(r,C)){var v=A?Object.getOwnPropertyDescriptor(r,C):null;v&&(v.get||v.set)?Object.defineProperty(p,C,v):p[C]=r[C]}return p.default=r,a&&a.set(r,p),p}var f=t.default;e.default=f})(ye);const be=hn(ye),{colors:G,shadows:yt,indents:Be}=Q,wr=$e`
  margin-bottom: 7px;
  padding-block: ${Be.xs};

  display: grid;
  align-items: center;
  grid-template-columns: 1fr 25fr 1fr;

  border: 1px solid transparent;
  background-color: ${({licolor:e})=>e};
  border-radius: ${Be.xs};
  font-size: 22px;

  &:last-of-type {
    margin-bottom: ${Be.s};
  }
`,$r=F.li`
  ${wr}

  transition: box-shadow 250ms, border-color 250ms;

  &#active-element {
    border-color: ${G.border};
    background-color: ${G.background};
    box-shadow: ${yt.back};

    &:hover {
      border-color: ${G.accent};
    }
    & div button {
      transition: color 250ms;
      color: ${G.smokeBlack};
      &:hover {
        color: ${G.hovered};
      }
    }
  }

  & div button {
    transition: color 250ms;
    &:hover {
      color: ${G.hovered};
    }
  }

  &:hover {
    border-color: ${G.accent};
    box-shadow: ${yt.back};
  }

  &:hover label,
  &:hover button {
    opacity: 1;
  }
`,Mt=$e`
  min-height: 19px;
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  & input {
    ${jn}
  }
`,Sr=F.label`
  ${Mt}

  & svg {
    transition: stroke 250ms;
    stroke-width: 2px;
    color: ${({$hovered:e})=>e?G.yellow:"transparent"};
    stroke: ${({$hovered:e})=>e?G.yellow:G.border};
  }
  &:hover svg {
    stroke: ${G.placeholder};
  }
`,Tr=F.label`
  ${Mt}
  opacity: ${({$hovered:e})=>e?1:0};
  transition: opacity 250ms;

  & svg {
    transition: border-color 250ms, color 250ms;
    padding: 1px;
    border: 2px solid ${G.border};
    border-radius: 50%;
    color: ${({$hovered:e})=>e?G.border:"transparent"};
  }
  &:hover svg {
    border-color: ${G.placeholder};
    color: ${({$hovered:e})=>e?G.placeholder:"transparent"};
  }
`,de=$e`
  display: flex;
  justify-content: center;
  align-items: center;
  background-color: transparent;
  border-color: transparent;
  transition: opacity 250ms color 250ms;
  color: ${G.black};

  & svg {
    transition: color 250ms;
    color: ${G.border};
  }
  &:hover,
  &:hover svg {
    color: ${G.placeholder};
  }
`,Rr=F.button`
  ${de}

  opacity: ${({$hovered:e})=>e?1:0};
`,Ar=F.button`
  ${de}

  opacity: 0;
`,{colors:Oe,indents:Ot}=Q,Dt=$e`
  padding-block: 4px;
  display: grid;
  align-items: start;
  grid-template-columns: 20fr 1fr 20fr;
`,Cr=F.div`
  ${Dt}
`,kr=F.form`
  ${Dt}

  max-height: 70vh;
  overflow-y: scroll;
  scrollbar-width: none;
  grid-template-columns: 12fr 1fr 12fr;
`,wt=F.textarea`
  height: 84px;
  outline: none;
  border: 1px solid ${Oe.accent};
  border-radius: ${Ot.xs};
  resize: none;
  overflow: clip;
  transition: height 150ms;
`,Er=F.div`
  width: 100%;
  height: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
  cursor: pointer;

  &::after {
    content: '';
    height: calc(100% - 8px);
    width: 1px;
    border: 1px solid ${Oe.borderLight};
    transition: border-color 250ms;
  }

  &:hover::after {
    border-color: ${Oe.placeholder};
  }
`,_r=F.div`
  height: 100%;
  display: flex;
  flex-direction: column;
  justify-content: center;
`,Lr=F.button`
  ${de}
`;F.button`
  ${de}
`;const qe=F.button`
  ${de}
`,xr=F.button`
  ${de}
`,$t=F.button`
  height: 100%;
  text-align: left;
  display: flex;
  align-items: top;
  background-color: transparent;
  border-color: transparent;
  border-radius: ${Ot.xs};
  color: ${Oe.black};
  transition: background-color 250ms;
`,zt=$e`
  width: 100%;
  display: flex;
  align-items: center;
  justify-content: center;
  border: none;
`,jr=F.iframe`
  ${zt}

  height: 60px;
  border-radius: 30px;
`,Pr=F.audio`
  ${zt}
`,Ze=({el:e,setIsForm:n})=>{const t=le(),h=z.useRef(null),l=z.useRef(null),f=z.useRef(null),{user:r}=ue(),{activeCluster:a}=ie(),[p,A]=z.useState(""),{_id:C,element:v,caption:w}=e,{register:g,watch:R,setValue:S,handleSubmit:m,setFocus:b}=Pn({mode:"onBlur",defaultValues:{element:v,caption:w}});z.useEffect(()=>{S("caption",w)},[w,S]);const{ref:i,...o}=g("element"),{ref:u,...y}=g("caption"),x=[h.current,l.current,f.current],j=[R("caption"),R("element")];Nn(x,j),z.useEffect(()=>{b("element"),p&&v.trim().startsWith("der")?S("element",p+v.replace("der","").trim()+", "):p&&v.trim().startsWith("die")?S("element",p+v.replace("die","").trim()+", "):p&&v.trim().startsWith("das")?S("element",p+v.replace("das","").trim()+", "):p?S("element",p+v+", "):S("element",p+v)},[p,v,b,S]),z.useEffect(()=>{const N=async T=>{(T.code==="NumpadAdd"||T.ctrlKey&&T.key==="Escape")&&(T.preventDefault(),await I(r.engine),m(D)()),T.key==="Enter"&&(T.preventDefault(),m(D)()),T.key==="Escape"&&n(!1)};return addEventListener("keydown",N),()=>{removeEventListener("keydown",N)}},[]);const D=N=>{const T=r.lang;let _=N.caption.trim(),E=Ke(N.element,a.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim();E=Me(E,","),_=Me(_,","),r.lang.includes("en")&&a.lang.includes("de")&&(E.includes("hat")||E.includes("ist"))&&E.split(`
`)[0].split(/,\s+/)[0].endsWith("n")&&(_=_.split(/,\s+/).map(M=>M.startsWith("to ")?M:`to ${M}`).join(", ")),t(C?je({_id:C,lang:T,element:E,caption:_}):Rt({...e,element:E,caption:_})).then(t(Ct())),n(!1)},V=()=>{p===""&&A("der "),p==="der "&&A("die "),p==="die "&&A("das "),p==="das "&&A("")},I=async N=>{const T=R("element"),_=Ke(T,a.lang).split(/\s+/).join(" ").replaceAll(`
`," ").trim(),E={from:a.lang,to:r.lang},P=await we(_,E,N);S("caption",P)};return $.jsxs(kr,{onSubmit:m(D),children:[$.jsx(wt,{...o,name:"element",ref:N=>{i(N),h.current=N}}),$.jsxs(_r,{ref:f,children:[$.jsx(xr,{type:"button",onClick:V,children:$.jsx(Mn,{size:"18px"})}),$.jsx(qe,{type:"button",onClick:()=>I("google"),children:$.jsx(dn,{size:"16px"})}),$.jsx(qe,{type:"button",onClick:()=>I("deepl"),children:$.jsx(gn,{size:"18px"})}),$.jsx(Lr,{children:$.jsx(mn,{size:"16px"})})]}),$.jsx(wt,{...y,name:"caption",ref:N=>{u(N),l.current=N}})]})};Ze.propTypes={el:B.object,setIsForm:B.func};const{button:Mr}=Q.shadows,{m:Or,xl:Dr}=Q.indents,zr=()=>{const{user:e}=ue(),[n,t]=z.useState(!1),{activeCluster:h}=ie(),[l,f]=z.useState(""),[r,a]=z.useState(""),{transcript:p,listening:A,resetTranscript:C}=ye.useSpeechRecognition(),{isMicrophoneAvailable:v}=ye.useSpeechRecognition(),{browserSupportsSpeechRecognition:w}=ye.useSpeechRecognition(),g=l.endsWith(", ")||l.replace(/[a-z]$/,"*#").endsWith("*#")?p.replace(/^./,i=>` ${i}`):p.replace(/^./,i=>i.toUpperCase()),R=`${l}${g}`,S=On(R,Vn),m=(i,o)=>i.trim().endsWith(o)?`${i.trim()} `:`${i.trim()}${o} `;if(z.useEffect(()=>{if(!A||!n)return;const i=[".","?","!",","],o=u=>{if(i.includes(u.key)){u.preventDefault();const y=m(S,u.key);f(y),C()}if(u.key==="Backspace"){u.preventDefault();const y=S.length-1,x=S.substring(0,y);f(x),C()}if(u.key==="Space"){u.preventDefault();const y=S+" ";f(y),C()}};return addEventListener("keydown",o),()=>{removeEventListener("keydown",o)}},[S,n,A,l,C]),z.useEffect(()=>{const i=async o=>{if(A||(o.key==="Enter"&&(o.preventDefault(),At()),o.metaKey&&o.key==="r"&&!o.altKey&&!o.shiftKey&&(o.preventDefault(),f(""),a(""),t(!0),be.startListening({language:h.lang,continuous:!0}))),A){if(o.key==="Escape")return o.preventDefault(),be.stopListening();if(o.metaKey&&o.key==="r"&&!o.altKey&&!o.shiftKey){o.preventDefault(),be.stopListening();const u=S.at(-1),y=!u||["!"].includes(u)?S:m(S,"."),x=await we(y,{from:h.lang,to:e.lang},e.engine);f(y),a(x),C()}}};return addEventListener("keydown",i),()=>{removeEventListener("keydown",i)}},[h.lang,S,A,C,p,e.engine,e.lang]),!w||!v)return;const b=async i=>{if(i==null||i.currentTarget.blur(),!A)f(""),a(""),t(!0),be.startListening({language:h.lang,continuous:!0});else{be.stopListening();const o=S.at(-1),u=!o||["!"].includes(o)?S:m(S,"."),y={from:h.lang,to:e.lang},x=await we(u,y,e.engine);f(u),a(x),C()}};return $.jsxs($.Fragment,{children:[$.jsx(pe,{onClick:b,$s:"m",$round:!0,$bs:Mr,children:A?$.jsx(bn,{size:18}):$.jsx(vn,{size:18})}),n&&$.jsx(yn,{$x:`left: ${Or}`,$y:`top: ${Dr}`,$bd:"none",children:$.jsx(Ze,{el:{cluster:h._id,element:S.trim(),caption:r.trim(),favorite:!0,checked:S.split(/\s+/).length<20},setIsForm:t})})]})},{m:Ir,s:Nr}=Q.indents,It=({className:e})=>{const{pathname:n}=wn(),{elementTrash:t}=fe(),{activeCluster:h}=ie(),l=t.length>0?" 1fr":"",f=h?" 1fr":"",r=l+f+" 1fr 1fr";if(n.includes("/element"))return $.jsxs(He,{className:e,$m:`${Nr} ${Ir}`,$pos:"fixed",$side:"left",$high:"bottom",$gtc:r,children:[$.jsx(nr,{}),$.jsx(zr,{}),f&&$.jsx(Zn,{}),l&&$.jsx(Xn,{})]})};It.propTypes={className:B.string};const{colors:We}=Q,Br=F.div`
  display: flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;

  &:hover svg {
    stroke: ${We.yellow};
  }

  & svg {
    transition: stroke 250ms;
    stroke: ${We.hovered};
    /* stroke: ${({$colored:e})=>e&&We.yellow}; */
    @keyframes refresh-spin {
      from {
        transform: rotate(0deg);
      }
      to {
        transform: rotate(-360deg);
      }
    }
    animation: refresh-spin infinite 12s linear;
  }
`,Nt=({onClick:e})=>$.jsx(Br,{onClick:e,children:$.jsx($n,{size:"35px"})});Nt.propTypes={onClick:B.func};const{background:Fe}=Q.colors,{button:St}=Q.shadows,{m:Wr,s:Fr}=Q.indents,Bt=({className:e,filtredElements:n,setLiColor:t})=>{const{user:h}=ue(),{activeCluster:l}=ie(),{activeElement:f}=fe(),[r,a]=z.useState(null);if(z.useEffect(()=>{const m=window.speechSynthesis.getVoices();Array.isArray(m)&&m.length>0&&a(m),"onvoiceschanged"in window.speechSynthesis&&(window.speechSynthesis.onvoiceschanged=()=>{const b=window.speechSynthesis.getVoices();a(b)})},[]),!Array.isArray(r)||r.length===0)return;const p=m=>{if(!m.length)return;let b="",i=0;const o=m.reduce((u,y)=>(u[y.lang]||(u[y.lang]=0),u[y.lang]+=1,u),{});for(const u in o)o[u]>i&&(i=o[u],b=u);return b},A=n.length?p(n):h.lang,C=(m,b)=>m.replaceAll(", `",`;${b} `).replaceAll(" `",`${b} `).replaceAll(",`",";"),v=({text:m,playList:b,divider:i})=>{let o="";for(let u=0;u<b.length;u+=1){let y=b[u][m];const x=`@±@${b[u].lang}${i}`;y.endsWith(".")||y.endsWith("!")||y.endsWith("?")||y.endsWith('"')?(o+=C(y,i).replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",m!=="caption"?`__${i}`:`__${x}`).replaceAll(".",m!=="caption"?`.${i}`:`.${x}`).replaceAll(",",m!=="caption"?`,${i}`:`,${x}`).replaceAll("!",m!=="caption"?`!${i}`:`!${x}`).replaceAll("?",m!=="caption"?`?${i}`:`?${x}`).replaceAll(":",m!=="caption"?`:${i}`:`:${x}`),l.lang.includes("de")&&(o=o.replaceAll(`0.${i}`,"0.").replaceAll(`1.${i}`,"1.").replaceAll(`2.${i}`,"2.").replaceAll(`3.${i}`,"3.").replaceAll(`4.${i}`,"4.").replaceAll(`5.${i}`,"5.").replaceAll(`6.${i}`,"6.").replaceAll(`7.${i}`,"7.").replaceAll(`8.${i}`,"8.").replaceAll(`9.${i}`,"9."))):b[u].element.startsWith("[")||(m==="caption"&&(y.includes(" [")&&(y=y.substring(0,y.indexOf(" ["))),y=`${y}@±@${b[u].lang}`),o+=y+i)}return o},w=r,g=m=>{m.currentTarget.blur(),t(Fe);const b="$*@",i=n.findIndex(y=>y.element===f.element),o=n.splice(i===-1?0:i),u=Pe({setLiColor:t,divider:b,voices:w,text:v({text:"element",playList:o,divider:b}),lang:l.lang,rate:l.rate});u&&re.error(u)},R=m=>{m.currentTarget.blur();const b="$*@";t(Fe);const i=n.findIndex(y=>y.element===f.element),o=n.splice(i===-1?0:i),u=Pe({setLiColor:t,divider:b,voices:w,text:v({text:"caption",playList:o,divider:b}),lang:A,rate:h.rate});u&&re.error(u)},S=m=>{m.currentTarget.blur(),t(Fe);let b="";const i="$*@",o=n.findIndex(x=>x.element===f.element),u=n.splice(o===-1?0:o);for(let x=0;x<u.length;x+=1){const{element:j,caption:D,lang:V}=u[x];if(!j.startsWith("[")){const I=C(j,""),N=D.includes(" [")?D.substring(0,D.indexOf(" [")):C(D,"");b+=I+`@±@${V}`+N+i}}const y=Sn({setLiColor:t,divider:i,voices:w,text:b,lang:l.lang,rate:h.rate});y&&re.error(y)};return $.jsxs(He,{className:e,$m:`${Fr} ${Wr}`,$pos:"fixed",$side:"right",$high:"bottom",$gtc:"1fr 0.5fr 1fr",children:[$.jsx(pe,{onClick:g,$s:"m",$round:!0,$bs:St,children:(l==null?void 0:l.lang.at(0).toUpperCase())+(l==null?void 0:l.lang.substring(1))}),$.jsx(Nt,{onClick:S}),$.jsx(pe,{onClick:R,$s:"m",$round:!0,$bs:St,children:(A==null?void 0:A.at(0).toUpperCase())+(A==null?void 0:A.substring(1))})]})};Bt.propTypes={className:B.string,filtredElements:B.array,setLiColor:B.func};const Wt=({el:e,sortByDate:n,setSortByDate:t,setLiColor:h})=>{const l=le(),{user:f}=ue(),{activeCluster:r}=ie(),{element:a,caption:p}=e,A="$*@",C=(i,o)=>{let u="";return o?(i.trim().endsWith(".")||i.trim().endsWith("!")||i.trim().endsWith("?")||i.endsWith('"')?(u=i.trim().replaceAll(", `",`;${o} `).replaceAll(" `",`${o} `).replaceAll(",`",";").replaceAll("Mr.","misteR").replaceAll("Ms.","misS").replaceAll("Mrs.","missiS").replaceAll("...",`__${o}`).replaceAll(".",`.${o}`).replaceAll(",",`,${o}`).replaceAll("!",`!${o}`).replaceAll("?",`?${o}`).replaceAll(":",`:${o}`),r.lang.includes("de")&&(u=u.replaceAll(`0.${o}`,"0.").replaceAll(`1.${o}`,"1.").replaceAll(`2.${o}`,"2.").replaceAll(`3.${o}`,"3.").replaceAll(`4.${o}`,"4.").replaceAll(`5.${o}`,"5.").replaceAll(`6.${o}`,"6.").replaceAll(`7.${o}`,"7.").replaceAll(`8.${o}`,"8.").replaceAll(`9.${o}`,"9."))):u=i.trim()+o,u.includes("[")?u.substring(0,u.indexOf("["))+o:u):i},v=i=>{i.currentTarget.blur();const o=Pe({setLiColor:h,divider:A,voices:window.speechSynthesis.getVoices(),text:C(a,A),lang:r.lang,rate:r.rate});o&&re.error(o)},w=i=>{i.currentTarget.blur();const o=Pe({setLiColor:h,divider:A,voices:window.speechSynthesis.getVoices(),text:C(p,A),lang:e.lang,rate:f.rate});o&&re.error(o)},g=i=>{t(!n),n?re.success("Below is Recent"):re.success("Above is Recent"),i.stopPropagation()},R=i=>{const{_id:o}=r;l(kt(e)),i.currentTarget.closest("li").id!=="active-element"&&l(Ve({_id:o,activeEl:e._id}))},S=p.endsWith("mp3"),m=!S&&p.startsWith("http"),b=!S&&!m;return $.jsxs(Cr,{onClick:R,children:[$.jsx($t,{onClick:v,children:a}),$.jsx(Er,{onClick:g}),S&&$.jsx(Pr,{controls:!0,src:mt(p)}),m&&$.jsx(jr,{src:mt(p)}),b&&$.jsx($t,{onClick:w,children:p})]})};Wt.propTypes={el:B.object,sortByDate:B.bool,setSortByDate:B.func,$active:B.bool,$hovered:B.bool,setLiColor:B.func};const Ft=({el:e,index:n,length:t,sortByDate:h,setSortByDate:l,translateAll:f,liColor:r,setLiColor:a})=>{const p=le(),{elementTrash:A,activeElement:C}=fe(),[v,w]=z.useState(!1),{_id:g,favorite:R,checked:S}=e,m=A.find(x=>x._id===g),b=()=>{p(je({_id:g,favorite:!R}))},i=()=>{p(je({_id:g,checked:!S}))},o=()=>p(kn(e)),u=()=>w(!v),y=g===(C==null?void 0:C._id);return $.jsxs($r,{id:y?"active-element":null,licolor:r,children:[$.jsxs(Ge,{$h:"100%",$p:"0",$fd:"column",children:[$.jsxs(Sr,{$hovered:R,children:[$.jsx("input",{type:"checkbox",name:"favorite",checked:R,onChange:b}),$.jsx(xn,{size:"20px"})]}),$.jsxs(Tr,{$hovered:S,children:[$.jsx("input",{type:"checkbox",name:"checked",checked:S,onChange:i}),$.jsx(Tn,{size:"15px"})]}),v&&t===n+1&&$.jsx(qe,{onClick:f,children:$.jsx(Rn,{size:"16px"})})]}),v&&$.jsx(Ze,{el:e,setIsForm:w}),!v&&$.jsx(Wt,{el:e,sortByDate:h,setSortByDate:l,setLiColor:a}),$.jsxs(Ge,{$h:"100%",$p:"0",$fd:"column",children:[$.jsx(Rr,{$hovered:m,onClick:o,children:$.jsx(An,{size:"16px"})}),$.jsx(Ar,{onClick:u,children:$.jsx(Cn,{size:"15px"})})]})]})};Ft.propTypes={el:B.object,index:B.number,length:B.number,sortByDate:B.bool,setSortByDate:B.func,translateAll:B.func,liColor:B.string,setLiColor:B.func};const Vr=F.ul`
  width: 100%;
  list-style: none;
`,{white:Gr}=Q.colors,Kr=()=>{const e=le(),{ref:n,inView:t,entry:h}=Yn({initialInView:!0,rootMargin:"0px 0px -30px 0px"}),{user:l}=ue(),{activeCluster:f}=ie(),{allElements:r,elementTrash:a,elementFilter:p,isLoading:A}=fe(),[C,v]=z.useState(Gr);let{elementSelect:w}=fe();w=w||[];const[g,R]=z.useState(!1);z.useEffect(()=>{f&&e(Ct({cluster:f._id})).unwrap().then(({result:u})=>{if(!f.activeEl)return;const y=u.elements.find(({_id:x})=>x===f.activeEl);e(kt(y))}).then(()=>{const u=document.getElementById("active-element");u&&En(u)})},[]);const S=r.filter(u=>u.cluster===(f==null?void 0:f._id)).sort((u,y)=>u.createdAt.localeCompare(y.createdAt)),b=(()=>{const u=a.map(y=>y._id);return w.includes("trash")?S.filter(y=>u.includes(y._id)):S})().filter(({element:u,caption:y,favorite:x,checked:j})=>{const D=u.toLowerCase().replace("·","").includes(p)||u.toLowerCase().includes(p)||y.toLowerCase().includes(p),V=w.includes("wordlist")?D&&Dn(u):D,I=()=>w.some(T=>["favorite","unfavorite"].includes(T))?w.includes("favorite")?V&&x===!0:V&&x===!1:V;return(()=>w.some(T=>["checked","unchecked"].includes(T))?w.includes("checked")?I()&&j===!0:I()&&j===!1:I())()}).sort(g?(u,y)=>y.createdAt.localeCompare(u.createdAt):(u,y)=>u.createdAt.localeCompare(y.createdAt)),i=async()=>{const u=l.lang;let y=0;await b.forEach(async x=>{if(y>1)return;const{_id:j,element:D}=x;if(!D.startsWith("[")||u!==x.lang){const V={from:f.lang,to:u},I=await we(D,V,l.engine);e(je({_id:j,lang:u,caption:I})),y=y+1}})},o=window.innerHeight<(h==null?void 0:h.target.getBoundingClientRect().y)+(h==null?void 0:h.target.getBoundingClientRect().height)*1.5;return $.jsxs($.Fragment,{children:[$.jsxs(Vr,{children:[b.map((u,y,x)=>$.jsx(Ft,{el:u,index:y,length:x.length,sortByDate:g,setSortByDate:R,translateAll:i,liColor:C,setLiColor:v},u._id)),$.jsxs("div",{ref:n,children:[$.jsx(Lt,{}),$.jsx(It,{className:!t||!o?"shown":"hidden"}),$.jsx(Bt,{className:!t||!o?"shown":"hidden",filtredElements:b,setLiColor:v})]})]}),A&&$.jsx(_n,{})]})},{s:Tt,m:Ur}=Q.indents,Jr=()=>$.jsx(Ge,{$p:`0 ${Ur} ${Tt} ${Tt}`,children:$.jsx(Kr,{})});export{Jr as default};
